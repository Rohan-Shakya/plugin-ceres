"use strict";(self.webpackChunkCeres=self.webpackChunkCeres||[]).push([[36],{6065:function(e,t,s){s.r(t),s.d(t,{default:function(){return p}});var a=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"login-pwd-reset"},[s("form",{ref:"loginForm",attrs:{id:"login-form-"+e._uid,method:"post"}},[s("div",{class:{"modal-body":e.modalElement}},[s("div",{staticClass:"row"},[s("div",{staticClass:"col-12"},[s("div",{staticClass:"input-unit",attrs:{"data-validate":"mail"}},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.username,expression:"username"}],attrs:{"data-testing":"email-login",type:"email",name:"email",autocomplete:"email",id:"email"+e._uid,"data-autofocus":""},domProps:{value:e.username},on:{input:function(t){t.target.composing||(e.username=t.target.value)}}}),e._v(" "),s("label",{attrs:{for:"email"+e._uid}},[e._v(e._s(e.$translate("Ceres::Template.loginEmail"))+"*")])]),e._v(" "),s("span",{staticClass:"error-msg"},[e._v(e._s(e.$translate("Ceres::Template.loginEnterConfirmEmail")))])]),e._v(" "),s("div",{staticClass:"col-12"},[s("div",{staticClass:"input-unit",class:{"no-bottom":e.modalElement},attrs:{"data-validate":"text"}},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.password,expression:"password"}],attrs:{"data-testing":"password-login",type:"password",name:"password",autocomplete:"current-password",id:"password"+e._uid},domProps:{value:e.password},on:{input:function(t){t.target.composing||(e.password=t.target.value)}}}),e._v(" "),s("label",{attrs:{for:"password"+e._uid}},[e._v(e._s(e.$translate("Ceres::Template.loginPassword"))+"*")])]),e._v(" "),s("span",{staticClass:"error-msg"},[e._v(e._s(e.$translate("Ceres::Template.loginEmptyPassword")))])])])]),e._v(" "),s("div",{class:{"modal-footer justify-content-between":e.modalElement,row:!e.modalElement}},[s("div",{class:{"col-7 col-sm-4":!e.modalElement}},[s("a",{staticClass:"small text-appearance",attrs:{href:"javascript:void(0)"},on:{click:e.showResetPwdView}},[e._v(e._s(e.$translate("Ceres::Template.loginForgotPassword"))+"?")])]),e._v(" "),s("div",{class:{"col-5 col-sm-8 text-sm-right":!e.modalElement}},[e._t("extend-overlay-buttons"),e._v(" "),s("button",{staticClass:"btn btn-primary btn-appearance btn-medium",class:[{"float-right":!e.modalElement},e.buttonSizeClass],attrs:{"data-testing":"submit-login",disabled:e.isDisabled},on:{click:function(t){return t.preventDefault(),e.validateLogin(t)}}},[e._v("\n                    "+e._s(e.$translate("Ceres::Template.login"))+"\n                    "),s("icon",{attrs:{icon:"user",loading:e.isDisabled}})],1)],2)])])])};a._withStripped=!0;var o=s(9430),i=s(3085),l=s(1452),r=s(7832),n=s(2201),d=s(7412),m=s(1023),u={mixins:[o.Z],props:{backlink:{type:String},modalElement:{type:String},hasToForward:{type:Boolean,default:!1}},data:()=>({password:"",username:"",loginFields:[],isDisabled:!1}),mounted(){this.$nextTick((()=>{this.loginFields=this.$refs.loginForm.querySelectorAll(".input-unit"),n.default.triggerAutoFocus()}))},watch:{password(e,t){this.resetError()},username(e,t){this.resetError()}},methods:{showLogin(){r.default.findModal(document.getElementById(this.modalElement)).show()},validateLogin(){d.default.validate($("#login-form-"+this._uid)).done((()=>{this.sendLogin()})).fail((e=>{d.default.markInvalidFields(e,"error")}))},sendLogin(){this.isDisabled=!0,i.default.post("/rest/io/customer/login",{email:this.username,password:this.password},{supressNotifications:!0}).done((e=>{i.default.setToken(e),l.default.success(this.$translate("Ceres::Template.loginSuccessful")).closeAfter(3e3),null!==this.backlink&&this.backlink?location.assign(decodeURIComponent(this.backlink)):this.hasToForward?location.assign(location.origin):location.reload()})).fail((e=>{if(this.isDisabled=!1,401===e.error.code){this.loginFields.forEach((e=>e.classList.add("has-login-error")));let t="Ceres::Template.loginFailed";e.error.message.length>0&&"user is blocked"===e.error.message&&(t="Ceres::Template.loginBlocked"),l.default.error(this.$translate(t)).closeAfter(1e4)}}))},showResetPwdView(){this.resetError(),this.$store.dispatch("loadComponent","forgot-password-modal"),Vue.nextTick((()=>{let e=document.querySelector("#resetPwd");(0,m.tI)(e).$data.username=this.username;let t=()=>r.default.findModal(e).show();this.modalElement?r.default.findModal(document.getElementById(this.modalElement)).hide().then(t):t()}))},resetError(){this.loginFields.forEach((e=>e.classList.remove("has-login-error"))),d.default.unmarkAllFields("#login-form-"+this._uid)}}},c=(0,s(1900).Z)(u,a,[],!1,null,null,null);c.options.__file="resources/js/src/app/components/customer/login/Login.vue";var p=c.exports},9430:function(e,t,s){s.d(t,{Z:function(){return i}});const a=["btn-sm","btn-lg"],o={sm:"btn-sm",md:"",lg:"btn-lg"},i={props:{buttonSize:{type:[String,null],default:null,validator:e=>-1!==["",...a,...Object.keys(o)].indexOf(e)}},computed:{buttonSizeClass(){return o.hasOwnProperty(this.buttonSize)?o[this.buttonSize]:this.buttonSize}}}}}]);
//# sourceMappingURL=ceres-36.min.js.map