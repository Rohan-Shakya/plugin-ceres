"use strict";(self.webpackChunkCeres=self.webpackChunkCeres||[]).push([[41],{7621:function(__unused_webpack_module,__webpack_exports__,__webpack_require__){eval('// ESM COMPAT FLAG\n__webpack_require__.r(__webpack_exports__);\n\n// EXPORTS\n__webpack_require__.d(__webpack_exports__, {\n  "default": function() { return /* binding */ VariationSelect; }\n});\n\n;// CONCATENATED MODULE: ./node_modules/vue-loader/lib/loaders/templateLoader.js??ruleSet[1].rules[2]!./node_modules/vue-loader/lib/index.js??vue-loader-options!./resources/js/src/app/components/item/VariationSelect.vue?vue&type=template&id=588c1887&\nvar render = function render() {\n  var _vm = this,\n    _c = _vm._self._c\n  return _c(\n    "div",\n    { staticClass: "row" },\n    [\n      _vm.attributes.length ||\n      (_vm.possibleUnitCombinationIds.length > 1 && _vm.isContentVisible)\n        ? [\n            _vm._l(_vm.attributes, function (attribute, index) {\n              return _c(\n                "div",\n                { key: index, staticClass: "col-12 variation-select" },\n                [\n                  attribute.type === "dropdown"\n                    ? _c(\n                        "div",\n                        {\n                          ref: "attributesContaner",\n                          refInFor: true,\n                          staticClass: "input-unit",\n                        },\n                        [\n                          _c(\n                            "select",\n                            {\n                              staticClass: "custom-select",\n                              attrs: {\n                                id: "custom-select_" + attribute.name,\n                                "data-testing": "variation-select-dropdown",\n                              },\n                              on: {\n                                change: function ($event) {\n                                  return _vm.selectAttribute(\n                                    attribute.attributeId,\n                                    $event.target.value\n                                  )\n                                },\n                              },\n                            },\n                            [\n                              _vm.addPleaseSelectOption || !_vm.hasSelection\n                                ? _c("option", { domProps: { value: -1 } }, [\n                                    _vm._v(\n                                      _vm._s(\n                                        _vm.$translate(\n                                          "Ceres::Template.singleItemPleaseSelect"\n                                        )\n                                      )\n                                    ),\n                                  ])\n                                : _vm._e(),\n                              _vm._v(" "),\n                              _vm.hasEmptyOption ||\n                              _vm.selectedAttributes[attribute.attributeId] ===\n                                null\n                                ? _c(\n                                    "option",\n                                    {\n                                      domProps: {\n                                        value: null,\n                                        selected:\n                                          _vm.selectedAttributes[\n                                            attribute.attributeId\n                                          ] === null,\n                                      },\n                                    },\n                                    [\n                                      _vm._v(\n                                        _vm._s(\n                                          _vm.$translate(\n                                            "Ceres::Template.singleItemNoSelection"\n                                          )\n                                        )\n                                      ),\n                                    ]\n                                  )\n                                : _vm._e(),\n                              _vm._v(" "),\n                              _vm._l(attribute.values, function (value) {\n                                return _c(\n                                  "option",\n                                  {\n                                    key: value.attributeValueId,\n                                    domProps: {\n                                      value: value.attributeValueId,\n                                      selected:\n                                        value.attributeValueId ===\n                                        _vm.selectedAttributes[\n                                          attribute.attributeId\n                                        ],\n                                    },\n                                  },\n                                  [\n                                    _vm.isAttributeSelectionValid(\n                                      attribute.attributeId,\n                                      value.attributeValueId,\n                                      true\n                                    )\n                                      ? [\n                                          _vm._v(\n                                            "\\n                            " +\n                                              _vm._s(value.name) +\n                                              "\\n                        "\n                                          ),\n                                        ]\n                                      : _vm.isAttributeSelectionValid(\n                                          attribute.attributeId,\n                                          value.attributeValueId,\n                                          false\n                                        )\n                                      ? [\n                                          _vm._v(\n                                            "\\n                            " +\n                                              _vm._s(\n                                                _vm.$translate(\n                                                  "Ceres::Template.singleItemNotSalableAttribute",\n                                                  { name: value.name }\n                                                )\n                                              ) +\n                                              "\\n                        "\n                                          ),\n                                        ]\n                                      : [\n                                          _vm._v(\n                                            "\\n                            " +\n                                              _vm._s(\n                                                _vm.$translate(\n                                                  "Ceres::Template.singleItemInvalidAttribute",\n                                                  { name: value.name }\n                                                )\n                                              ) +\n                                              "\\n                        "\n                                          ),\n                                        ],\n                                  ],\n                                  2\n                                )\n                              }),\n                            ],\n                            2\n                          ),\n                          _vm._v(" "),\n                          _c(\n                            "label",\n                            {\n                              directives: [\n                                {\n                                  name: "tooltip",\n                                  rawName: "v-tooltip",\n                                  value: _vm.isTextCut(attribute.name),\n                                  expression: "isTextCut(attribute.name)",\n                                },\n                              ],\n                              attrs: {\n                                for: "custom-select_" + attribute.name,\n                                "data-toggle": "tooltip",\n                                "data-placement": "top",\n                                title: attribute.name,\n                                "data-testing":\n                                  "variation-select-dropdown-label",\n                              },\n                            },\n                            [_vm._v(_vm._s(attribute.name))]\n                          ),\n                        ]\n                      )\n                    : attribute.type === "box" || attribute.type === "image"\n                    ? _c("div", [\n                        _c(\n                          "span",\n                          {\n                            staticClass: "text-muted",\n                            attrs: { "data-testing": "attribute-name" },\n                          },\n                          [_vm._v(_vm._s(attribute.name) + ":")]\n                        ),\n                        _vm._v(" "),\n                        _c(\n                          "b",\n                          { attrs: { "data-testing": "attribute-value" } },\n                          [\n                            _vm._v(\n                              _vm._s(\n                                _vm.getSelectedAttributeValueName(attribute)\n                              )\n                            ),\n                          ]\n                        ),\n                        _vm._v(" "),\n                        _c(\n                          "div",\n                          {\n                            staticClass: "v-s-boxes py-3",\n                            class: { images: attribute.type === "image" },\n                          },\n                          [\n                            _vm.addPleaseSelectOption\n                              ? _c(\n                                  "div",\n                                  {\n                                    staticClass:\n                                      "v-s-box bg-white empty-option",\n                                    class: {\n                                      active:\n                                        _vm.selectedAttributes[\n                                          attribute.attributeId\n                                        ] === -1,\n                                      invalid: !_vm.isAttributeSelectionValid(\n                                        attribute.attributeId,\n                                        -1\n                                      ),\n                                    },\n                                    attrs: {\n                                      "data-testing": "variation-select-box",\n                                    },\n                                    on: {\n                                      click: function ($event) {\n                                        return _vm.selectAttribute(\n                                          attribute.attributeId,\n                                          -1\n                                        )\n                                      },\n                                    },\n                                  },\n                                  [\n                                    _c("span", { staticClass: "mx-3" }, [\n                                      _vm._v(\n                                        _vm._s(\n                                          _vm.$translate(\n                                            "Ceres::Template.singleItemPleaseSelect"\n                                          )\n                                        )\n                                      ),\n                                    ]),\n                                  ]\n                                )\n                              : _vm._e(),\n                            _vm._v(" "),\n                            _vm.hasEmptyOption\n                              ? _c(\n                                  "div",\n                                  {\n                                    staticClass:\n                                      "v-s-box bg-white empty-option",\n                                    class: {\n                                      active:\n                                        _vm.selectedAttributes[\n                                          attribute.attributeId\n                                        ] === null,\n                                      invalid: !_vm.isAttributeSelectionValid(\n                                        attribute.attributeId,\n                                        null,\n                                        true\n                                      ),\n                                    },\n                                    attrs: {\n                                      "data-testing": "variation-select-box",\n                                    },\n                                    on: {\n                                      click: function ($event) {\n                                        return _vm.selectAttribute(\n                                          attribute.attributeId,\n                                          null\n                                        )\n                                      },\n                                    },\n                                  },\n                                  [\n                                    _c("span", { staticClass: "mx-3" }, [\n                                      _vm._v(\n                                        _vm._s(\n                                          _vm.$translate(\n                                            "Ceres::Template.singleItemNoSelection"\n                                          )\n                                        )\n                                      ),\n                                    ]),\n                                  ]\n                                )\n                              : _vm._e(),\n                            _vm._v(" "),\n                            _vm._l(attribute.values, function (value) {\n                              return _c(\n                                "div",\n                                {\n                                  directives: [\n                                    {\n                                      name: "tooltip",\n                                      rawName: "v-tooltip",\n                                      value: true,\n                                      expression: "true",\n                                    },\n                                  ],\n                                  key: value.attributeValueId,\n                                  staticClass: "v-s-box bg-white",\n                                  class: {\n                                    active:\n                                      value.attributeValueId ===\n                                      _vm.selectedAttributes[\n                                        attribute.attributeId\n                                      ],\n                                    invalid: !_vm.isAttributeSelectionValid(\n                                      attribute.attributeId,\n                                      value.attributeValueId,\n                                      true\n                                    ),\n                                  },\n                                  attrs: {\n                                    "data-testing": "variation-select-box",\n                                    "data-html": "true",\n                                    "data-toggle": "tooltip",\n                                    "data-placement": "top",\n                                    "data-original-title": _vm.getTooltip(\n                                      attribute,\n                                      value\n                                    ),\n                                  },\n                                  on: {\n                                    click: function ($event) {\n                                      return _vm.selectAttribute(\n                                        attribute.attributeId,\n                                        value.attributeValueId\n                                      )\n                                    },\n                                  },\n                                },\n                                [\n                                  attribute.type === "box"\n                                    ? _c("span", { staticClass: "mx-3" }, [\n                                        _vm._v(_vm._s(value.name)),\n                                      ])\n                                    : _c("img", {\n                                        staticClass: "p-1",\n                                        attrs: {\n                                          src: value.imageUrl,\n                                          alt: value.name,\n                                        },\n                                      }),\n                                ]\n                              )\n                            }),\n                          ],\n                          2\n                        ),\n                      ])\n                    : _vm._e(),\n                ]\n              )\n            }),\n            _vm._v(" "),\n            _vm.possibleUnitCombinationIds.length > 1 && _vm.isContentVisible\n              ? _c("div", { staticClass: "col-12 variation-select" }, [\n                  _c("div", { staticClass: "input-unit" }, [\n                    _c(\n                      "select",\n                      {\n                        staticClass: "custom-select",\n                        attrs: {\n                          id: "unit-combination-ids-select",\n                          "data-testing": "variation-select-unit",\n                        },\n                        on: {\n                          change: function ($event) {\n                            return _vm.selectUnit($event.target.value)\n                          },\n                        },\n                      },\n                      _vm._l(\n                        _vm.possibleUnitCombinationIds,\n                        function (unitCombinationId) {\n                          return _c(\n                            "option",\n                            {\n                              key: unitCombinationId,\n                              domProps: {\n                                value: unitCombinationId,\n                                selected:\n                                  parseInt(unitCombinationId) ===\n                                  _vm.selectedUnit,\n                              },\n                            },\n                            [\n                              _vm.isUnitSelectionValid(unitCombinationId)\n                                ? [\n                                    _vm._v(\n                                      "\\n                            " +\n                                        _vm._s(\n                                          _vm.possibleUnits[unitCombinationId]\n                                        ) +\n                                        "\\n                        "\n                                    ),\n                                  ]\n                                : [\n                                    _vm._v(\n                                      "\\n                            " +\n                                        _vm._s(\n                                          _vm.$translate(\n                                            "Ceres::Template.singleItemInvalidAttribute",\n                                            {\n                                              name: _vm.possibleUnits[\n                                                unitCombinationId\n                                              ],\n                                            }\n                                          )\n                                        ) +\n                                        "\\n                        "\n                                    ),\n                                  ],\n                            ],\n                            2\n                          )\n                        }\n                      ),\n                      0\n                    ),\n                    _vm._v(" "),\n                    _c(\n                      "label",\n                      {\n                        attrs: {\n                          for: "unit-combination-ids-select",\n                          "data-testing": "variation-select-unit-label",\n                        },\n                      },\n                      [\n                        _vm._v(\n                          _vm._s(\n                            _vm.$translate("Ceres::Template.singleItemContent")\n                          )\n                        ),\n                      ]\n                    ),\n                  ]),\n                ])\n              : _vm._e(),\n          ]\n        : [_vm._t("default")],\n    ],\n    2\n  )\n}\nvar staticRenderFns = []\nrender._withStripped = true\n\n\n;// CONCATENATED MODULE: ./resources/js/src/app/components/item/VariationSelect.vue?vue&type=template&id=588c1887&\n\n// EXTERNAL MODULE: ./resources/js/src/app/helper/dom.js\nvar dom = __webpack_require__(7494);\n// EXTERNAL MODULE: ./resources/js/src/app/helper/utils.js\nvar utils = __webpack_require__(1023);\n;// CONCATENATED MODULE: ./node_modules/vue-loader/lib/index.js??vue-loader-options!./resources/js/src/app/components/item/VariationSelect.vue?vue&type=script&lang=js&\n\n\n\n\nconst NotificationService = __webpack_require__(1452);\n\n/* harmony default export */ var VariationSelectvue_type_script_lang_js_ = ({\n\n    name: "variation-select",\n\n    props: {\n        forceContent:\n        {\n            type: Boolean,\n            default: false\n        }\n    },\n\n    inject: {\n        itemId: {\n            default: null\n        }\n    },\n\n    data()\n    {\n        return {\n            filteredVariationsCache: {},\n            lastContentCount: 0\n        };\n    },\n\n    mounted()\n    {\n        // initially check for valid selection and disable add to basket button\n        this.$store.commit(`${this.itemId}/variationSelect/setIsVariationSelected`, !!this.currentSelection);\n    },\n\n    computed:\n    {\n        currentVariation() {\n            return this.$store.getters[`${this.itemId}/currentItemVariation`];\n        },\n\n        currentVariationSelect() {\n            return this.$store.state.items[this.itemId] && this.$store.state.items[this.itemId].variationSelect;\n        },\n\n        /**\n         * returns true if any variation has no attributes\n         */\n        hasEmptyOption()\n        {\n            return this.variations.some(variation => !variation.attributes.length);\n        },\n\n        addPleaseSelectOption()\n        {\n            return App.config.item.showPleaseSelect;\n        },\n\n        /**\n         * returns the variation, based on the selected attributes / unit\n         * returns false if there are none or multiple results\n         */\n        currentSelection()\n        {\n            const filteredVariations = this.filterVariations(null, null, true);\n\n            if (filteredVariations.length === 1)\n            {\n                return filteredVariations[0];\n            }\n\n            return false;\n        },\n\n        /**\n         * returns all units, selectable by current selection\n         * prop \'forceContent\' with value true will return all units, without filtering\n         */\n        possibleUnits()\n        {\n            // use an object, to make the entries unique\n            const possibleUnits = {};\n            const variations = this.forceContent ? this.variations : this.filterVariations(null, null, null, true);\n\n            for (const variation of variations)\n            {\n                possibleUnits[variation.unitCombinationId] = variation.unitName;\n            }\n\n            return possibleUnits;\n        },\n\n        possibleUnitCombinationIds()\n        {\n            return this.transformPossibleUnits(this.possibleUnits).map(value => value[0]);\n        },\n\n        isContentVisible()\n        {\n            return !this.forceContent && !!this.currentSelection || this.forceContent;\n        },\n\n        hasSelection()\n        {\n            return !(0,utils/* isNullOrUndefined */.le)(this.selectedAttributes) && !Object.values(this.selectedAttributes).some((value) => value < 0);\n        },\n\n        attributes() {\n            return this.currentVariationSelect && this.currentVariationSelect.attributes;\n        },\n\n        selectedAttributes() {\n            return this.currentVariationSelect && this.currentVariationSelect.selectedAttributes;\n        },\n\n        selectedUnit() {\n            return this.currentVariationSelect && this.currentVariationSelect.selectedUnit;\n        },\n\n        variations() {\n            return this.currentVariationSelect && this.currentVariationSelect.variations;\n        }\n    },\n\n    methods:\n    {\n        /**\n         * select an attribute and check, if the selection is valid; if not, unsetInvalidSelection will be executed\n         * @param {number} attributeId\n         * @param {[number, string, null]} attributeValueId\n         */\n        selectAttribute(attributeId, attributeValueId)\n        {\n            attributeValueId = parseInt(attributeValueId) || null;\n\n            if (this.selectedAttributes[attributeId] !== attributeValueId)\n            {\n                this.$store.commit(`${this.itemId}/variationSelect/selectItemAttribute`, { attributeId, attributeValueId });\n                this.onSelectionChange(attributeId, attributeValueId, null);\n            }\n        },\n\n        /**\n         * select a unit and check, if the selection is valid; if not, unsetInvalidSelection will be executed\n         * @param {[number, string]} unitId\n         */\n        selectUnit(unitId)\n        {\n            unitId = parseInt(unitId);\n            this.$store.commit(`${this.itemId}/variationSelect/selectItemUnit`, unitId);\n            this.onSelectionChange(null, null, unitId);\n        },\n\n        onSelectionChange(attributeId, attributeValueId, unitId)\n        {\n            if (this.currentSelection)\n            {\n                this.setVariation(this.currentSelection.variationId);\n            }\n            else if (!this.hasSelection)\n            {\n                // user switched back to "please select"\n                this.setVariation(0);\n            }\n            else\n            {\n                this.unsetInvalidSelection(attributeId, attributeValueId, unitId);\n            }\n\n            this.lastContentCount = this.possibleUnitCombinationIds.length;\n        },\n\n        /**\n         * changes the selected attributes / unit, to ensure a valid seelction\n         * @param {[number, null]} attributeId\n         * @param {[number, null]} attributeValueId\n         * @param {[number, null]} unitId\n         */\n        unsetInvalidSelection(attributeId, attributeValueId, unitId)\n        {\n            const qualifiedVariations = this.getQualifiedVariations(attributeId, attributeValueId, unitId);\n            const closestVariations = this.getClosestVariations(qualifiedVariations);\n            \n            // if the salable \'closestVariations\' is undefined, take the not-salable one\n            const closestVariation = closestVariations[0] || closestVariations[1];\n\n            if (!closestVariation)\n            {\n                return;\n            }\n\n            const invalidSelection = this.getInvalidSelectionByVariation(closestVariation);\n\n            this.correctSelection(invalidSelection);\n        },\n\n        getTooltip(attribute, attributeValue)\n        {\n            if(!this.isAttributeSelectionValid(attribute.attributeId, attributeValue.attributeValueId, true))\n            {\n                return this.getInvalidOptionTooltip(attribute.attributeId, attributeValue.attributeValueId);\n            }\n            else if(attribute.type === "image")\n            {\n                return this.$translate("Ceres::Template.singleItemAttributeTooltip", {\n                    attribute: attribute.name,\n                    value: attributeValue.name\n                });\n            }\n\n            return "";\n        },\n\n        /**\n         * returns a string for box tooltips, for not available options\n         * @param {number} attributeId\n         * @param {number} attributeValueId\n         */\n        getInvalidOptionTooltip(attributeId, attributeValueId)\n        {\n            const qualifiedVariations = this.getQualifiedVariations(attributeId, attributeValueId);\n            const closestVariations   = this.getClosestVariations(qualifiedVariations);\n\n            if (!closestVariations || closestVariations.length <= 0)\n            {\n                return "";\n            }\n\n            const invalidSelections = [\n                !!closestVariations[0] ? this.getInvalidSelectionByVariation(closestVariations[0]) : null,\n                !!closestVariations[1] ? this.getInvalidSelectionByVariation(closestVariations[1]) : null\n            ];\n\n            if (!!invalidSelections[0]\n                && !!invalidSelections[1]\n                && invalidSelections[0].attributesToReset.length > invalidSelections[1].attributesToReset.length)\n            {\n                // there is a non-salable variation with less changes\n                return this.$translate("Ceres::Template.singleItemNotSalable");\n            }\n\n            const invalidSelection = invalidSelections[0] || invalidSelections[1];\n            const names = [];\n\n            for (const attribute of invalidSelection.attributesToReset)\n            {\n                if (attribute.attributeId !== attributeId)\n                {\n                    names.push("<b>" + attribute.name +"</b>");\n                }\n            }\n            if (invalidSelection.newUnit)\n            {\n                names.push(\n                    "<b>" + this.$translate("Ceres::Template.singleItemContent") + "</b>"\n                );\n            }\n\n            if (!names.length)\n            {\n                return null;\n            }\n\n            return this.$translate("Ceres::Template.singleItemNotAvailableInSelection", { name: names.join(", ") });\n        },\n\n        /**\n         * returns a list of variations, filtered by attribute or unit\n         * @param {[number, null]} attributeId\n         * @param {[number, null]} attributeValueId\n         * @param {[number, null]} unitId\n         */\n        getQualifiedVariations(attributeId, attributeValueId, unitId)\n        {\n            if ((0,utils/* isDefined */.$K)(attributeValueId))\n            {\n                return this.variations.filter(variation =>\n                {\n                    return (0,utils/* isDefined */.$K)(variation.attributes.find(attribute =>\n                        attribute.attributeId === attributeId && attribute.attributeValueId === attributeValueId));\n                });\n            }\n            else if ((0,utils/* isDefined */.$K)(unitId))\n            {\n                return this.variations.filter(variation => variation.unitCombinationId === unitId);\n            }\n\n            return this.variations.filter(variation => !variation.attributes.length);\n        },\n\n        /**\n         * return a salable and a non-salable variation with the minimum number of changes on attributes compared to the current selection.\n         * @param {array} qualifiedVariations\n         */\n        getClosestVariations(qualifiedVariations)\n        {\n            let closestSalableVariation, numberOfSalableChanges;\n            let closestNonSalableVariation, numberOfNonSalableChanges;\n\n            for (const variation of qualifiedVariations)\n            {\n                let changes = 0;\n\n                if (variation.unitCombinationId !== this.selectedUnit && !(0,utils/* isNull */.Ft)(this.selectedUnit))\n                {\n                    // when the unit dropdown isn\'t visible, it should have a lower weight for reset investigations\n                    const unitWeight = this.possibleUnitCombinationIds.length > 1 && this.isContentVisible ? 0.9 : 0.1;\n\n                    changes += unitWeight;\n                }\n\n                for (const attribute of variation.attributes)\n                {\n                    if (this.selectedAttributes[attribute.attributeId] !== attribute.attributeValueId)\n                    {\n                        changes++;\n                    }\n                }\n\n                if(variation.isSalable && (!numberOfSalableChanges || changes < numberOfSalableChanges))\n                {\n                    closestSalableVariation = variation;\n                    numberOfSalableChanges = changes;\n                }\n                else if (!variation.isSalable && (!numberOfNonSalableChanges || changes < numberOfNonSalableChanges))\n                {\n                    closestNonSalableVariation = variation;\n                    numberOfNonSalableChanges = changes;\n                }\n            }\n\n            return [closestSalableVariation, closestNonSalableVariation];\n        },\n\n        /**\n         * returns object with array \'attributesToReset\' and newUnit. The attributesToReset contains all attributes, which are not matching with the given variation\n         * @param {object} variation\n         */\n        getInvalidSelectionByVariation(variation)\n        {\n            const attributesToReset = [];\n            let newUnit = null;\n\n            for (let selectedAttributeId in this.selectedAttributes)\n            {\n                selectedAttributeId = parseInt(selectedAttributeId);\n                const variationAttribute = variation.attributes.find(attribute => attribute.attributeId === selectedAttributeId);\n\n                if (!(0,utils/* isNull */.Ft)(this.selectedAttributes[selectedAttributeId]))\n                {\n                    if (variationAttribute && variationAttribute.attributeValueId !== this.selectedAttributes[selectedAttributeId] || !variationAttribute)\n                    {\n                        const attributeToReset = this.attributes.find(attr => attr.attributeId === selectedAttributeId);\n\n                        attributesToReset.push(attributeToReset);\n                    }\n                }\n            }\n\n            if (variation.unitCombinationId !== this.selectedUnit)\n            {\n                newUnit = variation.unitCombinationId;\n            }\n\n            return { attributesToReset, newUnit };\n        },\n\n        /**\n         * resets all invalid attributes and change the unit, if required. Prints a message to the user if so.\n         * @param {object} invalidSelection\n         */\n        correctSelection(invalidSelection)\n        {\n            const messages   = [];\n            const attributes = JSON.parse(JSON.stringify(this.selectedAttributes));\n\n            for (const attributeToReset of invalidSelection.attributesToReset)\n            {\n                messages.push(\n                    this.$translate("Ceres::Template.singleItemNotAvailable", { name: attributeToReset.name })\n                );\n\n                attributes[attributeToReset.attributeId] = (!this.hasEmptyOption && App.config.item.showPleaseSelect) ? -1 : null;\n            }\n\n            if (invalidSelection.newUnit)\n            {\n                if (this.lastContentCount > 1 && this.possibleUnitCombinationIds.length > 1 && !(0,utils/* isNull */.Ft)(this.selectedUnit))\n                {\n                    messages.push(\n                        this.$translate("Ceres::Template.singleItemNotAvailable", { name:\n                                this.$translate("Ceres::Template.singleItemContent")\n                        })\n                    );\n                }\n\n                this.$store.commit(`${this.itemId}/variationSelect/selectItemUnit`, invalidSelection.newUnit);\n            }\n\n            this.$store.commit(`${this.itemId}/variationSelect/setItemSelectedAttributes`, attributes);\n\n            this.setVariation(this.currentSelection ? this.currentSelection.variationId : 0);\n\n            NotificationService.warn(\n                messages.join("<br>")\n            ).closeAfter(5000);\n        },\n\n        /**\n         * returns matching variations with current selection\n         * attributes and unitId could be filled, to check a specific selection\n         * @param {object} attributes\n         * @param {number} unitId\n         * @param {boolean} strict\n         */\n        filterVariations(attributes, unitId, strict, ignoreUnit)\n        {\n            attributes = attributes || this.selectedAttributes;\n            unitId = unitId || this.selectedUnit;\n            strict = !!strict;\n            ignoreUnit = !!ignoreUnit;\n\n            const key = JSON.stringify(attributes) + "_" + unitId + "_" + strict + "_" + ignoreUnit;\n\n            if ((0,utils/* isDefined */.$K)(this.filteredVariationsCache[key]))\n            {\n                return this.filteredVariationsCache[key];\n            }\n\n            const uniqueValues = [...new Set(Object.values(attributes))];\n            const isEmptyOptionSelected = uniqueValues.length === 1 && (0,utils/* isNull */.Ft)(uniqueValues[0]);\n            const filteredVariations = this.variations.filter(variation =>\n            {\n                // the selected unit is not matching\n                if (!ignoreUnit && variation.unitCombinationId !== unitId)\n                {\n                    return false;\n                }\n\n                // the variation has no attributes (only checked, if any attribute has a selected value); or the variation has attributes and empty option is selected\n                // requires more than 0 attributes\n                if (((!isEmptyOptionSelected && !variation.attributes.length) || (isEmptyOptionSelected && variation.attributes.length))\n                    && this.attributes.length > 0)\n                {\n                    return false;\n                }\n\n                for (const attributeId in attributes)\n                {\n                    const variationAttribute = variation.attributes.find(variationAttribute =>\n                        variationAttribute.attributeId === parseInt(attributeId));\n\n                    // an attribute is not matching with selection\n                    if (variationAttribute &&\n                        variationAttribute.attributeValueId !== attributes[attributeId] &&\n                        (strict || !strict && !(0,utils/* isNull */.Ft)(attributes[attributeId]) && attributes[attributeId] !== -1))\n                    {\n                        return false;\n                    }\n                }\n\n                return true;\n            });\n\n            this.filteredVariationsCache[key] = filteredVariations;\n\n            return filteredVariations;\n        },\n\n        /**\n         * returns true, if the selection with a new attribute value would be valid\n         * @param {number} attributeId\n         * @param {[number, string, null]} attributeValueId\n         * @param {boolean} filterSalableVariations\n         */\n        isAttributeSelectionValid(attributeId, attributeValueId, filterSalableVariations)\n        {\n            attributeValueId = parseInt(attributeValueId) || null;\n            if (this.selectedAttributes[attributeId] === attributeValueId)\n            {\n                return true;\n            }\n\n            const selectedAttributes = JSON.parse(JSON.stringify(this.selectedAttributes));\n\n            selectedAttributes[attributeId] = parseInt(attributeValueId) || null;\n\n            const ignoreUnit = !(Object.keys(this.possibleUnits).length > 1 && this.isContentVisible);\n            let variations = this.filterVariations(selectedAttributes, null, null, ignoreUnit);\n\n            if (filterSalableVariations)\n            {\n                variations = variations.filter(variation => variation.isSalable)\n            }\n\n            return variations.length > 0;\n        },\n\n        /**\n         * returns true, if the selection with a new unitId would be valid\n         * @param {[number, string]} unitId\n         */\n        isUnitSelectionValid(unitId)\n        {\n            unitId = parseInt(unitId);\n            if (this.selectedUnit === unitId)\n            {\n                return true;\n            }\n\n            return this\n                .filterVariations(null, unitId)\n                .filter(variation => variation.isSalable)\n                .length > 0\n        },\n\n        /**\n         * dispatch vuex action \'loadVariation\' to archive a variation\n         * dispatches a custom event named \'onVariationChanged\'\n         * @param {[string, number, null]} variationId\n         */\n        setVariation(variationId)\n        {\n            if (!(0,utils/* isDefined */.$K)(variationId) && this.currentSelection)\n            {\n                variationId = this.currentSelection.variationId;\n            }\n\n            if ((0,utils/* isDefined */.$K)(variationId))\n            {\n                this.$store.dispatch(`${this.itemId}/loadVariation`, variationId).then(variation =>\n                {\n                    document.dispatchEvent(new CustomEvent("onVariationChanged",\n                        {\n                            detail:\n                                {\n                                    attributes: variation.attributes,\n                                    documents: variation.documents,\n                                    itemId: this.itemId\n                                }\n                        }));\n                });\n            }\n        },\n\n        isTextCut(content)\n        {\n            if (this.$refs.attributesContaner)\n            {\n                return (0,dom/* textWidth */.$H)(content, "Custom-Font, Helvetica, Arial, sans-serif") > this.$refs.attributesContaner[0].clientWidth;\n            }\n\n            return false;\n        },\n\n        getSelectedAttributeValueName(attribute)\n        {\n            const selectedAttributeValueId =  this.selectedAttributes[attribute.attributeId];\n            const selectedAttributeValue = attribute.values.find(attrValue => attrValue.attributeValueId === selectedAttributeValueId);\n\n            if (selectedAttributeValue)\n            {\n                return selectedAttributeValue.name;\n            }\n            else if (App.config.item.showPleaseSelect && selectedAttributeValueId === -1)\n            {\n                return this.$translate("Ceres::Template.singleItemPleaseSelect");\n            }\n            return this.$translate("Ceres::Template.singleItemNoSelection");\n        },\n\n        transformPossibleUnits(possibleUnits)\n        {\n            return Object.entries(possibleUnits).sort((unitA, unitB) => {\n                unitA = this.splitUnitName(unitA[1]);\n                unitB = this.splitUnitName(unitB[1]);\n                // order by unit\n                if (unitA[1] < unitB[1]) {\n                    return -1;\n                }\n                if (unitA[1] > unitB[1]) {\n                    return 1;\n                }\n                // order by content (count)\n                if (unitA[0] < unitB[0]) {\n                    return -1;\n                }\n                if (unitA[0] > unitB[0]) {\n                    return 1;\n                }\n                return 0;\n            });\n        },\n        splitUnitName(unitName) {\n            const unitNameSplit = unitName.split(" ");\n\n            if (!isNaN(unitNameSplit[0])) {\n                unitNameSplit[0] = unitNameSplit[0].replace(App.currencyPattern.separator_thousands, "");\n                unitNameSplit[0] = parseInt(unitNameSplit[0]);\n            }\n\n            return unitNameSplit;\n        }\n    },\n\n    watch:\n    {\n        currentSelection(value)\n        {\n            this.$store.commit(`${this.itemId}/variationSelect/setIsVariationSelected`, !!value);\n        },\n        variations()\n        {\n            // FIX unset variation cache after subsequent variations are loaded\n            this.filteredVariationsCache = {};\n        }\n    }\n});\n\n;// CONCATENATED MODULE: ./resources/js/src/app/components/item/VariationSelect.vue?vue&type=script&lang=js&\n /* harmony default export */ var item_VariationSelectvue_type_script_lang_js_ = (VariationSelectvue_type_script_lang_js_); \n// EXTERNAL MODULE: ./node_modules/vue-loader/lib/runtime/componentNormalizer.js\nvar componentNormalizer = __webpack_require__(1900);\n;// CONCATENATED MODULE: ./resources/js/src/app/components/item/VariationSelect.vue\n\n\n\n\n\n/* normalize component */\n;\nvar component = (0,componentNormalizer/* default */.Z)(\n  item_VariationSelectvue_type_script_lang_js_,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\n/* harmony default export */ var VariationSelect = (component.exports);//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiNzYyMS5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBTSxvQkFBb0I7QUFDMUI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxrQkFBa0Isb0RBQW9EO0FBQ3RFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx5QkFBeUI7QUFDekI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLCtCQUErQjtBQUMvQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQ0FBaUM7QUFDakMsK0JBQStCO0FBQy9CLDZCQUE2QjtBQUM3QjtBQUNBO0FBQ0EsaURBQWlELFlBQVksYUFBYTtBQUMxRTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHVDQUF1QztBQUN2QyxxQ0FBcUM7QUFDckM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EscUNBQXFDO0FBQ3JDLG1DQUFtQztBQUNuQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxvREFBb0Q7QUFDcEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG9EQUFvRDtBQUNwRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsK0JBQStCO0FBQy9CO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUNBQWlDO0FBQ2pDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwrQkFBK0I7QUFDL0IsNkJBQTZCO0FBQzdCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EscUNBQXFDLGtDQUFrQztBQUN2RSwyQkFBMkI7QUFDM0I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDRCQUE0QixTQUFTLHFDQUFxQztBQUMxRTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHFDQUFxQyxvQ0FBb0M7QUFDekUsMkJBQTJCO0FBQzNCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EscUNBQXFDO0FBQ3JDO0FBQ0E7QUFDQSxxQ0FBcUM7QUFDckM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsdUNBQXVDO0FBQ3ZDLHFDQUFxQztBQUNyQyxtQ0FBbUM7QUFDbkM7QUFDQSxpREFBaUQscUJBQXFCO0FBQ3RFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EscUNBQXFDO0FBQ3JDO0FBQ0E7QUFDQSxxQ0FBcUM7QUFDckM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsdUNBQXVDO0FBQ3ZDLHFDQUFxQztBQUNyQyxtQ0FBbUM7QUFDbkM7QUFDQSxpREFBaUQscUJBQXFCO0FBQ3RFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EscUNBQXFDO0FBQ3JDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxtQ0FBbUM7QUFDbkM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsbUNBQW1DO0FBQ25DO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHFDQUFxQztBQUNyQyxtQ0FBbUM7QUFDbkMsaUNBQWlDO0FBQ2pDO0FBQ0E7QUFDQSxtREFBbUQscUJBQXFCO0FBQ3hFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EseUNBQXlDO0FBQ3pDLHVDQUF1QztBQUN2QztBQUNBO0FBQ0EsNkJBQTZCO0FBQzdCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQSw0QkFBNEIsd0NBQXdDO0FBQ3BFLDhCQUE4QiwyQkFBMkI7QUFDekQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx5QkFBeUI7QUFDekI7QUFDQTtBQUNBO0FBQ0EsMkJBQTJCO0FBQzNCLHlCQUF5QjtBQUN6Qix1QkFBdUI7QUFDdkI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsK0JBQStCO0FBQy9CLDZCQUE2QjtBQUM3QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EseUJBQXlCO0FBQ3pCLHVCQUF1QjtBQUN2QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7Ozs7Ozs7QUU3VjZDO0FBQzZCOztBQUUxRSw0QkFBNEIsbUJBQU8sQ0FBQyxJQUFvQzs7QUFFeEUsNEVBQWU7O0FBRWY7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLG9CQUFvQixtQ0FBaUI7QUFDckM7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGdCQUFnQiwyQkFBUztBQUN6QjtBQUNBO0FBQ0E7QUFDQSwyQkFBMkIsMkJBQVM7QUFDcEM7QUFDQTtBQUNBO0FBQ0EscUJBQXFCLDJCQUFTO0FBQzlCO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBLDBFQUEwRSx3QkFBTTtBQUNoRjtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQSxxQkFBcUIsd0JBQU07QUFDM0I7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsZ0dBQWdHLHdCQUFNO0FBQ3RHO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUEsZ0JBQWdCLDJCQUFTO0FBQ3pCO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLHVFQUF1RSx3QkFBTTtBQUM3RTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSwrQ0FBK0Msd0JBQU07QUFDckQ7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUIsMkJBQVM7QUFDMUI7QUFDQTtBQUNBOztBQUVBLGdCQUFnQiwyQkFBUztBQUN6QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSx1QkFBdUIseUJBQVM7QUFDaEM7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7OztBQzFzQjZJLENBQUMsaUZBQWUsdUNBQUcsRUFBQyxDOzs7O0FDQXBFO0FBQzNCO0FBQ0w7OztBQUc5RDtBQUNBLENBQXNHO0FBQ3RHLGdCQUFnQixzQ0FBVTtBQUMxQixFQUFFLDRDQUFNO0FBQ1IsRUFBRSxNQUFNO0FBQ1IsRUFBRSxlQUFlO0FBQ2pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQSxvREFBZSIsInNvdXJjZXMiOlsid2VicGFjazovL0NlcmVzLy4vcmVzb3VyY2VzL2pzL3NyYy9hcHAvY29tcG9uZW50cy9pdGVtL1ZhcmlhdGlvblNlbGVjdC52dWU/ZDYwYiIsIndlYnBhY2s6Ly9DZXJlcy8uL3Jlc291cmNlcy9qcy9zcmMvYXBwL2NvbXBvbmVudHMvaXRlbS9WYXJpYXRpb25TZWxlY3QudnVlP2RiY2YiLCJ3ZWJwYWNrOi8vQ2VyZXMvcmVzb3VyY2VzL2pzL3NyYy9hcHAvY29tcG9uZW50cy9pdGVtL1ZhcmlhdGlvblNlbGVjdC52dWU/MTQ0NyIsIndlYnBhY2s6Ly9DZXJlcy8uL3Jlc291cmNlcy9qcy9zcmMvYXBwL2NvbXBvbmVudHMvaXRlbS9WYXJpYXRpb25TZWxlY3QudnVlPzMwZWEiLCJ3ZWJwYWNrOi8vQ2VyZXMvLi9yZXNvdXJjZXMvanMvc3JjL2FwcC9jb21wb25lbnRzL2l0ZW0vVmFyaWF0aW9uU2VsZWN0LnZ1ZT80NzkyIl0sInNvdXJjZXNDb250ZW50IjpbInZhciByZW5kZXIgPSBmdW5jdGlvbiByZW5kZXIoKSB7XG4gIHZhciBfdm0gPSB0aGlzLFxuICAgIF9jID0gX3ZtLl9zZWxmLl9jXG4gIHJldHVybiBfYyhcbiAgICBcImRpdlwiLFxuICAgIHsgc3RhdGljQ2xhc3M6IFwicm93XCIgfSxcbiAgICBbXG4gICAgICBfdm0uYXR0cmlidXRlcy5sZW5ndGggfHxcbiAgICAgIChfdm0ucG9zc2libGVVbml0Q29tYmluYXRpb25JZHMubGVuZ3RoID4gMSAmJiBfdm0uaXNDb250ZW50VmlzaWJsZSlcbiAgICAgICAgPyBbXG4gICAgICAgICAgICBfdm0uX2woX3ZtLmF0dHJpYnV0ZXMsIGZ1bmN0aW9uIChhdHRyaWJ1dGUsIGluZGV4KSB7XG4gICAgICAgICAgICAgIHJldHVybiBfYyhcbiAgICAgICAgICAgICAgICBcImRpdlwiLFxuICAgICAgICAgICAgICAgIHsga2V5OiBpbmRleCwgc3RhdGljQ2xhc3M6IFwiY29sLTEyIHZhcmlhdGlvbi1zZWxlY3RcIiB9LFxuICAgICAgICAgICAgICAgIFtcbiAgICAgICAgICAgICAgICAgIGF0dHJpYnV0ZS50eXBlID09PSBcImRyb3Bkb3duXCJcbiAgICAgICAgICAgICAgICAgICAgPyBfYyhcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiZGl2XCIsXG4gICAgICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgIHJlZjogXCJhdHRyaWJ1dGVzQ29udGFuZXJcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgcmVmSW5Gb3I6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgIHN0YXRpY0NsYXNzOiBcImlucHV0LXVuaXRcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICBbXG4gICAgICAgICAgICAgICAgICAgICAgICAgIF9jKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwic2VsZWN0XCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RhdGljQ2xhc3M6IFwiY3VzdG9tLXNlbGVjdFwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXR0cnM6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWQ6IFwiY3VzdG9tLXNlbGVjdF9cIiArIGF0dHJpYnV0ZS5uYW1lLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImRhdGEtdGVzdGluZ1wiOiBcInZhcmlhdGlvbi1zZWxlY3QtZHJvcGRvd25cIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvbjoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjaGFuZ2U6IGZ1bmN0aW9uICgkZXZlbnQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gX3ZtLnNlbGVjdEF0dHJpYnV0ZShcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGF0dHJpYnV0ZS5hdHRyaWJ1dGVJZCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRldmVudC50YXJnZXQudmFsdWVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgW1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX3ZtLmFkZFBsZWFzZVNlbGVjdE9wdGlvbiB8fCAhX3ZtLmhhc1NlbGVjdGlvblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA/IF9jKFwib3B0aW9uXCIsIHsgZG9tUHJvcHM6IHsgdmFsdWU6IC0xIH0gfSwgW1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX3ZtLl92KFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfdm0uX3MoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX3ZtLiR0cmFuc2xhdGUoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIkNlcmVzOjpUZW1wbGF0ZS5zaW5nbGVJdGVtUGxlYXNlU2VsZWN0XCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIClcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgOiBfdm0uX2UoKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF92bS5fdihcIiBcIiksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfdm0uaGFzRW1wdHlPcHRpb24gfHxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF92bS5zZWxlY3RlZEF0dHJpYnV0ZXNbYXR0cmlidXRlLmF0dHJpYnV0ZUlkXSA9PT1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbnVsbFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA/IF9jKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJvcHRpb25cIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZG9tUHJvcHM6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZTogbnVsbCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWxlY3RlZDpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF92bS5zZWxlY3RlZEF0dHJpYnV0ZXNbXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGF0dHJpYnV0ZS5hdHRyaWJ1dGVJZFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXSA9PT0gbnVsbCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBbXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF92bS5fdihcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfdm0uX3MoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfdm0uJHRyYW5zbGF0ZShcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJDZXJlczo6VGVtcGxhdGUuc2luZ2xlSXRlbU5vU2VsZWN0aW9uXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIClcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBdXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA6IF92bS5fZSgpLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX3ZtLl92KFwiIFwiKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF92bS5fbChhdHRyaWJ1dGUudmFsdWVzLCBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIF9jKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwib3B0aW9uXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAga2V5OiB2YWx1ZS5hdHRyaWJ1dGVWYWx1ZUlkLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZG9tUHJvcHM6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWU6IHZhbHVlLmF0dHJpYnV0ZVZhbHVlSWQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbGVjdGVkOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlLmF0dHJpYnV0ZVZhbHVlSWQgPT09XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX3ZtLnNlbGVjdGVkQXR0cmlidXRlc1tcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGF0dHJpYnV0ZS5hdHRyaWJ1dGVJZFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgW1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX3ZtLmlzQXR0cmlidXRlU2VsZWN0aW9uVmFsaWQoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGF0dHJpYnV0ZS5hdHRyaWJ1dGVJZCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWUuYXR0cmlidXRlVmFsdWVJZCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHJ1ZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA/IFtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF92bS5fdihcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJcXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCIgK1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF92bS5fcyh2YWx1ZS5uYW1lKSArXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJcXG4gICAgICAgICAgICAgICAgICAgICAgICBcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBdXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDogX3ZtLmlzQXR0cmlidXRlU2VsZWN0aW9uVmFsaWQoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhdHRyaWJ1dGUuYXR0cmlidXRlSWQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZS5hdHRyaWJ1dGVWYWx1ZUlkLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZmFsc2VcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgID8gW1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX3ZtLl92KFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIlxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIiArXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX3ZtLl9zKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX3ZtLiR0cmFuc2xhdGUoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiQ2VyZXM6OlRlbXBsYXRlLnNpbmdsZUl0ZW1Ob3RTYWxhYmxlQXR0cmlidXRlXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsgbmFtZTogdmFsdWUubmFtZSB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKSArXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJcXG4gICAgICAgICAgICAgICAgICAgICAgICBcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBdXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDogW1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX3ZtLl92KFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIlxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIiArXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX3ZtLl9zKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX3ZtLiR0cmFuc2xhdGUoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiQ2VyZXM6OlRlbXBsYXRlLnNpbmdsZUl0ZW1JbnZhbGlkQXR0cmlidXRlXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsgbmFtZTogdmFsdWUubmFtZSB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKSArXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJcXG4gICAgICAgICAgICAgICAgICAgICAgICBcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBdLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgMlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBdLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgX3ZtLl92KFwiIFwiKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgX2MoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJsYWJlbFwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRpcmVjdGl2ZXM6IFtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6IFwidG9vbHRpcFwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJhd05hbWU6IFwidi10b29sdGlwXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWU6IF92bS5pc1RleHRDdXQoYXR0cmlidXRlLm5hbWUpLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGV4cHJlc3Npb246IFwiaXNUZXh0Q3V0KGF0dHJpYnV0ZS5uYW1lKVwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGF0dHJzOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvcjogXCJjdXN0b20tc2VsZWN0X1wiICsgYXR0cmlidXRlLm5hbWUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiZGF0YS10b2dnbGVcIjogXCJ0b29sdGlwXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiZGF0YS1wbGFjZW1lbnRcIjogXCJ0b3BcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGl0bGU6IGF0dHJpYnV0ZS5uYW1lLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImRhdGEtdGVzdGluZ1wiOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwidmFyaWF0aW9uLXNlbGVjdC1kcm9wZG93bi1sYWJlbFwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFtfdm0uX3YoX3ZtLl9zKGF0dHJpYnV0ZS5uYW1lKSldXG4gICAgICAgICAgICAgICAgICAgICAgICAgICksXG4gICAgICAgICAgICAgICAgICAgICAgICBdXG4gICAgICAgICAgICAgICAgICAgICAgKVxuICAgICAgICAgICAgICAgICAgICA6IGF0dHJpYnV0ZS50eXBlID09PSBcImJveFwiIHx8IGF0dHJpYnV0ZS50eXBlID09PSBcImltYWdlXCJcbiAgICAgICAgICAgICAgICAgICAgPyBfYyhcImRpdlwiLCBbXG4gICAgICAgICAgICAgICAgICAgICAgICBfYyhcbiAgICAgICAgICAgICAgICAgICAgICAgICAgXCJzcGFuXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGF0aWNDbGFzczogXCJ0ZXh0LW11dGVkXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYXR0cnM6IHsgXCJkYXRhLXRlc3RpbmdcIjogXCJhdHRyaWJ1dGUtbmFtZVwiIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgIFtfdm0uX3YoX3ZtLl9zKGF0dHJpYnV0ZS5uYW1lKSArIFwiOlwiKV1cbiAgICAgICAgICAgICAgICAgICAgICAgICksXG4gICAgICAgICAgICAgICAgICAgICAgICBfdm0uX3YoXCIgXCIpLFxuICAgICAgICAgICAgICAgICAgICAgICAgX2MoXG4gICAgICAgICAgICAgICAgICAgICAgICAgIFwiYlwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICB7IGF0dHJzOiB7IFwiZGF0YS10ZXN0aW5nXCI6IFwiYXR0cmlidXRlLXZhbHVlXCIgfSB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICBbXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgX3ZtLl92KFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX3ZtLl9zKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfdm0uZ2V0U2VsZWN0ZWRBdHRyaWJ1dGVWYWx1ZU5hbWUoYXR0cmlidXRlKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICksXG4gICAgICAgICAgICAgICAgICAgICAgICAgIF1cbiAgICAgICAgICAgICAgICAgICAgICAgICksXG4gICAgICAgICAgICAgICAgICAgICAgICBfdm0uX3YoXCIgXCIpLFxuICAgICAgICAgICAgICAgICAgICAgICAgX2MoXG4gICAgICAgICAgICAgICAgICAgICAgICAgIFwiZGl2XCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGF0aWNDbGFzczogXCJ2LXMtYm94ZXMgcHktM1wiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNsYXNzOiB7IGltYWdlczogYXR0cmlidXRlLnR5cGUgPT09IFwiaW1hZ2VcIiB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICBbXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgX3ZtLmFkZFBsZWFzZVNlbGVjdE9wdGlvblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPyBfYyhcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImRpdlwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0YXRpY0NsYXNzOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInYtcy1ib3ggYmctd2hpdGUgZW1wdHktb3B0aW9uXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbGFzczoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhY3RpdmU6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX3ZtLnNlbGVjdGVkQXR0cmlidXRlc1tcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGF0dHJpYnV0ZS5hdHRyaWJ1dGVJZFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF0gPT09IC0xLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbnZhbGlkOiAhX3ZtLmlzQXR0cmlidXRlU2VsZWN0aW9uVmFsaWQoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXR0cmlidXRlLmF0dHJpYnV0ZUlkLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC0xXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXR0cnM6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJkYXRhLXRlc3RpbmdcIjogXCJ2YXJpYXRpb24tc2VsZWN0LWJveFwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9uOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNsaWNrOiBmdW5jdGlvbiAoJGV2ZW50KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIF92bS5zZWxlY3RBdHRyaWJ1dGUoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhdHRyaWJ1dGUuYXR0cmlidXRlSWQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAtMVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIClcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBbXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfYyhcInNwYW5cIiwgeyBzdGF0aWNDbGFzczogXCJteC0zXCIgfSwgW1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfdm0uX3YoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX3ZtLl9zKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX3ZtLiR0cmFuc2xhdGUoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiQ2VyZXM6OlRlbXBsYXRlLnNpbmdsZUl0ZW1QbGVhc2VTZWxlY3RcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIClcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF0pLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgOiBfdm0uX2UoKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfdm0uX3YoXCIgXCIpLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF92bS5oYXNFbXB0eU9wdGlvblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPyBfYyhcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImRpdlwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0YXRpY0NsYXNzOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInYtcy1ib3ggYmctd2hpdGUgZW1wdHktb3B0aW9uXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbGFzczoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhY3RpdmU6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX3ZtLnNlbGVjdGVkQXR0cmlidXRlc1tcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGF0dHJpYnV0ZS5hdHRyaWJ1dGVJZFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF0gPT09IG51bGwsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGludmFsaWQ6ICFfdm0uaXNBdHRyaWJ1dGVTZWxlY3Rpb25WYWxpZChcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhdHRyaWJ1dGUuYXR0cmlidXRlSWQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbnVsbCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0cnVlXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXR0cnM6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJkYXRhLXRlc3RpbmdcIjogXCJ2YXJpYXRpb24tc2VsZWN0LWJveFwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9uOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNsaWNrOiBmdW5jdGlvbiAoJGV2ZW50KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIF92bS5zZWxlY3RBdHRyaWJ1dGUoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhdHRyaWJ1dGUuYXR0cmlidXRlSWQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBudWxsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9jKFwic3BhblwiLCB7IHN0YXRpY0NsYXNzOiBcIm14LTNcIiB9LCBbXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF92bS5fdihcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfdm0uX3MoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfdm0uJHRyYW5zbGF0ZShcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJDZXJlczo6VGVtcGxhdGUuc2luZ2xlSXRlbU5vU2VsZWN0aW9uXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIClcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBdKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBdXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIClcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDogX3ZtLl9lKCksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgX3ZtLl92KFwiIFwiKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfdm0uX2woYXR0cmlidXRlLnZhbHVlcywgZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gX2MoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiZGl2XCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkaXJlY3RpdmVzOiBbXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6IFwidG9vbHRpcFwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByYXdOYW1lOiBcInYtdG9vbHRpcFwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZTogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZXhwcmVzc2lvbjogXCJ0cnVlXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAga2V5OiB2YWx1ZS5hdHRyaWJ1dGVWYWx1ZUlkLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0YXRpY0NsYXNzOiBcInYtcy1ib3ggYmctd2hpdGVcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbGFzczoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYWN0aXZlOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZS5hdHRyaWJ1dGVWYWx1ZUlkID09PVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfdm0uc2VsZWN0ZWRBdHRyaWJ1dGVzW1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGF0dHJpYnV0ZS5hdHRyaWJ1dGVJZFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBdLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaW52YWxpZDogIV92bS5pc0F0dHJpYnV0ZVNlbGVjdGlvblZhbGlkKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhdHRyaWJ1dGUuYXR0cmlidXRlSWQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlLmF0dHJpYnV0ZVZhbHVlSWQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRydWVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhdHRyczoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJkYXRhLXRlc3RpbmdcIjogXCJ2YXJpYXRpb24tc2VsZWN0LWJveFwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJkYXRhLWh0bWxcIjogXCJ0cnVlXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImRhdGEtdG9nZ2xlXCI6IFwidG9vbHRpcFwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJkYXRhLXBsYWNlbWVudFwiOiBcInRvcFwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJkYXRhLW9yaWdpbmFsLXRpdGxlXCI6IF92bS5nZXRUb29sdGlwKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhdHRyaWJ1dGUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb246IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNsaWNrOiBmdW5jdGlvbiAoJGV2ZW50KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBfdm0uc2VsZWN0QXR0cmlidXRlKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGF0dHJpYnV0ZS5hdHRyaWJ1dGVJZCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZS5hdHRyaWJ1dGVWYWx1ZUlkXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIClcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgW1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGF0dHJpYnV0ZS50eXBlID09PSBcImJveFwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA/IF9jKFwic3BhblwiLCB7IHN0YXRpY0NsYXNzOiBcIm14LTNcIiB9LCBbXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX3ZtLl92KF92bS5fcyh2YWx1ZS5uYW1lKSksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF0pXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA6IF9jKFwiaW1nXCIsIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGF0aWNDbGFzczogXCJwLTFcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhdHRyczoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3JjOiB2YWx1ZS5pbWFnZVVybCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFsdDogdmFsdWUubmFtZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgICAgICAgICAgICAgICBdLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAyXG4gICAgICAgICAgICAgICAgICAgICAgICApLFxuICAgICAgICAgICAgICAgICAgICAgIF0pXG4gICAgICAgICAgICAgICAgICAgIDogX3ZtLl9lKCksXG4gICAgICAgICAgICAgICAgXVxuICAgICAgICAgICAgICApXG4gICAgICAgICAgICB9KSxcbiAgICAgICAgICAgIF92bS5fdihcIiBcIiksXG4gICAgICAgICAgICBfdm0ucG9zc2libGVVbml0Q29tYmluYXRpb25JZHMubGVuZ3RoID4gMSAmJiBfdm0uaXNDb250ZW50VmlzaWJsZVxuICAgICAgICAgICAgICA/IF9jKFwiZGl2XCIsIHsgc3RhdGljQ2xhc3M6IFwiY29sLTEyIHZhcmlhdGlvbi1zZWxlY3RcIiB9LCBbXG4gICAgICAgICAgICAgICAgICBfYyhcImRpdlwiLCB7IHN0YXRpY0NsYXNzOiBcImlucHV0LXVuaXRcIiB9LCBbXG4gICAgICAgICAgICAgICAgICAgIF9jKFxuICAgICAgICAgICAgICAgICAgICAgIFwic2VsZWN0XCIsXG4gICAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgc3RhdGljQ2xhc3M6IFwiY3VzdG9tLXNlbGVjdFwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgYXR0cnM6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgaWQ6IFwidW5pdC1jb21iaW5hdGlvbi1pZHMtc2VsZWN0XCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgIFwiZGF0YS10ZXN0aW5nXCI6IFwidmFyaWF0aW9uLXNlbGVjdC11bml0XCIsXG4gICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgb246IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgY2hhbmdlOiBmdW5jdGlvbiAoJGV2ZW50KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIF92bS5zZWxlY3RVbml0KCRldmVudC50YXJnZXQudmFsdWUpXG4gICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgX3ZtLl9sKFxuICAgICAgICAgICAgICAgICAgICAgICAgX3ZtLnBvc3NpYmxlVW5pdENvbWJpbmF0aW9uSWRzLFxuICAgICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gKHVuaXRDb21iaW5hdGlvbklkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBfYyhcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIm9wdGlvblwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGtleTogdW5pdENvbWJpbmF0aW9uSWQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkb21Qcm9wczoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZTogdW5pdENvbWJpbmF0aW9uSWQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbGVjdGVkOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhcnNlSW50KHVuaXRDb21iaW5hdGlvbklkKSA9PT1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfdm0uc2VsZWN0ZWRVbml0LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF92bS5pc1VuaXRTZWxlY3Rpb25WYWxpZCh1bml0Q29tYmluYXRpb25JZClcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPyBbXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfdm0uX3YoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiXFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiICtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfdm0uX3MoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfdm0ucG9zc2libGVVbml0c1t1bml0Q29tYmluYXRpb25JZF1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApICtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIlxcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgOiBbXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfdm0uX3YoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiXFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiICtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfdm0uX3MoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfdm0uJHRyYW5zbGF0ZShcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJDZXJlczo6VGVtcGxhdGUuc2luZ2xlSXRlbUludmFsaWRBdHRyaWJ1dGVcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6IF92bS5wb3NzaWJsZVVuaXRzW1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdW5pdENvbWJpbmF0aW9uSWRcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBdLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKSArXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJcXG4gICAgICAgICAgICAgICAgICAgICAgICBcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBdLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgMlxuICAgICAgICAgICAgICAgICAgICAgICAgICApXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgKSxcbiAgICAgICAgICAgICAgICAgICAgICAwXG4gICAgICAgICAgICAgICAgICAgICksXG4gICAgICAgICAgICAgICAgICAgIF92bS5fdihcIiBcIiksXG4gICAgICAgICAgICAgICAgICAgIF9jKFxuICAgICAgICAgICAgICAgICAgICAgIFwibGFiZWxcIixcbiAgICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICBhdHRyczoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICBmb3I6IFwidW5pdC1jb21iaW5hdGlvbi1pZHMtc2VsZWN0XCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgIFwiZGF0YS10ZXN0aW5nXCI6IFwidmFyaWF0aW9uLXNlbGVjdC11bml0LWxhYmVsXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgW1xuICAgICAgICAgICAgICAgICAgICAgICAgX3ZtLl92KFxuICAgICAgICAgICAgICAgICAgICAgICAgICBfdm0uX3MoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgX3ZtLiR0cmFuc2xhdGUoXCJDZXJlczo6VGVtcGxhdGUuc2luZ2xlSXRlbUNvbnRlbnRcIilcbiAgICAgICAgICAgICAgICAgICAgICAgICAgKVxuICAgICAgICAgICAgICAgICAgICAgICAgKSxcbiAgICAgICAgICAgICAgICAgICAgICBdXG4gICAgICAgICAgICAgICAgICAgICksXG4gICAgICAgICAgICAgICAgICBdKSxcbiAgICAgICAgICAgICAgICBdKVxuICAgICAgICAgICAgICA6IF92bS5fZSgpLFxuICAgICAgICAgIF1cbiAgICAgICAgOiBbX3ZtLl90KFwiZGVmYXVsdFwiKV0sXG4gICAgXSxcbiAgICAyXG4gIClcbn1cbnZhciBzdGF0aWNSZW5kZXJGbnMgPSBbXVxucmVuZGVyLl93aXRoU3RyaXBwZWQgPSB0cnVlXG5cbmV4cG9ydCB7IHJlbmRlciwgc3RhdGljUmVuZGVyRm5zIH0iLCJleHBvcnQgKiBmcm9tIFwiLSEuLi8uLi8uLi8uLi8uLi8uLi9ub2RlX21vZHVsZXMvdnVlLWxvYWRlci9saWIvbG9hZGVycy90ZW1wbGF0ZUxvYWRlci5qcz8/cnVsZVNldFsxXS5ydWxlc1syXSEuLi8uLi8uLi8uLi8uLi8uLi9ub2RlX21vZHVsZXMvdnVlLWxvYWRlci9saWIvaW5kZXguanM/P3Z1ZS1sb2FkZXItb3B0aW9ucyEuL1ZhcmlhdGlvblNlbGVjdC52dWU/dnVlJnR5cGU9dGVtcGxhdGUmaWQ9NTg4YzE4ODcmXCIiLCI8dGVtcGxhdGU+XG4gICAgPGRpdiBjbGFzcz1cInJvd1wiPlxuICAgICAgICA8dGVtcGxhdGUgdi1pZj1cImF0dHJpYnV0ZXMubGVuZ3RoIHx8IChwb3NzaWJsZVVuaXRDb21iaW5hdGlvbklkcy5sZW5ndGggPiAxICYmIGlzQ29udGVudFZpc2libGUpXCI+XG4gICAgICAgICAgICA8ZGl2IGNsYXNzPVwiY29sLTEyIHZhcmlhdGlvbi1zZWxlY3RcIiB2LWZvcj1cIihhdHRyaWJ1dGUsIGluZGV4KSBpbiBhdHRyaWJ1dGVzXCIgOmtleT1cImluZGV4XCI+XG4gICAgICAgICAgICAgICAgPCEtLSBkcm9wZG93biAtLT5cbiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVwiaW5wdXQtdW5pdFwiIHJlZj1cImF0dHJpYnV0ZXNDb250YW5lclwiIHYtaWY9XCJhdHRyaWJ1dGUudHlwZSA9PT0gJ2Ryb3Bkb3duJ1wiPlxuICAgICAgICAgICAgICAgICAgICA8c2VsZWN0IDppZD1cIidjdXN0b20tc2VsZWN0XycgKyBhdHRyaWJ1dGUubmFtZVwiIGNsYXNzPVwiY3VzdG9tLXNlbGVjdFwiIEBjaGFuZ2U9XCJzZWxlY3RBdHRyaWJ1dGUoYXR0cmlidXRlLmF0dHJpYnV0ZUlkLCAkZXZlbnQudGFyZ2V0LnZhbHVlKVwiIGRhdGEtdGVzdGluZz1cInZhcmlhdGlvbi1zZWxlY3QtZHJvcGRvd25cIj5cbiAgICAgICAgICAgICAgICAgICAgICAgIDxvcHRpb24gOnZhbHVlPVwiLTFcIiB2LWlmPVwiYWRkUGxlYXNlU2VsZWN0T3B0aW9uIHx8ICFoYXNTZWxlY3Rpb25cIj57eyAkdHJhbnNsYXRlKFwiQ2VyZXM6OlRlbXBsYXRlLnNpbmdsZUl0ZW1QbGVhc2VTZWxlY3RcIikgfX08L29wdGlvbj5cbiAgICAgICAgICAgICAgICAgICAgICAgIDxvcHRpb25cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgOnZhbHVlPVwibnVsbFwiIHYtaWY9XCJoYXNFbXB0eU9wdGlvbiB8fCBzZWxlY3RlZEF0dHJpYnV0ZXNbYXR0cmlidXRlLmF0dHJpYnV0ZUlkXSA9PT0gbnVsbFwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDpzZWxlY3RlZD1cInNlbGVjdGVkQXR0cmlidXRlc1thdHRyaWJ1dGUuYXR0cmlidXRlSWRdID09PSBudWxsXCI+e3sgJHRyYW5zbGF0ZShcIkNlcmVzOjpUZW1wbGF0ZS5zaW5nbGVJdGVtTm9TZWxlY3Rpb25cIikgfX08L29wdGlvbj5cbiAgICAgICAgICAgICAgICAgICAgICAgIDxvcHRpb25cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdi1mb3I9XCJ2YWx1ZSBpbiBhdHRyaWJ1dGUudmFsdWVzXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgOnZhbHVlPVwidmFsdWUuYXR0cmlidXRlVmFsdWVJZFwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDpzZWxlY3RlZD1cInZhbHVlLmF0dHJpYnV0ZVZhbHVlSWQgPT09IHNlbGVjdGVkQXR0cmlidXRlc1thdHRyaWJ1dGUuYXR0cmlidXRlSWRdXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgOmtleT1cInZhbHVlLmF0dHJpYnV0ZVZhbHVlSWRcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8dGVtcGxhdGUgdi1pZj1cImlzQXR0cmlidXRlU2VsZWN0aW9uVmFsaWQoYXR0cmlidXRlLmF0dHJpYnV0ZUlkLCB2YWx1ZS5hdHRyaWJ1dGVWYWx1ZUlkLCB0cnVlKVwiPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7eyB2YWx1ZS5uYW1lIH19XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPC90ZW1wbGF0ZT5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8dGVtcGxhdGUgdi1lbHNlLWlmPVwiaXNBdHRyaWJ1dGVTZWxlY3Rpb25WYWxpZChhdHRyaWJ1dGUuYXR0cmlidXRlSWQsIHZhbHVlLmF0dHJpYnV0ZVZhbHVlSWQsIGZhbHNlKVwiPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7eyAkdHJhbnNsYXRlKFwiQ2VyZXM6OlRlbXBsYXRlLnNpbmdsZUl0ZW1Ob3RTYWxhYmxlQXR0cmlidXRlXCIsIHsgXCJuYW1lXCI6IHZhbHVlLm5hbWUgfSkgfX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L3RlbXBsYXRlPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDx0ZW1wbGF0ZSB2LWVsc2U+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHt7ICR0cmFuc2xhdGUoXCJDZXJlczo6VGVtcGxhdGUuc2luZ2xlSXRlbUludmFsaWRBdHRyaWJ1dGVcIiwgeyBcIm5hbWVcIjogdmFsdWUubmFtZSB9KSB9fVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvdGVtcGxhdGU+XG4gICAgICAgICAgICAgICAgICAgICAgICA8L29wdGlvbj5cbiAgICAgICAgICAgICAgICAgICAgPC9zZWxlY3Q+XG4gICAgICAgICAgICAgICAgICAgIDxsYWJlbCA6Zm9yPVwiJ2N1c3RvbS1zZWxlY3RfJyArIGF0dHJpYnV0ZS5uYW1lXCIgdi10b29sdGlwPVwiaXNUZXh0Q3V0KGF0dHJpYnV0ZS5uYW1lKVwiIGRhdGEtdG9nZ2xlPVwidG9vbHRpcFwiIGRhdGEtcGxhY2VtZW50PVwidG9wXCIgOnRpdGxlPVwiYXR0cmlidXRlLm5hbWVcIiBkYXRhLXRlc3Rpbmc9XCJ2YXJpYXRpb24tc2VsZWN0LWRyb3Bkb3duLWxhYmVsXCI+e3sgYXR0cmlidXRlLm5hbWUgfX08L2xhYmVsPlxuICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgIDwhLS0gL2Ryb3Bkb3duIC0tPlxuXG4gICAgICAgICAgICAgICAgPCEtLSBib3ggYW5kIGltYWdlIC0tPlxuICAgICAgICAgICAgICAgIDxkaXYgdi1lbHNlLWlmPVwiYXR0cmlidXRlLnR5cGUgPT09ICdib3gnIHx8IGF0dHJpYnV0ZS50eXBlID09PSAnaW1hZ2UnXCI+XG4gICAgICAgICAgICAgICAgICAgIDxzcGFuIGNsYXNzPVwidGV4dC1tdXRlZFwiIGRhdGEtdGVzdGluZz1cImF0dHJpYnV0ZS1uYW1lXCI+e3sgYXR0cmlidXRlLm5hbWUgfX06PC9zcGFuPiA8YiBkYXRhLXRlc3Rpbmc9XCJhdHRyaWJ1dGUtdmFsdWVcIj57eyBnZXRTZWxlY3RlZEF0dHJpYnV0ZVZhbHVlTmFtZShhdHRyaWJ1dGUpIH19PC9iPlxuICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVwidi1zLWJveGVzIHB5LTNcIiA6Y2xhc3M9XCJ7ICdpbWFnZXMnOiBhdHRyaWJ1dGUudHlwZSA9PT0gJ2ltYWdlJyB9XCI+XG4gICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVwidi1zLWJveCBiZy13aGl0ZSBlbXB0eS1vcHRpb25cIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYXRhLXRlc3Rpbmc9XCJ2YXJpYXRpb24tc2VsZWN0LWJveFwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgIHYtaWY9XCJhZGRQbGVhc2VTZWxlY3RPcHRpb25cIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICBAY2xpY2s9XCJzZWxlY3RBdHRyaWJ1dGUoYXR0cmlidXRlLmF0dHJpYnV0ZUlkLCAtMSlcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICA6Y2xhc3M9XCJ7ICdhY3RpdmUnOiBzZWxlY3RlZEF0dHJpYnV0ZXNbYXR0cmlidXRlLmF0dHJpYnV0ZUlkXSA9PT0gLTEsICdpbnZhbGlkJzogIWlzQXR0cmlidXRlU2VsZWN0aW9uVmFsaWQoYXR0cmlidXRlLmF0dHJpYnV0ZUlkLCAtMSkgfVwiPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxzcGFuIGNsYXNzPVwibXgtM1wiPnt7ICR0cmFuc2xhdGUoXCJDZXJlczo6VGVtcGxhdGUuc2luZ2xlSXRlbVBsZWFzZVNlbGVjdFwiKSB9fTwvc3Bhbj5cbiAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cInYtcy1ib3ggYmctd2hpdGUgZW1wdHktb3B0aW9uXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGF0YS10ZXN0aW5nPVwidmFyaWF0aW9uLXNlbGVjdC1ib3hcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2LWlmPVwiaGFzRW1wdHlPcHRpb25cIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICBAY2xpY2s9XCJzZWxlY3RBdHRyaWJ1dGUoYXR0cmlidXRlLmF0dHJpYnV0ZUlkLCBudWxsKVwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgIDpjbGFzcz1cInsgJ2FjdGl2ZSc6IHNlbGVjdGVkQXR0cmlidXRlc1thdHRyaWJ1dGUuYXR0cmlidXRlSWRdID09PSBudWxsLCAnaW52YWxpZCc6ICFpc0F0dHJpYnV0ZVNlbGVjdGlvblZhbGlkKGF0dHJpYnV0ZS5hdHRyaWJ1dGVJZCwgbnVsbCwgdHJ1ZSkgfVwiPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxzcGFuIGNsYXNzPVwibXgtM1wiPnt7ICR0cmFuc2xhdGUoXCJDZXJlczo6VGVtcGxhdGUuc2luZ2xlSXRlbU5vU2VsZWN0aW9uXCIpIH19PC9zcGFuPlxuICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJ2LXMtYm94IGJnLXdoaXRlXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGF0YS10ZXN0aW5nPVwidmFyaWF0aW9uLXNlbGVjdC1ib3hcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2LWZvcj1cInZhbHVlIGluIGF0dHJpYnV0ZS52YWx1ZXNcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICBAY2xpY2s9XCJzZWxlY3RBdHRyaWJ1dGUoYXR0cmlidXRlLmF0dHJpYnV0ZUlkLCB2YWx1ZS5hdHRyaWJ1dGVWYWx1ZUlkKVwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgIDpjbGFzcz1cInsgJ2FjdGl2ZSc6IHZhbHVlLmF0dHJpYnV0ZVZhbHVlSWQgPT09IHNlbGVjdGVkQXR0cmlidXRlc1thdHRyaWJ1dGUuYXR0cmlidXRlSWRdLCAnaW52YWxpZCc6ICFpc0F0dHJpYnV0ZVNlbGVjdGlvblZhbGlkKGF0dHJpYnV0ZS5hdHRyaWJ1dGVJZCwgdmFsdWUuYXR0cmlidXRlVmFsdWVJZCwgdHJ1ZSkgfVwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgIHYtdG9vbHRpcD1cInRydWVcIiBkYXRhLWh0bWw9XCJ0cnVlXCIgZGF0YS10b2dnbGU9XCJ0b29sdGlwXCIgZGF0YS1wbGFjZW1lbnQ9XCJ0b3BcIiA6ZGF0YS1vcmlnaW5hbC10aXRsZT1cImdldFRvb2x0aXAoYXR0cmlidXRlLCB2YWx1ZSlcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICA6a2V5PVwidmFsdWUuYXR0cmlidXRlVmFsdWVJZFwiPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxzcGFuIGNsYXNzPVwibXgtM1wiIHYtaWY9XCJhdHRyaWJ1dGUudHlwZSA9PT0gJ2JveCdcIj57eyB2YWx1ZS5uYW1lIH19PC9zcGFuPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxpbWcgY2xhc3M9XCJwLTFcIiB2LWVsc2UgOnNyYz1cInZhbHVlLmltYWdlVXJsXCIgOmFsdD1cInZhbHVlLm5hbWVcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICA8IS0tIC9ib3ggYW5kIGltYWdlIC0tPlxuICAgICAgICAgICAgPC9kaXY+XG5cbiAgICAgICAgICAgIDwhLS0gdW5pdHMgLS0+XG4gICAgICAgICAgICA8ZGl2IGNsYXNzPVwiY29sLTEyIHZhcmlhdGlvbi1zZWxlY3RcIiB2LWlmPVwicG9zc2libGVVbml0Q29tYmluYXRpb25JZHMubGVuZ3RoID4gMSAmJiBpc0NvbnRlbnRWaXNpYmxlXCI+XG4gICAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cImlucHV0LXVuaXRcIj5cbiAgICAgICAgICAgICAgICAgICAgPHNlbGVjdCBpZD1cInVuaXQtY29tYmluYXRpb24taWRzLXNlbGVjdFwiIGNsYXNzPVwiY3VzdG9tLXNlbGVjdFwiIEBjaGFuZ2U9XCJzZWxlY3RVbml0KCRldmVudC50YXJnZXQudmFsdWUpXCIgZGF0YS10ZXN0aW5nPVwidmFyaWF0aW9uLXNlbGVjdC11bml0XCI+XG4gICAgICAgICAgICAgICAgICAgICAgICA8b3B0aW9uXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHYtZm9yPVwidW5pdENvbWJpbmF0aW9uSWQgaW4gcG9zc2libGVVbml0Q29tYmluYXRpb25JZHNcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA6dmFsdWU9XCJ1bml0Q29tYmluYXRpb25JZFwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDpzZWxlY3RlZD1cInBhcnNlSW50KHVuaXRDb21iaW5hdGlvbklkKSA9PT0gc2VsZWN0ZWRVbml0XCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgOmtleT1cInVuaXRDb21iaW5hdGlvbklkXCI+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPHRlbXBsYXRlIHYtaWY9XCJpc1VuaXRTZWxlY3Rpb25WYWxpZCh1bml0Q29tYmluYXRpb25JZClcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAge3sgcG9zc2libGVVbml0c1t1bml0Q29tYmluYXRpb25JZF0gfX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L3RlbXBsYXRlPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDx0ZW1wbGF0ZSB2LWVsc2U+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHt7ICR0cmFuc2xhdGUoXCJDZXJlczo6VGVtcGxhdGUuc2luZ2xlSXRlbUludmFsaWRBdHRyaWJ1dGVcIiwgeyBcIm5hbWVcIjogcG9zc2libGVVbml0c1t1bml0Q29tYmluYXRpb25JZF0gfSkgfX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L3RlbXBsYXRlPlxuICAgICAgICAgICAgICAgICAgICAgICAgPC9vcHRpb24+XG4gICAgICAgICAgICAgICAgICAgIDwvc2VsZWN0PlxuICAgICAgICAgICAgICAgICAgICA8bGFiZWwgZm9yPVwidW5pdC1jb21iaW5hdGlvbi1pZHMtc2VsZWN0XCIgZGF0YS10ZXN0aW5nPVwidmFyaWF0aW9uLXNlbGVjdC11bml0LWxhYmVsXCI+e3sgJHRyYW5zbGF0ZShcIkNlcmVzOjpUZW1wbGF0ZS5zaW5nbGVJdGVtQ29udGVudFwiKSB9fTwvbGFiZWw+XG4gICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgIDwhLS0gL3VuaXRzIC0tPlxuICAgICAgICA8L3RlbXBsYXRlPlxuXG4gICAgICAgIDx0ZW1wbGF0ZSB2LWVsc2U+XG4gICAgICAgICAgICA8c2xvdD48L3Nsb3Q+XG4gICAgICAgIDwvdGVtcGxhdGU+XG4gICAgPC9kaXY+XG48L3RlbXBsYXRlPlxuXG48c2NyaXB0PlxuaW1wb3J0IHsgdGV4dFdpZHRoIH0gZnJvbSBcIi4uLy4uL2hlbHBlci9kb21cIjtcbmltcG9ydCB7IGlzRGVmaW5lZCwgaXNOdWxsLCBpc051bGxPclVuZGVmaW5lZCB9IGZyb20gXCIuLi8uLi9oZWxwZXIvdXRpbHNcIjtcblxuY29uc3QgTm90aWZpY2F0aW9uU2VydmljZSA9IHJlcXVpcmUoXCIuLi8uLi9zZXJ2aWNlcy9Ob3RpZmljYXRpb25TZXJ2aWNlXCIpO1xuXG5leHBvcnQgZGVmYXVsdCB7XG5cbiAgICBuYW1lOiBcInZhcmlhdGlvbi1zZWxlY3RcIixcblxuICAgIHByb3BzOiB7XG4gICAgICAgIGZvcmNlQ29udGVudDpcbiAgICAgICAge1xuICAgICAgICAgICAgdHlwZTogQm9vbGVhbixcbiAgICAgICAgICAgIGRlZmF1bHQ6IGZhbHNlXG4gICAgICAgIH1cbiAgICB9LFxuXG4gICAgaW5qZWN0OiB7XG4gICAgICAgIGl0ZW1JZDoge1xuICAgICAgICAgICAgZGVmYXVsdDogbnVsbFxuICAgICAgICB9XG4gICAgfSxcblxuICAgIGRhdGEoKVxuICAgIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIGZpbHRlcmVkVmFyaWF0aW9uc0NhY2hlOiB7fSxcbiAgICAgICAgICAgIGxhc3RDb250ZW50Q291bnQ6IDBcbiAgICAgICAgfTtcbiAgICB9LFxuXG4gICAgbW91bnRlZCgpXG4gICAge1xuICAgICAgICAvLyBpbml0aWFsbHkgY2hlY2sgZm9yIHZhbGlkIHNlbGVjdGlvbiBhbmQgZGlzYWJsZSBhZGQgdG8gYmFza2V0IGJ1dHRvblxuICAgICAgICB0aGlzLiRzdG9yZS5jb21taXQoYCR7dGhpcy5pdGVtSWR9L3ZhcmlhdGlvblNlbGVjdC9zZXRJc1ZhcmlhdGlvblNlbGVjdGVkYCwgISF0aGlzLmN1cnJlbnRTZWxlY3Rpb24pO1xuICAgIH0sXG5cbiAgICBjb21wdXRlZDpcbiAgICB7XG4gICAgICAgIGN1cnJlbnRWYXJpYXRpb24oKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy4kc3RvcmUuZ2V0dGVyc1tgJHt0aGlzLml0ZW1JZH0vY3VycmVudEl0ZW1WYXJpYXRpb25gXTtcbiAgICAgICAgfSxcblxuICAgICAgICBjdXJyZW50VmFyaWF0aW9uU2VsZWN0KCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuJHN0b3JlLnN0YXRlLml0ZW1zW3RoaXMuaXRlbUlkXSAmJiB0aGlzLiRzdG9yZS5zdGF0ZS5pdGVtc1t0aGlzLml0ZW1JZF0udmFyaWF0aW9uU2VsZWN0O1xuICAgICAgICB9LFxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiByZXR1cm5zIHRydWUgaWYgYW55IHZhcmlhdGlvbiBoYXMgbm8gYXR0cmlidXRlc1xuICAgICAgICAgKi9cbiAgICAgICAgaGFzRW1wdHlPcHRpb24oKVxuICAgICAgICB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy52YXJpYXRpb25zLnNvbWUodmFyaWF0aW9uID0+ICF2YXJpYXRpb24uYXR0cmlidXRlcy5sZW5ndGgpO1xuICAgICAgICB9LFxuXG4gICAgICAgIGFkZFBsZWFzZVNlbGVjdE9wdGlvbigpXG4gICAgICAgIHtcbiAgICAgICAgICAgIHJldHVybiBBcHAuY29uZmlnLml0ZW0uc2hvd1BsZWFzZVNlbGVjdDtcbiAgICAgICAgfSxcblxuICAgICAgICAvKipcbiAgICAgICAgICogcmV0dXJucyB0aGUgdmFyaWF0aW9uLCBiYXNlZCBvbiB0aGUgc2VsZWN0ZWQgYXR0cmlidXRlcyAvIHVuaXRcbiAgICAgICAgICogcmV0dXJucyBmYWxzZSBpZiB0aGVyZSBhcmUgbm9uZSBvciBtdWx0aXBsZSByZXN1bHRzXG4gICAgICAgICAqL1xuICAgICAgICBjdXJyZW50U2VsZWN0aW9uKClcbiAgICAgICAge1xuICAgICAgICAgICAgY29uc3QgZmlsdGVyZWRWYXJpYXRpb25zID0gdGhpcy5maWx0ZXJWYXJpYXRpb25zKG51bGwsIG51bGwsIHRydWUpO1xuXG4gICAgICAgICAgICBpZiAoZmlsdGVyZWRWYXJpYXRpb25zLmxlbmd0aCA9PT0gMSlcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZmlsdGVyZWRWYXJpYXRpb25zWzBdO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH0sXG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIHJldHVybnMgYWxsIHVuaXRzLCBzZWxlY3RhYmxlIGJ5IGN1cnJlbnQgc2VsZWN0aW9uXG4gICAgICAgICAqIHByb3AgJ2ZvcmNlQ29udGVudCcgd2l0aCB2YWx1ZSB0cnVlIHdpbGwgcmV0dXJuIGFsbCB1bml0cywgd2l0aG91dCBmaWx0ZXJpbmdcbiAgICAgICAgICovXG4gICAgICAgIHBvc3NpYmxlVW5pdHMoKVxuICAgICAgICB7XG4gICAgICAgICAgICAvLyB1c2UgYW4gb2JqZWN0LCB0byBtYWtlIHRoZSBlbnRyaWVzIHVuaXF1ZVxuICAgICAgICAgICAgY29uc3QgcG9zc2libGVVbml0cyA9IHt9O1xuICAgICAgICAgICAgY29uc3QgdmFyaWF0aW9ucyA9IHRoaXMuZm9yY2VDb250ZW50ID8gdGhpcy52YXJpYXRpb25zIDogdGhpcy5maWx0ZXJWYXJpYXRpb25zKG51bGwsIG51bGwsIG51bGwsIHRydWUpO1xuXG4gICAgICAgICAgICBmb3IgKGNvbnN0IHZhcmlhdGlvbiBvZiB2YXJpYXRpb25zKVxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIHBvc3NpYmxlVW5pdHNbdmFyaWF0aW9uLnVuaXRDb21iaW5hdGlvbklkXSA9IHZhcmlhdGlvbi51bml0TmFtZTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgcmV0dXJuIHBvc3NpYmxlVW5pdHM7XG4gICAgICAgIH0sXG5cbiAgICAgICAgcG9zc2libGVVbml0Q29tYmluYXRpb25JZHMoKVxuICAgICAgICB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy50cmFuc2Zvcm1Qb3NzaWJsZVVuaXRzKHRoaXMucG9zc2libGVVbml0cykubWFwKHZhbHVlID0+IHZhbHVlWzBdKTtcbiAgICAgICAgfSxcblxuICAgICAgICBpc0NvbnRlbnRWaXNpYmxlKClcbiAgICAgICAge1xuICAgICAgICAgICAgcmV0dXJuICF0aGlzLmZvcmNlQ29udGVudCAmJiAhIXRoaXMuY3VycmVudFNlbGVjdGlvbiB8fCB0aGlzLmZvcmNlQ29udGVudDtcbiAgICAgICAgfSxcblxuICAgICAgICBoYXNTZWxlY3Rpb24oKVxuICAgICAgICB7XG4gICAgICAgICAgICByZXR1cm4gIWlzTnVsbE9yVW5kZWZpbmVkKHRoaXMuc2VsZWN0ZWRBdHRyaWJ1dGVzKSAmJiAhT2JqZWN0LnZhbHVlcyh0aGlzLnNlbGVjdGVkQXR0cmlidXRlcykuc29tZSgodmFsdWUpID0+IHZhbHVlIDwgMCk7XG4gICAgICAgIH0sXG5cbiAgICAgICAgYXR0cmlidXRlcygpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmN1cnJlbnRWYXJpYXRpb25TZWxlY3QgJiYgdGhpcy5jdXJyZW50VmFyaWF0aW9uU2VsZWN0LmF0dHJpYnV0ZXM7XG4gICAgICAgIH0sXG5cbiAgICAgICAgc2VsZWN0ZWRBdHRyaWJ1dGVzKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuY3VycmVudFZhcmlhdGlvblNlbGVjdCAmJiB0aGlzLmN1cnJlbnRWYXJpYXRpb25TZWxlY3Quc2VsZWN0ZWRBdHRyaWJ1dGVzO1xuICAgICAgICB9LFxuXG4gICAgICAgIHNlbGVjdGVkVW5pdCgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmN1cnJlbnRWYXJpYXRpb25TZWxlY3QgJiYgdGhpcy5jdXJyZW50VmFyaWF0aW9uU2VsZWN0LnNlbGVjdGVkVW5pdDtcbiAgICAgICAgfSxcblxuICAgICAgICB2YXJpYXRpb25zKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuY3VycmVudFZhcmlhdGlvblNlbGVjdCAmJiB0aGlzLmN1cnJlbnRWYXJpYXRpb25TZWxlY3QudmFyaWF0aW9ucztcbiAgICAgICAgfVxuICAgIH0sXG5cbiAgICBtZXRob2RzOlxuICAgIHtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIHNlbGVjdCBhbiBhdHRyaWJ1dGUgYW5kIGNoZWNrLCBpZiB0aGUgc2VsZWN0aW9uIGlzIHZhbGlkOyBpZiBub3QsIHVuc2V0SW52YWxpZFNlbGVjdGlvbiB3aWxsIGJlIGV4ZWN1dGVkXG4gICAgICAgICAqIEBwYXJhbSB7bnVtYmVyfSBhdHRyaWJ1dGVJZFxuICAgICAgICAgKiBAcGFyYW0ge1tudW1iZXIsIHN0cmluZywgbnVsbF19IGF0dHJpYnV0ZVZhbHVlSWRcbiAgICAgICAgICovXG4gICAgICAgIHNlbGVjdEF0dHJpYnV0ZShhdHRyaWJ1dGVJZCwgYXR0cmlidXRlVmFsdWVJZClcbiAgICAgICAge1xuICAgICAgICAgICAgYXR0cmlidXRlVmFsdWVJZCA9IHBhcnNlSW50KGF0dHJpYnV0ZVZhbHVlSWQpIHx8IG51bGw7XG5cbiAgICAgICAgICAgIGlmICh0aGlzLnNlbGVjdGVkQXR0cmlidXRlc1thdHRyaWJ1dGVJZF0gIT09IGF0dHJpYnV0ZVZhbHVlSWQpXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgdGhpcy4kc3RvcmUuY29tbWl0KGAke3RoaXMuaXRlbUlkfS92YXJpYXRpb25TZWxlY3Qvc2VsZWN0SXRlbUF0dHJpYnV0ZWAsIHsgYXR0cmlidXRlSWQsIGF0dHJpYnV0ZVZhbHVlSWQgfSk7XG4gICAgICAgICAgICAgICAgdGhpcy5vblNlbGVjdGlvbkNoYW5nZShhdHRyaWJ1dGVJZCwgYXR0cmlidXRlVmFsdWVJZCwgbnVsbCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIHNlbGVjdCBhIHVuaXQgYW5kIGNoZWNrLCBpZiB0aGUgc2VsZWN0aW9uIGlzIHZhbGlkOyBpZiBub3QsIHVuc2V0SW52YWxpZFNlbGVjdGlvbiB3aWxsIGJlIGV4ZWN1dGVkXG4gICAgICAgICAqIEBwYXJhbSB7W251bWJlciwgc3RyaW5nXX0gdW5pdElkXG4gICAgICAgICAqL1xuICAgICAgICBzZWxlY3RVbml0KHVuaXRJZClcbiAgICAgICAge1xuICAgICAgICAgICAgdW5pdElkID0gcGFyc2VJbnQodW5pdElkKTtcbiAgICAgICAgICAgIHRoaXMuJHN0b3JlLmNvbW1pdChgJHt0aGlzLml0ZW1JZH0vdmFyaWF0aW9uU2VsZWN0L3NlbGVjdEl0ZW1Vbml0YCwgdW5pdElkKTtcbiAgICAgICAgICAgIHRoaXMub25TZWxlY3Rpb25DaGFuZ2UobnVsbCwgbnVsbCwgdW5pdElkKTtcbiAgICAgICAgfSxcblxuICAgICAgICBvblNlbGVjdGlvbkNoYW5nZShhdHRyaWJ1dGVJZCwgYXR0cmlidXRlVmFsdWVJZCwgdW5pdElkKVxuICAgICAgICB7XG4gICAgICAgICAgICBpZiAodGhpcy5jdXJyZW50U2VsZWN0aW9uKVxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIHRoaXMuc2V0VmFyaWF0aW9uKHRoaXMuY3VycmVudFNlbGVjdGlvbi52YXJpYXRpb25JZCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmICghdGhpcy5oYXNTZWxlY3Rpb24pXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgLy8gdXNlciBzd2l0Y2hlZCBiYWNrIHRvIFwicGxlYXNlIHNlbGVjdFwiXG4gICAgICAgICAgICAgICAgdGhpcy5zZXRWYXJpYXRpb24oMCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgdGhpcy51bnNldEludmFsaWRTZWxlY3Rpb24oYXR0cmlidXRlSWQsIGF0dHJpYnV0ZVZhbHVlSWQsIHVuaXRJZCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHRoaXMubGFzdENvbnRlbnRDb3VudCA9IHRoaXMucG9zc2libGVVbml0Q29tYmluYXRpb25JZHMubGVuZ3RoO1xuICAgICAgICB9LFxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBjaGFuZ2VzIHRoZSBzZWxlY3RlZCBhdHRyaWJ1dGVzIC8gdW5pdCwgdG8gZW5zdXJlIGEgdmFsaWQgc2VlbGN0aW9uXG4gICAgICAgICAqIEBwYXJhbSB7W251bWJlciwgbnVsbF19IGF0dHJpYnV0ZUlkXG4gICAgICAgICAqIEBwYXJhbSB7W251bWJlciwgbnVsbF19IGF0dHJpYnV0ZVZhbHVlSWRcbiAgICAgICAgICogQHBhcmFtIHtbbnVtYmVyLCBudWxsXX0gdW5pdElkXG4gICAgICAgICAqL1xuICAgICAgICB1bnNldEludmFsaWRTZWxlY3Rpb24oYXR0cmlidXRlSWQsIGF0dHJpYnV0ZVZhbHVlSWQsIHVuaXRJZClcbiAgICAgICAge1xuICAgICAgICAgICAgY29uc3QgcXVhbGlmaWVkVmFyaWF0aW9ucyA9IHRoaXMuZ2V0UXVhbGlmaWVkVmFyaWF0aW9ucyhhdHRyaWJ1dGVJZCwgYXR0cmlidXRlVmFsdWVJZCwgdW5pdElkKTtcbiAgICAgICAgICAgIGNvbnN0IGNsb3Nlc3RWYXJpYXRpb25zID0gdGhpcy5nZXRDbG9zZXN0VmFyaWF0aW9ucyhxdWFsaWZpZWRWYXJpYXRpb25zKTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gaWYgdGhlIHNhbGFibGUgJ2Nsb3Nlc3RWYXJpYXRpb25zJyBpcyB1bmRlZmluZWQsIHRha2UgdGhlIG5vdC1zYWxhYmxlIG9uZVxuICAgICAgICAgICAgY29uc3QgY2xvc2VzdFZhcmlhdGlvbiA9IGNsb3Nlc3RWYXJpYXRpb25zWzBdIHx8IGNsb3Nlc3RWYXJpYXRpb25zWzFdO1xuXG4gICAgICAgICAgICBpZiAoIWNsb3Nlc3RWYXJpYXRpb24pXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBjb25zdCBpbnZhbGlkU2VsZWN0aW9uID0gdGhpcy5nZXRJbnZhbGlkU2VsZWN0aW9uQnlWYXJpYXRpb24oY2xvc2VzdFZhcmlhdGlvbik7XG5cbiAgICAgICAgICAgIHRoaXMuY29ycmVjdFNlbGVjdGlvbihpbnZhbGlkU2VsZWN0aW9uKTtcbiAgICAgICAgfSxcblxuICAgICAgICBnZXRUb29sdGlwKGF0dHJpYnV0ZSwgYXR0cmlidXRlVmFsdWUpXG4gICAgICAgIHtcbiAgICAgICAgICAgIGlmKCF0aGlzLmlzQXR0cmlidXRlU2VsZWN0aW9uVmFsaWQoYXR0cmlidXRlLmF0dHJpYnV0ZUlkLCBhdHRyaWJ1dGVWYWx1ZS5hdHRyaWJ1dGVWYWx1ZUlkLCB0cnVlKSlcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5nZXRJbnZhbGlkT3B0aW9uVG9vbHRpcChhdHRyaWJ1dGUuYXR0cmlidXRlSWQsIGF0dHJpYnV0ZVZhbHVlLmF0dHJpYnV0ZVZhbHVlSWQpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZihhdHRyaWJ1dGUudHlwZSA9PT0gXCJpbWFnZVwiKVxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLiR0cmFuc2xhdGUoXCJDZXJlczo6VGVtcGxhdGUuc2luZ2xlSXRlbUF0dHJpYnV0ZVRvb2x0aXBcIiwge1xuICAgICAgICAgICAgICAgICAgICBhdHRyaWJ1dGU6IGF0dHJpYnV0ZS5uYW1lLFxuICAgICAgICAgICAgICAgICAgICB2YWx1ZTogYXR0cmlidXRlVmFsdWUubmFtZVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICByZXR1cm4gXCJcIjtcbiAgICAgICAgfSxcblxuICAgICAgICAvKipcbiAgICAgICAgICogcmV0dXJucyBhIHN0cmluZyBmb3IgYm94IHRvb2x0aXBzLCBmb3Igbm90IGF2YWlsYWJsZSBvcHRpb25zXG4gICAgICAgICAqIEBwYXJhbSB7bnVtYmVyfSBhdHRyaWJ1dGVJZFxuICAgICAgICAgKiBAcGFyYW0ge251bWJlcn0gYXR0cmlidXRlVmFsdWVJZFxuICAgICAgICAgKi9cbiAgICAgICAgZ2V0SW52YWxpZE9wdGlvblRvb2x0aXAoYXR0cmlidXRlSWQsIGF0dHJpYnV0ZVZhbHVlSWQpXG4gICAgICAgIHtcbiAgICAgICAgICAgIGNvbnN0IHF1YWxpZmllZFZhcmlhdGlvbnMgPSB0aGlzLmdldFF1YWxpZmllZFZhcmlhdGlvbnMoYXR0cmlidXRlSWQsIGF0dHJpYnV0ZVZhbHVlSWQpO1xuICAgICAgICAgICAgY29uc3QgY2xvc2VzdFZhcmlhdGlvbnMgICA9IHRoaXMuZ2V0Q2xvc2VzdFZhcmlhdGlvbnMocXVhbGlmaWVkVmFyaWF0aW9ucyk7XG5cbiAgICAgICAgICAgIGlmICghY2xvc2VzdFZhcmlhdGlvbnMgfHwgY2xvc2VzdFZhcmlhdGlvbnMubGVuZ3RoIDw9IDApXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIFwiXCI7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGNvbnN0IGludmFsaWRTZWxlY3Rpb25zID0gW1xuICAgICAgICAgICAgICAgICEhY2xvc2VzdFZhcmlhdGlvbnNbMF0gPyB0aGlzLmdldEludmFsaWRTZWxlY3Rpb25CeVZhcmlhdGlvbihjbG9zZXN0VmFyaWF0aW9uc1swXSkgOiBudWxsLFxuICAgICAgICAgICAgICAgICEhY2xvc2VzdFZhcmlhdGlvbnNbMV0gPyB0aGlzLmdldEludmFsaWRTZWxlY3Rpb25CeVZhcmlhdGlvbihjbG9zZXN0VmFyaWF0aW9uc1sxXSkgOiBudWxsXG4gICAgICAgICAgICBdO1xuXG4gICAgICAgICAgICBpZiAoISFpbnZhbGlkU2VsZWN0aW9uc1swXVxuICAgICAgICAgICAgICAgICYmICEhaW52YWxpZFNlbGVjdGlvbnNbMV1cbiAgICAgICAgICAgICAgICAmJiBpbnZhbGlkU2VsZWN0aW9uc1swXS5hdHRyaWJ1dGVzVG9SZXNldC5sZW5ndGggPiBpbnZhbGlkU2VsZWN0aW9uc1sxXS5hdHRyaWJ1dGVzVG9SZXNldC5sZW5ndGgpXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgLy8gdGhlcmUgaXMgYSBub24tc2FsYWJsZSB2YXJpYXRpb24gd2l0aCBsZXNzIGNoYW5nZXNcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy4kdHJhbnNsYXRlKFwiQ2VyZXM6OlRlbXBsYXRlLnNpbmdsZUl0ZW1Ob3RTYWxhYmxlXCIpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBjb25zdCBpbnZhbGlkU2VsZWN0aW9uID0gaW52YWxpZFNlbGVjdGlvbnNbMF0gfHwgaW52YWxpZFNlbGVjdGlvbnNbMV07XG4gICAgICAgICAgICBjb25zdCBuYW1lcyA9IFtdO1xuXG4gICAgICAgICAgICBmb3IgKGNvbnN0IGF0dHJpYnV0ZSBvZiBpbnZhbGlkU2VsZWN0aW9uLmF0dHJpYnV0ZXNUb1Jlc2V0KVxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIGlmIChhdHRyaWJ1dGUuYXR0cmlidXRlSWQgIT09IGF0dHJpYnV0ZUlkKVxuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgbmFtZXMucHVzaChcIjxiPlwiICsgYXR0cmlidXRlLm5hbWUgK1wiPC9iPlwiKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoaW52YWxpZFNlbGVjdGlvbi5uZXdVbml0KVxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIG5hbWVzLnB1c2goXG4gICAgICAgICAgICAgICAgICAgIFwiPGI+XCIgKyB0aGlzLiR0cmFuc2xhdGUoXCJDZXJlczo6VGVtcGxhdGUuc2luZ2xlSXRlbUNvbnRlbnRcIikgKyBcIjwvYj5cIlxuICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmICghbmFtZXMubGVuZ3RoKVxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICByZXR1cm4gdGhpcy4kdHJhbnNsYXRlKFwiQ2VyZXM6OlRlbXBsYXRlLnNpbmdsZUl0ZW1Ob3RBdmFpbGFibGVJblNlbGVjdGlvblwiLCB7IG5hbWU6IG5hbWVzLmpvaW4oXCIsIFwiKSB9KTtcbiAgICAgICAgfSxcblxuICAgICAgICAvKipcbiAgICAgICAgICogcmV0dXJucyBhIGxpc3Qgb2YgdmFyaWF0aW9ucywgZmlsdGVyZWQgYnkgYXR0cmlidXRlIG9yIHVuaXRcbiAgICAgICAgICogQHBhcmFtIHtbbnVtYmVyLCBudWxsXX0gYXR0cmlidXRlSWRcbiAgICAgICAgICogQHBhcmFtIHtbbnVtYmVyLCBudWxsXX0gYXR0cmlidXRlVmFsdWVJZFxuICAgICAgICAgKiBAcGFyYW0ge1tudW1iZXIsIG51bGxdfSB1bml0SWRcbiAgICAgICAgICovXG4gICAgICAgIGdldFF1YWxpZmllZFZhcmlhdGlvbnMoYXR0cmlidXRlSWQsIGF0dHJpYnV0ZVZhbHVlSWQsIHVuaXRJZClcbiAgICAgICAge1xuICAgICAgICAgICAgaWYgKGlzRGVmaW5lZChhdHRyaWJ1dGVWYWx1ZUlkKSlcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy52YXJpYXRpb25zLmZpbHRlcih2YXJpYXRpb24gPT5cbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBpc0RlZmluZWQodmFyaWF0aW9uLmF0dHJpYnV0ZXMuZmluZChhdHRyaWJ1dGUgPT5cbiAgICAgICAgICAgICAgICAgICAgICAgIGF0dHJpYnV0ZS5hdHRyaWJ1dGVJZCA9PT0gYXR0cmlidXRlSWQgJiYgYXR0cmlidXRlLmF0dHJpYnV0ZVZhbHVlSWQgPT09IGF0dHJpYnV0ZVZhbHVlSWQpKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKGlzRGVmaW5lZCh1bml0SWQpKVxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLnZhcmlhdGlvbnMuZmlsdGVyKHZhcmlhdGlvbiA9PiB2YXJpYXRpb24udW5pdENvbWJpbmF0aW9uSWQgPT09IHVuaXRJZCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHJldHVybiB0aGlzLnZhcmlhdGlvbnMuZmlsdGVyKHZhcmlhdGlvbiA9PiAhdmFyaWF0aW9uLmF0dHJpYnV0ZXMubGVuZ3RoKTtcbiAgICAgICAgfSxcblxuICAgICAgICAvKipcbiAgICAgICAgICogcmV0dXJuIGEgc2FsYWJsZSBhbmQgYSBub24tc2FsYWJsZSB2YXJpYXRpb24gd2l0aCB0aGUgbWluaW11bSBudW1iZXIgb2YgY2hhbmdlcyBvbiBhdHRyaWJ1dGVzIGNvbXBhcmVkIHRvIHRoZSBjdXJyZW50IHNlbGVjdGlvbi5cbiAgICAgICAgICogQHBhcmFtIHthcnJheX0gcXVhbGlmaWVkVmFyaWF0aW9uc1xuICAgICAgICAgKi9cbiAgICAgICAgZ2V0Q2xvc2VzdFZhcmlhdGlvbnMocXVhbGlmaWVkVmFyaWF0aW9ucylcbiAgICAgICAge1xuICAgICAgICAgICAgbGV0IGNsb3Nlc3RTYWxhYmxlVmFyaWF0aW9uLCBudW1iZXJPZlNhbGFibGVDaGFuZ2VzO1xuICAgICAgICAgICAgbGV0IGNsb3Nlc3ROb25TYWxhYmxlVmFyaWF0aW9uLCBudW1iZXJPZk5vblNhbGFibGVDaGFuZ2VzO1xuXG4gICAgICAgICAgICBmb3IgKGNvbnN0IHZhcmlhdGlvbiBvZiBxdWFsaWZpZWRWYXJpYXRpb25zKVxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIGxldCBjaGFuZ2VzID0gMDtcblxuICAgICAgICAgICAgICAgIGlmICh2YXJpYXRpb24udW5pdENvbWJpbmF0aW9uSWQgIT09IHRoaXMuc2VsZWN0ZWRVbml0ICYmICFpc051bGwodGhpcy5zZWxlY3RlZFVuaXQpKVxuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gd2hlbiB0aGUgdW5pdCBkcm9wZG93biBpc24ndCB2aXNpYmxlLCBpdCBzaG91bGQgaGF2ZSBhIGxvd2VyIHdlaWdodCBmb3IgcmVzZXQgaW52ZXN0aWdhdGlvbnNcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgdW5pdFdlaWdodCA9IHRoaXMucG9zc2libGVVbml0Q29tYmluYXRpb25JZHMubGVuZ3RoID4gMSAmJiB0aGlzLmlzQ29udGVudFZpc2libGUgPyAwLjkgOiAwLjE7XG5cbiAgICAgICAgICAgICAgICAgICAgY2hhbmdlcyArPSB1bml0V2VpZ2h0O1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGZvciAoY29uc3QgYXR0cmlidXRlIG9mIHZhcmlhdGlvbi5hdHRyaWJ1dGVzKVxuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuc2VsZWN0ZWRBdHRyaWJ1dGVzW2F0dHJpYnV0ZS5hdHRyaWJ1dGVJZF0gIT09IGF0dHJpYnV0ZS5hdHRyaWJ1dGVWYWx1ZUlkKVxuICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjaGFuZ2VzKys7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBpZih2YXJpYXRpb24uaXNTYWxhYmxlICYmICghbnVtYmVyT2ZTYWxhYmxlQ2hhbmdlcyB8fCBjaGFuZ2VzIDwgbnVtYmVyT2ZTYWxhYmxlQ2hhbmdlcykpXG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICBjbG9zZXN0U2FsYWJsZVZhcmlhdGlvbiA9IHZhcmlhdGlvbjtcbiAgICAgICAgICAgICAgICAgICAgbnVtYmVyT2ZTYWxhYmxlQ2hhbmdlcyA9IGNoYW5nZXM7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2UgaWYgKCF2YXJpYXRpb24uaXNTYWxhYmxlICYmICghbnVtYmVyT2ZOb25TYWxhYmxlQ2hhbmdlcyB8fCBjaGFuZ2VzIDwgbnVtYmVyT2ZOb25TYWxhYmxlQ2hhbmdlcykpXG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICBjbG9zZXN0Tm9uU2FsYWJsZVZhcmlhdGlvbiA9IHZhcmlhdGlvbjtcbiAgICAgICAgICAgICAgICAgICAgbnVtYmVyT2ZOb25TYWxhYmxlQ2hhbmdlcyA9IGNoYW5nZXM7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICByZXR1cm4gW2Nsb3Nlc3RTYWxhYmxlVmFyaWF0aW9uLCBjbG9zZXN0Tm9uU2FsYWJsZVZhcmlhdGlvbl07XG4gICAgICAgIH0sXG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIHJldHVybnMgb2JqZWN0IHdpdGggYXJyYXkgJ2F0dHJpYnV0ZXNUb1Jlc2V0JyBhbmQgbmV3VW5pdC4gVGhlIGF0dHJpYnV0ZXNUb1Jlc2V0IGNvbnRhaW5zIGFsbCBhdHRyaWJ1dGVzLCB3aGljaCBhcmUgbm90IG1hdGNoaW5nIHdpdGggdGhlIGdpdmVuIHZhcmlhdGlvblxuICAgICAgICAgKiBAcGFyYW0ge29iamVjdH0gdmFyaWF0aW9uXG4gICAgICAgICAqL1xuICAgICAgICBnZXRJbnZhbGlkU2VsZWN0aW9uQnlWYXJpYXRpb24odmFyaWF0aW9uKVxuICAgICAgICB7XG4gICAgICAgICAgICBjb25zdCBhdHRyaWJ1dGVzVG9SZXNldCA9IFtdO1xuICAgICAgICAgICAgbGV0IG5ld1VuaXQgPSBudWxsO1xuXG4gICAgICAgICAgICBmb3IgKGxldCBzZWxlY3RlZEF0dHJpYnV0ZUlkIGluIHRoaXMuc2VsZWN0ZWRBdHRyaWJ1dGVzKVxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIHNlbGVjdGVkQXR0cmlidXRlSWQgPSBwYXJzZUludChzZWxlY3RlZEF0dHJpYnV0ZUlkKTtcbiAgICAgICAgICAgICAgICBjb25zdCB2YXJpYXRpb25BdHRyaWJ1dGUgPSB2YXJpYXRpb24uYXR0cmlidXRlcy5maW5kKGF0dHJpYnV0ZSA9PiBhdHRyaWJ1dGUuYXR0cmlidXRlSWQgPT09IHNlbGVjdGVkQXR0cmlidXRlSWQpO1xuXG4gICAgICAgICAgICAgICAgaWYgKCFpc051bGwodGhpcy5zZWxlY3RlZEF0dHJpYnV0ZXNbc2VsZWN0ZWRBdHRyaWJ1dGVJZF0pKVxuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHZhcmlhdGlvbkF0dHJpYnV0ZSAmJiB2YXJpYXRpb25BdHRyaWJ1dGUuYXR0cmlidXRlVmFsdWVJZCAhPT0gdGhpcy5zZWxlY3RlZEF0dHJpYnV0ZXNbc2VsZWN0ZWRBdHRyaWJ1dGVJZF0gfHwgIXZhcmlhdGlvbkF0dHJpYnV0ZSlcbiAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgYXR0cmlidXRlVG9SZXNldCA9IHRoaXMuYXR0cmlidXRlcy5maW5kKGF0dHIgPT4gYXR0ci5hdHRyaWJ1dGVJZCA9PT0gc2VsZWN0ZWRBdHRyaWJ1dGVJZCk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGF0dHJpYnV0ZXNUb1Jlc2V0LnB1c2goYXR0cmlidXRlVG9SZXNldCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmICh2YXJpYXRpb24udW5pdENvbWJpbmF0aW9uSWQgIT09IHRoaXMuc2VsZWN0ZWRVbml0KVxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIG5ld1VuaXQgPSB2YXJpYXRpb24udW5pdENvbWJpbmF0aW9uSWQ7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHJldHVybiB7IGF0dHJpYnV0ZXNUb1Jlc2V0LCBuZXdVbml0IH07XG4gICAgICAgIH0sXG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIHJlc2V0cyBhbGwgaW52YWxpZCBhdHRyaWJ1dGVzIGFuZCBjaGFuZ2UgdGhlIHVuaXQsIGlmIHJlcXVpcmVkLiBQcmludHMgYSBtZXNzYWdlIHRvIHRoZSB1c2VyIGlmIHNvLlxuICAgICAgICAgKiBAcGFyYW0ge29iamVjdH0gaW52YWxpZFNlbGVjdGlvblxuICAgICAgICAgKi9cbiAgICAgICAgY29ycmVjdFNlbGVjdGlvbihpbnZhbGlkU2VsZWN0aW9uKVxuICAgICAgICB7XG4gICAgICAgICAgICBjb25zdCBtZXNzYWdlcyAgID0gW107XG4gICAgICAgICAgICBjb25zdCBhdHRyaWJ1dGVzID0gSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeSh0aGlzLnNlbGVjdGVkQXR0cmlidXRlcykpO1xuXG4gICAgICAgICAgICBmb3IgKGNvbnN0IGF0dHJpYnV0ZVRvUmVzZXQgb2YgaW52YWxpZFNlbGVjdGlvbi5hdHRyaWJ1dGVzVG9SZXNldClcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBtZXNzYWdlcy5wdXNoKFxuICAgICAgICAgICAgICAgICAgICB0aGlzLiR0cmFuc2xhdGUoXCJDZXJlczo6VGVtcGxhdGUuc2luZ2xlSXRlbU5vdEF2YWlsYWJsZVwiLCB7IG5hbWU6IGF0dHJpYnV0ZVRvUmVzZXQubmFtZSB9KVxuICAgICAgICAgICAgICAgICk7XG5cbiAgICAgICAgICAgICAgICBhdHRyaWJ1dGVzW2F0dHJpYnV0ZVRvUmVzZXQuYXR0cmlidXRlSWRdID0gKCF0aGlzLmhhc0VtcHR5T3B0aW9uICYmIEFwcC5jb25maWcuaXRlbS5zaG93UGxlYXNlU2VsZWN0KSA/IC0xIDogbnVsbDtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKGludmFsaWRTZWxlY3Rpb24ubmV3VW5pdClcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5sYXN0Q29udGVudENvdW50ID4gMSAmJiB0aGlzLnBvc3NpYmxlVW5pdENvbWJpbmF0aW9uSWRzLmxlbmd0aCA+IDEgJiYgIWlzTnVsbCh0aGlzLnNlbGVjdGVkVW5pdCkpXG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICBtZXNzYWdlcy5wdXNoKFxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy4kdHJhbnNsYXRlKFwiQ2VyZXM6OlRlbXBsYXRlLnNpbmdsZUl0ZW1Ob3RBdmFpbGFibGVcIiwgeyBuYW1lOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLiR0cmFuc2xhdGUoXCJDZXJlczo6VGVtcGxhdGUuc2luZ2xlSXRlbUNvbnRlbnRcIilcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgdGhpcy4kc3RvcmUuY29tbWl0KGAke3RoaXMuaXRlbUlkfS92YXJpYXRpb25TZWxlY3Qvc2VsZWN0SXRlbVVuaXRgLCBpbnZhbGlkU2VsZWN0aW9uLm5ld1VuaXQpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB0aGlzLiRzdG9yZS5jb21taXQoYCR7dGhpcy5pdGVtSWR9L3ZhcmlhdGlvblNlbGVjdC9zZXRJdGVtU2VsZWN0ZWRBdHRyaWJ1dGVzYCwgYXR0cmlidXRlcyk7XG5cbiAgICAgICAgICAgIHRoaXMuc2V0VmFyaWF0aW9uKHRoaXMuY3VycmVudFNlbGVjdGlvbiA/IHRoaXMuY3VycmVudFNlbGVjdGlvbi52YXJpYXRpb25JZCA6IDApO1xuXG4gICAgICAgICAgICBOb3RpZmljYXRpb25TZXJ2aWNlLndhcm4oXG4gICAgICAgICAgICAgICAgbWVzc2FnZXMuam9pbihcIjxicj5cIilcbiAgICAgICAgICAgICkuY2xvc2VBZnRlcig1MDAwKTtcbiAgICAgICAgfSxcblxuICAgICAgICAvKipcbiAgICAgICAgICogcmV0dXJucyBtYXRjaGluZyB2YXJpYXRpb25zIHdpdGggY3VycmVudCBzZWxlY3Rpb25cbiAgICAgICAgICogYXR0cmlidXRlcyBhbmQgdW5pdElkIGNvdWxkIGJlIGZpbGxlZCwgdG8gY2hlY2sgYSBzcGVjaWZpYyBzZWxlY3Rpb25cbiAgICAgICAgICogQHBhcmFtIHtvYmplY3R9IGF0dHJpYnV0ZXNcbiAgICAgICAgICogQHBhcmFtIHtudW1iZXJ9IHVuaXRJZFxuICAgICAgICAgKiBAcGFyYW0ge2Jvb2xlYW59IHN0cmljdFxuICAgICAgICAgKi9cbiAgICAgICAgZmlsdGVyVmFyaWF0aW9ucyhhdHRyaWJ1dGVzLCB1bml0SWQsIHN0cmljdCwgaWdub3JlVW5pdClcbiAgICAgICAge1xuICAgICAgICAgICAgYXR0cmlidXRlcyA9IGF0dHJpYnV0ZXMgfHwgdGhpcy5zZWxlY3RlZEF0dHJpYnV0ZXM7XG4gICAgICAgICAgICB1bml0SWQgPSB1bml0SWQgfHwgdGhpcy5zZWxlY3RlZFVuaXQ7XG4gICAgICAgICAgICBzdHJpY3QgPSAhIXN0cmljdDtcbiAgICAgICAgICAgIGlnbm9yZVVuaXQgPSAhIWlnbm9yZVVuaXQ7XG5cbiAgICAgICAgICAgIGNvbnN0IGtleSA9IEpTT04uc3RyaW5naWZ5KGF0dHJpYnV0ZXMpICsgXCJfXCIgKyB1bml0SWQgKyBcIl9cIiArIHN0cmljdCArIFwiX1wiICsgaWdub3JlVW5pdDtcblxuICAgICAgICAgICAgaWYgKGlzRGVmaW5lZCh0aGlzLmZpbHRlcmVkVmFyaWF0aW9uc0NhY2hlW2tleV0pKVxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmZpbHRlcmVkVmFyaWF0aW9uc0NhY2hlW2tleV07XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGNvbnN0IHVuaXF1ZVZhbHVlcyA9IFsuLi5uZXcgU2V0KE9iamVjdC52YWx1ZXMoYXR0cmlidXRlcykpXTtcbiAgICAgICAgICAgIGNvbnN0IGlzRW1wdHlPcHRpb25TZWxlY3RlZCA9IHVuaXF1ZVZhbHVlcy5sZW5ndGggPT09IDEgJiYgaXNOdWxsKHVuaXF1ZVZhbHVlc1swXSk7XG4gICAgICAgICAgICBjb25zdCBmaWx0ZXJlZFZhcmlhdGlvbnMgPSB0aGlzLnZhcmlhdGlvbnMuZmlsdGVyKHZhcmlhdGlvbiA9PlxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIC8vIHRoZSBzZWxlY3RlZCB1bml0IGlzIG5vdCBtYXRjaGluZ1xuICAgICAgICAgICAgICAgIGlmICghaWdub3JlVW5pdCAmJiB2YXJpYXRpb24udW5pdENvbWJpbmF0aW9uSWQgIT09IHVuaXRJZClcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAvLyB0aGUgdmFyaWF0aW9uIGhhcyBubyBhdHRyaWJ1dGVzIChvbmx5IGNoZWNrZWQsIGlmIGFueSBhdHRyaWJ1dGUgaGFzIGEgc2VsZWN0ZWQgdmFsdWUpOyBvciB0aGUgdmFyaWF0aW9uIGhhcyBhdHRyaWJ1dGVzIGFuZCBlbXB0eSBvcHRpb24gaXMgc2VsZWN0ZWRcbiAgICAgICAgICAgICAgICAvLyByZXF1aXJlcyBtb3JlIHRoYW4gMCBhdHRyaWJ1dGVzXG4gICAgICAgICAgICAgICAgaWYgKCgoIWlzRW1wdHlPcHRpb25TZWxlY3RlZCAmJiAhdmFyaWF0aW9uLmF0dHJpYnV0ZXMubGVuZ3RoKSB8fCAoaXNFbXB0eU9wdGlvblNlbGVjdGVkICYmIHZhcmlhdGlvbi5hdHRyaWJ1dGVzLmxlbmd0aCkpXG4gICAgICAgICAgICAgICAgICAgICYmIHRoaXMuYXR0cmlidXRlcy5sZW5ndGggPiAwKVxuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGZvciAoY29uc3QgYXR0cmlidXRlSWQgaW4gYXR0cmlidXRlcylcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHZhcmlhdGlvbkF0dHJpYnV0ZSA9IHZhcmlhdGlvbi5hdHRyaWJ1dGVzLmZpbmQodmFyaWF0aW9uQXR0cmlidXRlID0+XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXJpYXRpb25BdHRyaWJ1dGUuYXR0cmlidXRlSWQgPT09IHBhcnNlSW50KGF0dHJpYnV0ZUlkKSk7XG5cbiAgICAgICAgICAgICAgICAgICAgLy8gYW4gYXR0cmlidXRlIGlzIG5vdCBtYXRjaGluZyB3aXRoIHNlbGVjdGlvblxuICAgICAgICAgICAgICAgICAgICBpZiAodmFyaWF0aW9uQXR0cmlidXRlICYmXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXJpYXRpb25BdHRyaWJ1dGUuYXR0cmlidXRlVmFsdWVJZCAhPT0gYXR0cmlidXRlc1thdHRyaWJ1dGVJZF0gJiZcbiAgICAgICAgICAgICAgICAgICAgICAgIChzdHJpY3QgfHwgIXN0cmljdCAmJiAhaXNOdWxsKGF0dHJpYnV0ZXNbYXR0cmlidXRlSWRdKSAmJiBhdHRyaWJ1dGVzW2F0dHJpYnV0ZUlkXSAhPT0gLTEpKVxuICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICB0aGlzLmZpbHRlcmVkVmFyaWF0aW9uc0NhY2hlW2tleV0gPSBmaWx0ZXJlZFZhcmlhdGlvbnM7XG5cbiAgICAgICAgICAgIHJldHVybiBmaWx0ZXJlZFZhcmlhdGlvbnM7XG4gICAgICAgIH0sXG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIHJldHVybnMgdHJ1ZSwgaWYgdGhlIHNlbGVjdGlvbiB3aXRoIGEgbmV3IGF0dHJpYnV0ZSB2YWx1ZSB3b3VsZCBiZSB2YWxpZFxuICAgICAgICAgKiBAcGFyYW0ge251bWJlcn0gYXR0cmlidXRlSWRcbiAgICAgICAgICogQHBhcmFtIHtbbnVtYmVyLCBzdHJpbmcsIG51bGxdfSBhdHRyaWJ1dGVWYWx1ZUlkXG4gICAgICAgICAqIEBwYXJhbSB7Ym9vbGVhbn0gZmlsdGVyU2FsYWJsZVZhcmlhdGlvbnNcbiAgICAgICAgICovXG4gICAgICAgIGlzQXR0cmlidXRlU2VsZWN0aW9uVmFsaWQoYXR0cmlidXRlSWQsIGF0dHJpYnV0ZVZhbHVlSWQsIGZpbHRlclNhbGFibGVWYXJpYXRpb25zKVxuICAgICAgICB7XG4gICAgICAgICAgICBhdHRyaWJ1dGVWYWx1ZUlkID0gcGFyc2VJbnQoYXR0cmlidXRlVmFsdWVJZCkgfHwgbnVsbDtcbiAgICAgICAgICAgIGlmICh0aGlzLnNlbGVjdGVkQXR0cmlidXRlc1thdHRyaWJ1dGVJZF0gPT09IGF0dHJpYnV0ZVZhbHVlSWQpXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGNvbnN0IHNlbGVjdGVkQXR0cmlidXRlcyA9IEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkodGhpcy5zZWxlY3RlZEF0dHJpYnV0ZXMpKTtcblxuICAgICAgICAgICAgc2VsZWN0ZWRBdHRyaWJ1dGVzW2F0dHJpYnV0ZUlkXSA9IHBhcnNlSW50KGF0dHJpYnV0ZVZhbHVlSWQpIHx8IG51bGw7XG5cbiAgICAgICAgICAgIGNvbnN0IGlnbm9yZVVuaXQgPSAhKE9iamVjdC5rZXlzKHRoaXMucG9zc2libGVVbml0cykubGVuZ3RoID4gMSAmJiB0aGlzLmlzQ29udGVudFZpc2libGUpO1xuICAgICAgICAgICAgbGV0IHZhcmlhdGlvbnMgPSB0aGlzLmZpbHRlclZhcmlhdGlvbnMoc2VsZWN0ZWRBdHRyaWJ1dGVzLCBudWxsLCBudWxsLCBpZ25vcmVVbml0KTtcblxuICAgICAgICAgICAgaWYgKGZpbHRlclNhbGFibGVWYXJpYXRpb25zKVxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIHZhcmlhdGlvbnMgPSB2YXJpYXRpb25zLmZpbHRlcih2YXJpYXRpb24gPT4gdmFyaWF0aW9uLmlzU2FsYWJsZSlcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgcmV0dXJuIHZhcmlhdGlvbnMubGVuZ3RoID4gMDtcbiAgICAgICAgfSxcblxuICAgICAgICAvKipcbiAgICAgICAgICogcmV0dXJucyB0cnVlLCBpZiB0aGUgc2VsZWN0aW9uIHdpdGggYSBuZXcgdW5pdElkIHdvdWxkIGJlIHZhbGlkXG4gICAgICAgICAqIEBwYXJhbSB7W251bWJlciwgc3RyaW5nXX0gdW5pdElkXG4gICAgICAgICAqL1xuICAgICAgICBpc1VuaXRTZWxlY3Rpb25WYWxpZCh1bml0SWQpXG4gICAgICAgIHtcbiAgICAgICAgICAgIHVuaXRJZCA9IHBhcnNlSW50KHVuaXRJZCk7XG4gICAgICAgICAgICBpZiAodGhpcy5zZWxlY3RlZFVuaXQgPT09IHVuaXRJZClcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgcmV0dXJuIHRoaXNcbiAgICAgICAgICAgICAgICAuZmlsdGVyVmFyaWF0aW9ucyhudWxsLCB1bml0SWQpXG4gICAgICAgICAgICAgICAgLmZpbHRlcih2YXJpYXRpb24gPT4gdmFyaWF0aW9uLmlzU2FsYWJsZSlcbiAgICAgICAgICAgICAgICAubGVuZ3RoID4gMFxuICAgICAgICB9LFxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBkaXNwYXRjaCB2dWV4IGFjdGlvbiAnbG9hZFZhcmlhdGlvbicgdG8gYXJjaGl2ZSBhIHZhcmlhdGlvblxuICAgICAgICAgKiBkaXNwYXRjaGVzIGEgY3VzdG9tIGV2ZW50IG5hbWVkICdvblZhcmlhdGlvbkNoYW5nZWQnXG4gICAgICAgICAqIEBwYXJhbSB7W3N0cmluZywgbnVtYmVyLCBudWxsXX0gdmFyaWF0aW9uSWRcbiAgICAgICAgICovXG4gICAgICAgIHNldFZhcmlhdGlvbih2YXJpYXRpb25JZClcbiAgICAgICAge1xuICAgICAgICAgICAgaWYgKCFpc0RlZmluZWQodmFyaWF0aW9uSWQpICYmIHRoaXMuY3VycmVudFNlbGVjdGlvbilcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICB2YXJpYXRpb25JZCA9IHRoaXMuY3VycmVudFNlbGVjdGlvbi52YXJpYXRpb25JZDtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKGlzRGVmaW5lZCh2YXJpYXRpb25JZCkpXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgdGhpcy4kc3RvcmUuZGlzcGF0Y2goYCR7dGhpcy5pdGVtSWR9L2xvYWRWYXJpYXRpb25gLCB2YXJpYXRpb25JZCkudGhlbih2YXJpYXRpb24gPT5cbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LmRpc3BhdGNoRXZlbnQobmV3IEN1c3RvbUV2ZW50KFwib25WYXJpYXRpb25DaGFuZ2VkXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGV0YWlsOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhdHRyaWJ1dGVzOiB2YXJpYXRpb24uYXR0cmlidXRlcyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRvY3VtZW50czogdmFyaWF0aW9uLmRvY3VtZW50cyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGl0ZW1JZDogdGhpcy5pdGVtSWRcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfSkpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuXG4gICAgICAgIGlzVGV4dEN1dChjb250ZW50KVxuICAgICAgICB7XG4gICAgICAgICAgICBpZiAodGhpcy4kcmVmcy5hdHRyaWJ1dGVzQ29udGFuZXIpXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRleHRXaWR0aChjb250ZW50LCBcIkN1c3RvbS1Gb250LCBIZWx2ZXRpY2EsIEFyaWFsLCBzYW5zLXNlcmlmXCIpID4gdGhpcy4kcmVmcy5hdHRyaWJ1dGVzQ29udGFuZXJbMF0uY2xpZW50V2lkdGg7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfSxcblxuICAgICAgICBnZXRTZWxlY3RlZEF0dHJpYnV0ZVZhbHVlTmFtZShhdHRyaWJ1dGUpXG4gICAgICAgIHtcbiAgICAgICAgICAgIGNvbnN0IHNlbGVjdGVkQXR0cmlidXRlVmFsdWVJZCA9ICB0aGlzLnNlbGVjdGVkQXR0cmlidXRlc1thdHRyaWJ1dGUuYXR0cmlidXRlSWRdO1xuICAgICAgICAgICAgY29uc3Qgc2VsZWN0ZWRBdHRyaWJ1dGVWYWx1ZSA9IGF0dHJpYnV0ZS52YWx1ZXMuZmluZChhdHRyVmFsdWUgPT4gYXR0clZhbHVlLmF0dHJpYnV0ZVZhbHVlSWQgPT09IHNlbGVjdGVkQXR0cmlidXRlVmFsdWVJZCk7XG5cbiAgICAgICAgICAgIGlmIChzZWxlY3RlZEF0dHJpYnV0ZVZhbHVlKVxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIHJldHVybiBzZWxlY3RlZEF0dHJpYnV0ZVZhbHVlLm5hbWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmIChBcHAuY29uZmlnLml0ZW0uc2hvd1BsZWFzZVNlbGVjdCAmJiBzZWxlY3RlZEF0dHJpYnV0ZVZhbHVlSWQgPT09IC0xKVxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLiR0cmFuc2xhdGUoXCJDZXJlczo6VGVtcGxhdGUuc2luZ2xlSXRlbVBsZWFzZVNlbGVjdFwiKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiB0aGlzLiR0cmFuc2xhdGUoXCJDZXJlczo6VGVtcGxhdGUuc2luZ2xlSXRlbU5vU2VsZWN0aW9uXCIpO1xuICAgICAgICB9LFxuXG4gICAgICAgIHRyYW5zZm9ybVBvc3NpYmxlVW5pdHMocG9zc2libGVVbml0cylcbiAgICAgICAge1xuICAgICAgICAgICAgcmV0dXJuIE9iamVjdC5lbnRyaWVzKHBvc3NpYmxlVW5pdHMpLnNvcnQoKHVuaXRBLCB1bml0QikgPT4ge1xuICAgICAgICAgICAgICAgIHVuaXRBID0gdGhpcy5zcGxpdFVuaXROYW1lKHVuaXRBWzFdKTtcbiAgICAgICAgICAgICAgICB1bml0QiA9IHRoaXMuc3BsaXRVbml0TmFtZSh1bml0QlsxXSk7XG4gICAgICAgICAgICAgICAgLy8gb3JkZXIgYnkgdW5pdFxuICAgICAgICAgICAgICAgIGlmICh1bml0QVsxXSA8IHVuaXRCWzFdKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiAtMTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKHVuaXRBWzFdID4gdW5pdEJbMV0pIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIDE7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIC8vIG9yZGVyIGJ5IGNvbnRlbnQgKGNvdW50KVxuICAgICAgICAgICAgICAgIGlmICh1bml0QVswXSA8IHVuaXRCWzBdKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiAtMTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKHVuaXRBWzBdID4gdW5pdEJbMF0pIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIDE7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHJldHVybiAwO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0sXG4gICAgICAgIHNwbGl0VW5pdE5hbWUodW5pdE5hbWUpIHtcbiAgICAgICAgICAgIGNvbnN0IHVuaXROYW1lU3BsaXQgPSB1bml0TmFtZS5zcGxpdChcIiBcIik7XG5cbiAgICAgICAgICAgIGlmICghaXNOYU4odW5pdE5hbWVTcGxpdFswXSkpIHtcbiAgICAgICAgICAgICAgICB1bml0TmFtZVNwbGl0WzBdID0gdW5pdE5hbWVTcGxpdFswXS5yZXBsYWNlKEFwcC5jdXJyZW5jeVBhdHRlcm4uc2VwYXJhdG9yX3Rob3VzYW5kcywgXCJcIik7XG4gICAgICAgICAgICAgICAgdW5pdE5hbWVTcGxpdFswXSA9IHBhcnNlSW50KHVuaXROYW1lU3BsaXRbMF0pO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICByZXR1cm4gdW5pdE5hbWVTcGxpdDtcbiAgICAgICAgfVxuICAgIH0sXG5cbiAgICB3YXRjaDpcbiAgICB7XG4gICAgICAgIGN1cnJlbnRTZWxlY3Rpb24odmFsdWUpXG4gICAgICAgIHtcbiAgICAgICAgICAgIHRoaXMuJHN0b3JlLmNvbW1pdChgJHt0aGlzLml0ZW1JZH0vdmFyaWF0aW9uU2VsZWN0L3NldElzVmFyaWF0aW9uU2VsZWN0ZWRgLCAhIXZhbHVlKTtcbiAgICAgICAgfSxcbiAgICAgICAgdmFyaWF0aW9ucygpXG4gICAgICAgIHtcbiAgICAgICAgICAgIC8vIEZJWCB1bnNldCB2YXJpYXRpb24gY2FjaGUgYWZ0ZXIgc3Vic2VxdWVudCB2YXJpYXRpb25zIGFyZSBsb2FkZWRcbiAgICAgICAgICAgIHRoaXMuZmlsdGVyZWRWYXJpYXRpb25zQ2FjaGUgPSB7fTtcbiAgICAgICAgfVxuICAgIH1cbn1cbjwvc2NyaXB0PlxuIiwiaW1wb3J0IG1vZCBmcm9tIFwiLSEuLi8uLi8uLi8uLi8uLi8uLi9ub2RlX21vZHVsZXMvdnVlLWxvYWRlci9saWIvaW5kZXguanM/P3Z1ZS1sb2FkZXItb3B0aW9ucyEuL1ZhcmlhdGlvblNlbGVjdC52dWU/dnVlJnR5cGU9c2NyaXB0Jmxhbmc9anMmXCI7IGV4cG9ydCBkZWZhdWx0IG1vZDsgZXhwb3J0ICogZnJvbSBcIi0hLi4vLi4vLi4vLi4vLi4vLi4vbm9kZV9tb2R1bGVzL3Z1ZS1sb2FkZXIvbGliL2luZGV4LmpzPz92dWUtbG9hZGVyLW9wdGlvbnMhLi9WYXJpYXRpb25TZWxlY3QudnVlP3Z1ZSZ0eXBlPXNjcmlwdCZsYW5nPWpzJlwiIiwiaW1wb3J0IHsgcmVuZGVyLCBzdGF0aWNSZW5kZXJGbnMgfSBmcm9tIFwiLi9WYXJpYXRpb25TZWxlY3QudnVlP3Z1ZSZ0eXBlPXRlbXBsYXRlJmlkPTU4OGMxODg3JlwiXG5pbXBvcnQgc2NyaXB0IGZyb20gXCIuL1ZhcmlhdGlvblNlbGVjdC52dWU/dnVlJnR5cGU9c2NyaXB0Jmxhbmc9anMmXCJcbmV4cG9ydCAqIGZyb20gXCIuL1ZhcmlhdGlvblNlbGVjdC52dWU/dnVlJnR5cGU9c2NyaXB0Jmxhbmc9anMmXCJcblxuXG4vKiBub3JtYWxpemUgY29tcG9uZW50ICovXG5pbXBvcnQgbm9ybWFsaXplciBmcm9tIFwiIS4uLy4uLy4uLy4uLy4uLy4uL25vZGVfbW9kdWxlcy92dWUtbG9hZGVyL2xpYi9ydW50aW1lL2NvbXBvbmVudE5vcm1hbGl6ZXIuanNcIlxudmFyIGNvbXBvbmVudCA9IG5vcm1hbGl6ZXIoXG4gIHNjcmlwdCxcbiAgcmVuZGVyLFxuICBzdGF0aWNSZW5kZXJGbnMsXG4gIGZhbHNlLFxuICBudWxsLFxuICBudWxsLFxuICBudWxsXG4gIFxuKVxuXG5leHBvcnQgZGVmYXVsdCBjb21wb25lbnQuZXhwb3J0cyJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///7621\n')}}]);