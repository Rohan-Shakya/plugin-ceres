"use strict";(self.webpackChunkCeres=self.webpackChunkCeres||[]).push([[35],{5997:function(__unused_webpack_module,__webpack_exports__,__webpack_require__){eval('// ESM COMPAT FLAG\n__webpack_require__.r(__webpack_exports__);\n\n// EXPORTS\n__webpack_require__.d(__webpack_exports__, {\n  "default": function() { return /* binding */ VariationSelect; }\n});\n\n;// CONCATENATED MODULE: ./node_modules/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/vue-loader/lib/index.js??vue-loader-options!./resources/js/src/app/components/item/VariationSelect.vue?vue&type=template&id=4a939d05&\nvar render = function () {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n  return _c(\n    "div",\n    { staticClass: "row" },\n    [\n      _vm.attributes.length ||\n      (_vm.possibleUnitCombinationIds.length > 1 && _vm.isContentVisible)\n        ? [\n            _vm._l(_vm.attributes, function (attribute, index) {\n              return _c(\n                "div",\n                { key: index, staticClass: "col-12 variation-select" },\n                [\n                  attribute.type === "dropdown"\n                    ? _c(\n                        "div",\n                        {\n                          ref: "attributesContaner",\n                          refInFor: true,\n                          staticClass: "input-unit",\n                        },\n                        [\n                          _c(\n                            "select",\n                            {\n                              staticClass: "custom-select",\n                              attrs: {\n                                id: "custom-select_" + attribute.name,\n                                "data-testing": "variation-select-dropdown",\n                              },\n                              on: {\n                                change: function ($event) {\n                                  return _vm.selectAttribute(\n                                    attribute.attributeId,\n                                    $event.target.value\n                                  )\n                                },\n                              },\n                            },\n                            [\n                              _vm.addPleaseSelectOption || !_vm.hasSelection\n                                ? _c("option", { domProps: { value: -1 } }, [\n                                    _vm._v(\n                                      _vm._s(\n                                        _vm.$translate(\n                                          "Ceres::Template.singleItemPleaseSelect"\n                                        )\n                                      )\n                                    ),\n                                  ])\n                                : _vm._e(),\n                              _vm._v(" "),\n                              _vm.hasEmptyOption ||\n                              _vm.selectedAttributes[attribute.attributeId] ===\n                                null\n                                ? _c(\n                                    "option",\n                                    {\n                                      domProps: {\n                                        value: null,\n                                        selected:\n                                          _vm.selectedAttributes[\n                                            attribute.attributeId\n                                          ] === null,\n                                      },\n                                    },\n                                    [\n                                      _vm._v(\n                                        _vm._s(\n                                          _vm.$translate(\n                                            "Ceres::Template.singleItemNoSelection"\n                                          )\n                                        )\n                                      ),\n                                    ]\n                                  )\n                                : _vm._e(),\n                              _vm._v(" "),\n                              _vm._l(attribute.values, function (value) {\n                                return _c(\n                                  "option",\n                                  {\n                                    key: value.attributeValueId,\n                                    domProps: {\n                                      value: value.attributeValueId,\n                                      selected:\n                                        value.attributeValueId ===\n                                        _vm.selectedAttributes[\n                                          attribute.attributeId\n                                        ],\n                                    },\n                                  },\n                                  [\n                                    _vm.isAttributeSelectionValid(\n                                      attribute.attributeId,\n                                      value.attributeValueId,\n                                      true\n                                    )\n                                      ? [\n                                          _vm._v(\n                                            "\\n                            " +\n                                              _vm._s(value.name) +\n                                              "\\n                        "\n                                          ),\n                                        ]\n                                      : _vm.isAttributeSelectionValid(\n                                          attribute.attributeId,\n                                          value.attributeValueId,\n                                          false\n                                        )\n                                      ? [\n                                          _vm._v(\n                                            "\\n                            " +\n                                              _vm._s(\n                                                _vm.$translate(\n                                                  "Ceres::Template.singleItemNotSalableAttribute",\n                                                  { name: value.name }\n                                                )\n                                              ) +\n                                              "\\n                        "\n                                          ),\n                                        ]\n                                      : [\n                                          _vm._v(\n                                            "\\n                            " +\n                                              _vm._s(\n                                                _vm.$translate(\n                                                  "Ceres::Template.singleItemInvalidAttribute",\n                                                  { name: value.name }\n                                                )\n                                              ) +\n                                              "\\n                        "\n                                          ),\n                                        ],\n                                  ],\n                                  2\n                                )\n                              }),\n                            ],\n                            2\n                          ),\n                          _vm._v(" "),\n                          _c(\n                            "label",\n                            {\n                              directives: [\n                                {\n                                  name: "tooltip",\n                                  rawName: "v-tooltip",\n                                  value: _vm.isTextCut(attribute.name),\n                                  expression: "isTextCut(attribute.name)",\n                                },\n                              ],\n                              attrs: {\n                                for: "custom-select_" + attribute.name,\n                                "data-toggle": "tooltip",\n                                "data-placement": "top",\n                                title: attribute.name,\n                                "data-testing":\n                                  "variation-select-dropdown-label",\n                              },\n                            },\n                            [_vm._v(_vm._s(attribute.name))]\n                          ),\n                        ]\n                      )\n                    : attribute.type === "box" || attribute.type === "image"\n                    ? _c("div", [\n                        _c(\n                          "span",\n                          {\n                            staticClass: "text-muted",\n                            attrs: { "data-testing": "attribute-name" },\n                          },\n                          [_vm._v(_vm._s(attribute.name) + ":")]\n                        ),\n                        _vm._v(" "),\n                        _c(\n                          "b",\n                          { attrs: { "data-testing": "attribute-value" } },\n                          [\n                            _vm._v(\n                              _vm._s(\n                                _vm.getSelectedAttributeValueName(attribute)\n                              )\n                            ),\n                          ]\n                        ),\n                        _vm._v(" "),\n                        _c(\n                          "div",\n                          {\n                            staticClass: "v-s-boxes py-3",\n                            class: { images: attribute.type === "image" },\n                          },\n                          [\n                            _vm.addPleaseSelectOption\n                              ? _c(\n                                  "div",\n                                  {\n                                    staticClass:\n                                      "v-s-box bg-white empty-option",\n                                    class: {\n                                      active:\n                                        _vm.selectedAttributes[\n                                          attribute.attributeId\n                                        ] === -1,\n                                      invalid: !_vm.isAttributeSelectionValid(\n                                        attribute.attributeId,\n                                        -1\n                                      ),\n                                    },\n                                    attrs: {\n                                      "data-testing": "variation-select-box",\n                                    },\n                                    on: {\n                                      click: function ($event) {\n                                        return _vm.selectAttribute(\n                                          attribute.attributeId,\n                                          -1\n                                        )\n                                      },\n                                    },\n                                  },\n                                  [\n                                    _c("span", { staticClass: "mx-3" }, [\n                                      _vm._v(\n                                        _vm._s(\n                                          _vm.$translate(\n                                            "Ceres::Template.singleItemPleaseSelect"\n                                          )\n                                        )\n                                      ),\n                                    ]),\n                                  ]\n                                )\n                              : _vm._e(),\n                            _vm._v(" "),\n                            _vm.hasEmptyOption\n                              ? _c(\n                                  "div",\n                                  {\n                                    staticClass:\n                                      "v-s-box bg-white empty-option",\n                                    class: {\n                                      active:\n                                        _vm.selectedAttributes[\n                                          attribute.attributeId\n                                        ] === null,\n                                      invalid: !_vm.isAttributeSelectionValid(\n                                        attribute.attributeId,\n                                        null,\n                                        true\n                                      ),\n                                    },\n                                    attrs: {\n                                      "data-testing": "variation-select-box",\n                                    },\n                                    on: {\n                                      click: function ($event) {\n                                        return _vm.selectAttribute(\n                                          attribute.attributeId,\n                                          null\n                                        )\n                                      },\n                                    },\n                                  },\n                                  [\n                                    _c("span", { staticClass: "mx-3" }, [\n                                      _vm._v(\n                                        _vm._s(\n                                          _vm.$translate(\n                                            "Ceres::Template.singleItemNoSelection"\n                                          )\n                                        )\n                                      ),\n                                    ]),\n                                  ]\n                                )\n                              : _vm._e(),\n                            _vm._v(" "),\n                            _vm._l(attribute.values, function (value) {\n                              return _c(\n                                "div",\n                                {\n                                  directives: [\n                                    {\n                                      name: "tooltip",\n                                      rawName: "v-tooltip",\n                                      value: true,\n                                      expression: "true",\n                                    },\n                                  ],\n                                  key: value.attributeValueId,\n                                  staticClass: "v-s-box bg-white",\n                                  class: {\n                                    active:\n                                      value.attributeValueId ===\n                                      _vm.selectedAttributes[\n                                        attribute.attributeId\n                                      ],\n                                    invalid: !_vm.isAttributeSelectionValid(\n                                      attribute.attributeId,\n                                      value.attributeValueId,\n                                      true\n                                    ),\n                                  },\n                                  attrs: {\n                                    "data-testing": "variation-select-box",\n                                    "data-html": "true",\n                                    "data-toggle": "tooltip",\n                                    "data-placement": "top",\n                                    "data-original-title": _vm.getTooltip(\n                                      attribute,\n                                      value\n                                    ),\n                                  },\n                                  on: {\n                                    click: function ($event) {\n                                      return _vm.selectAttribute(\n                                        attribute.attributeId,\n                                        value.attributeValueId\n                                      )\n                                    },\n                                  },\n                                },\n                                [\n                                  attribute.type === "box"\n                                    ? _c("span", { staticClass: "mx-3" }, [\n                                        _vm._v(_vm._s(value.name)),\n                                      ])\n                                    : _c("img", {\n                                        staticClass: "p-1",\n                                        attrs: {\n                                          src: value.imageUrl,\n                                          alt: value.name,\n                                        },\n                                      }),\n                                ]\n                              )\n                            }),\n                          ],\n                          2\n                        ),\n                      ])\n                    : _vm._e(),\n                ]\n              )\n            }),\n            _vm._v(" "),\n            _vm.possibleUnitCombinationIds.length > 1 && _vm.isContentVisible\n              ? _c("div", { staticClass: "col-12 variation-select" }, [\n                  _c("div", { staticClass: "input-unit" }, [\n                    _c(\n                      "select",\n                      {\n                        staticClass: "custom-select",\n                        attrs: {\n                          id: "unit-combination-ids-select",\n                          "data-testing": "variation-select-unit",\n                        },\n                        on: {\n                          change: function ($event) {\n                            return _vm.selectUnit($event.target.value)\n                          },\n                        },\n                      },\n                      _vm._l(\n                        _vm.possibleUnitCombinationIds,\n                        function (unitCombinationId) {\n                          return _c(\n                            "option",\n                            {\n                              key: unitCombinationId,\n                              domProps: {\n                                value: unitCombinationId,\n                                selected:\n                                  parseInt(unitCombinationId) ===\n                                  _vm.selectedUnit,\n                              },\n                            },\n                            [\n                              _vm.isUnitSelectionValid(unitCombinationId)\n                                ? [\n                                    _vm._v(\n                                      "\\n                            " +\n                                        _vm._s(\n                                          _vm.possibleUnits[unitCombinationId]\n                                        ) +\n                                        "\\n                        "\n                                    ),\n                                  ]\n                                : [\n                                    _vm._v(\n                                      "\\n                            " +\n                                        _vm._s(\n                                          _vm.$translate(\n                                            "Ceres::Template.singleItemInvalidAttribute",\n                                            {\n                                              name: _vm.possibleUnits[\n                                                unitCombinationId\n                                              ],\n                                            }\n                                          )\n                                        ) +\n                                        "\\n                        "\n                                    ),\n                                  ],\n                            ],\n                            2\n                          )\n                        }\n                      ),\n                      0\n                    ),\n                    _vm._v(" "),\n                    _c(\n                      "label",\n                      {\n                        attrs: {\n                          for: "unit-combination-ids-select",\n                          "data-testing": "variation-select-unit-label",\n                        },\n                      },\n                      [\n                        _vm._v(\n                          _vm._s(\n                            _vm.$translate("Ceres::Template.singleItemContent")\n                          )\n                        ),\n                      ]\n                    ),\n                  ]),\n                ])\n              : _vm._e(),\n          ]\n        : [_vm._t("default")],\n    ],\n    2\n  )\n}\nvar staticRenderFns = []\nrender._withStripped = true\n\n\n;// CONCATENATED MODULE: ./resources/js/src/app/components/item/VariationSelect.vue?vue&type=template&id=4a939d05&\n\n// EXTERNAL MODULE: ./resources/js/src/app/helper/dom.js\nvar dom = __webpack_require__(7494);\n// EXTERNAL MODULE: ./resources/js/src/app/helper/utils.js\nvar utils = __webpack_require__(1023);\n;// CONCATENATED MODULE: ./node_modules/vue-loader/lib/index.js??vue-loader-options!./resources/js/src/app/components/item/VariationSelect.vue?vue&type=script&lang=js&\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\n\n\n\nconst NotificationService = __webpack_require__(1452);\n\n/* harmony default export */ var VariationSelectvue_type_script_lang_js_ = ({\n\n    name: "variation-select",\n\n    props: {\n        forceContent:\n        {\n            type: Boolean,\n            default: false\n        }\n    },\n\n    inject: {\n        itemId: {\n            default: null\n        }\n    },\n\n    data()\n    {\n        return {\n            filteredVariationsCache: {},\n            lastContentCount: 0\n        };\n    },\n\n    mounted()\n    {\n        // initially check for valid selection and disable add to basket button\n        this.$store.commit(`${this.itemId}/variationSelect/setIsVariationSelected`, !!this.currentSelection);\n    },\n\n    computed:\n    {\n        currentVariation() {\n            return this.$store.getters[`${this.itemId}/currentItemVariation`];\n        },\n\n        currentVariationSelect() {\n            return this.$store.state.items[this.itemId] && this.$store.state.items[this.itemId].variationSelect;\n        },\n\n        /**\n         * returns true if any variation has no attributes\n         */\n        hasEmptyOption()\n        {\n            return this.variations.some(variation => !variation.attributes.length);\n        },\n\n        addPleaseSelectOption()\n        {\n            return App.config.item.showPleaseSelect;\n        },\n\n        /**\n         * returns the variation, based on the selected attributes / unit\n         * returns false if there are none or multiple results\n         */\n        currentSelection()\n        {\n            const filteredVariations = this.filterVariations(null, null, true);\n\n            if (filteredVariations.length === 1)\n            {\n                return filteredVariations[0];\n            }\n\n            return false;\n        },\n\n        /**\n         * returns all units, selectable by current selection\n         * prop \'forceContent\' with value true will return all units, without filtering\n         */\n        possibleUnits()\n        {\n            // use an object, to make the entries unique\n            const possibleUnits = {};\n            const variations = this.forceContent ? this.variations : this.filterVariations(null, null, null, true);\n\n            for (const variation of variations)\n            {\n                possibleUnits[variation.unitCombinationId] = variation.unitName;\n            }\n\n            return possibleUnits;\n        },\n\n        possibleUnitCombinationIds()\n        {\n            return this.transformPossibleUnits(this.possibleUnits).map(value => value[0]);\n        },\n\n        isContentVisible()\n        {\n            return !this.forceContent && !!this.currentSelection || this.forceContent;\n        },\n\n        hasSelection()\n        {\n            return !(0,utils/* isNullOrUndefined */.le)(this.selectedAttributes) && !Object.values(this.selectedAttributes).some((value) => value < 0);\n        },\n\n        attributes() {\n            return this.currentVariationSelect && this.currentVariationSelect.attributes;\n        },\n\n        selectedAttributes() {\n            return this.currentVariationSelect && this.currentVariationSelect.selectedAttributes;\n        },\n\n        selectedUnit() {\n            return this.currentVariationSelect && this.currentVariationSelect.selectedUnit;\n        },\n\n        variations() {\n            return this.currentVariationSelect && this.currentVariationSelect.variations;\n        }\n    },\n\n    methods:\n    {\n        /**\n         * select an attribute and check, if the selection is valid; if not, unsetInvalidSelection will be executed\n         * @param {number} attributeId\n         * @param {[number, string, null]} attributeValueId\n         */\n        selectAttribute(attributeId, attributeValueId)\n        {\n            attributeValueId = parseInt(attributeValueId) || null;\n\n            if (this.selectedAttributes[attributeId] !== attributeValueId)\n            {\n                this.$store.commit(`${this.itemId}/variationSelect/selectItemAttribute`, { attributeId, attributeValueId });\n                this.onSelectionChange(attributeId, attributeValueId, null);\n            }\n        },\n\n        /**\n         * select a unit and check, if the selection is valid; if not, unsetInvalidSelection will be executed\n         * @param {[number, string]} unitId\n         */\n        selectUnit(unitId)\n        {\n            unitId = parseInt(unitId);\n            this.$store.commit(`${this.itemId}/variationSelect/selectItemUnit`, unitId);\n            this.onSelectionChange(null, null, unitId);\n        },\n\n        onSelectionChange(attributeId, attributeValueId, unitId)\n        {\n            if (this.currentSelection)\n            {\n                this.setVariation(this.currentSelection.variationId);\n            }\n            else if (!this.hasSelection)\n            {\n                // user switched back to "please select"\n                this.setVariation(0);\n            }\n            else\n            {\n                this.unsetInvalidSelection(attributeId, attributeValueId, unitId);\n            }\n\n            this.lastContentCount = this.possibleUnitCombinationIds.length;\n        },\n\n        /**\n         * changes the selected attributes / unit, to ensure a valid seelction\n         * @param {[number, null]} attributeId\n         * @param {[number, null]} attributeValueId\n         * @param {[number, null]} unitId\n         */\n        unsetInvalidSelection(attributeId, attributeValueId, unitId)\n        {\n            const qualifiedVariations = this.getQualifiedVariations(attributeId, attributeValueId, unitId);\n            const closestVariations = this.getClosestVariations(qualifiedVariations);\n            \n            // if the salable \'closestVariations\' is undefined, take the not-salable one\n            const closestVariation = closestVariations[0] || closestVariations[1];\n\n            if (!closestVariation)\n            {\n                return;\n            }\n\n            const invalidSelection = this.getInvalidSelectionByVariation(closestVariation);\n\n            this.correctSelection(invalidSelection);\n        },\n\n        getTooltip(attribute, attributeValue)\n        {\n            if(!this.isAttributeSelectionValid(attribute.attributeId, attributeValue.attributeValueId, true))\n            {\n                return this.getInvalidOptionTooltip(attribute.attributeId, attributeValue.attributeValueId);\n            }\n            else if(attribute.type === "image")\n            {\n                return this.$translate("Ceres::Template.singleItemAttributeTooltip", {\n                    attribute: attribute.name,\n                    value: attributeValue.name\n                });\n            }\n\n            return "";\n        },\n\n        /**\n         * returns a string for box tooltips, for not available options\n         * @param {number} attributeId\n         * @param {number} attributeValueId\n         */\n        getInvalidOptionTooltip(attributeId, attributeValueId)\n        {\n            const qualifiedVariations = this.getQualifiedVariations(attributeId, attributeValueId);\n            const closestVariations   = this.getClosestVariations(qualifiedVariations);\n\n            if (!closestVariations || closestVariations.length <= 0)\n            {\n                return "";\n            }\n\n            const invalidSelections = [\n                !!closestVariations[0] ? this.getInvalidSelectionByVariation(closestVariations[0]) : null,\n                !!closestVariations[1] ? this.getInvalidSelectionByVariation(closestVariations[1]) : null\n            ];\n\n            if (!!invalidSelections[0]\n                && !!invalidSelections[1]\n                && invalidSelections[0].attributesToReset.length > invalidSelections[1].attributesToReset.length)\n            {\n                // there is a non-salable variation with less changes\n                return this.$translate("Ceres::Template.singleItemNotSalable");\n            }\n\n            const invalidSelection = invalidSelections[0] || invalidSelections[1];\n            const names = [];\n\n            for (const attribute of invalidSelection.attributesToReset)\n            {\n                if (attribute.attributeId !== attributeId)\n                {\n                    names.push("<b>" + attribute.name +"</b>");\n                }\n            }\n            if (invalidSelection.newUnit)\n            {\n                names.push(\n                    "<b>" + this.$translate("Ceres::Template.singleItemContent") + "</b>"\n                );\n            }\n\n            if (!names.length)\n            {\n                return null;\n            }\n\n            return this.$translate("Ceres::Template.singleItemNotAvailableInSelection", { name: names.join(", ") });\n        },\n\n        /**\n         * returns a list of variations, filtered by attribute or unit\n         * @param {[number, null]} attributeId\n         * @param {[number, null]} attributeValueId\n         * @param {[number, null]} unitId\n         */\n        getQualifiedVariations(attributeId, attributeValueId, unitId)\n        {\n            if ((0,utils/* isDefined */.$K)(attributeValueId))\n            {\n                return this.variations.filter(variation =>\n                {\n                    return (0,utils/* isDefined */.$K)(variation.attributes.find(attribute =>\n                        attribute.attributeId === attributeId && attribute.attributeValueId === attributeValueId));\n                });\n            }\n            else if ((0,utils/* isDefined */.$K)(unitId))\n            {\n                return this.variations.filter(variation => variation.unitCombinationId === unitId);\n            }\n\n            return this.variations.filter(variation => !variation.attributes.length);\n        },\n\n        /**\n         * return a salable and a non-salable variation with the minimum number of changes on attributes compared to the current selection.\n         * @param {array} qualifiedVariations\n         */\n        getClosestVariations(qualifiedVariations)\n        {\n            let closestSalableVariation, numberOfSalableChanges;\n            let closestNonSalableVariation, numberOfNonSalableChanges;\n\n            for (const variation of qualifiedVariations)\n            {\n                let changes = 0;\n\n                if (variation.unitCombinationId !== this.selectedUnit && !(0,utils/* isNull */.Ft)(this.selectedUnit))\n                {\n                    // when the unit dropdown isn\'t visible, it should have a lower weight for reset investigations\n                    const unitWeight = this.possibleUnitCombinationIds.length > 1 && this.isContentVisible ? 0.9 : 0.1;\n\n                    changes += unitWeight;\n                }\n\n                for (const attribute of variation.attributes)\n                {\n                    if (this.selectedAttributes[attribute.attributeId] !== attribute.attributeValueId)\n                    {\n                        changes++;\n                    }\n                }\n\n                if(variation.isSalable && (!numberOfSalableChanges || changes < numberOfSalableChanges))\n                {\n                    closestSalableVariation = variation;\n                    numberOfSalableChanges = changes;\n                }\n                else if (!variation.isSalable && (!numberOfNonSalableChanges || changes < numberOfNonSalableChanges))\n                {\n                    closestNonSalableVariation = variation;\n                    numberOfNonSalableChanges = changes;\n                }\n            }\n\n            return [closestSalableVariation, closestNonSalableVariation];\n        },\n\n        /**\n         * returns object with array \'attributesToReset\' and newUnit. The attributesToReset contains all attributes, which are not matching with the given variation\n         * @param {object} variation\n         */\n        getInvalidSelectionByVariation(variation)\n        {\n            const attributesToReset = [];\n            let newUnit = null;\n\n            for (let selectedAttributeId in this.selectedAttributes)\n            {\n                selectedAttributeId = parseInt(selectedAttributeId);\n                const variationAttribute = variation.attributes.find(attribute => attribute.attributeId === selectedAttributeId);\n\n                if (!(0,utils/* isNull */.Ft)(this.selectedAttributes[selectedAttributeId]))\n                {\n                    if (variationAttribute && variationAttribute.attributeValueId !== this.selectedAttributes[selectedAttributeId] || !variationAttribute)\n                    {\n                        const attributeToReset = this.attributes.find(attr => attr.attributeId === selectedAttributeId);\n\n                        attributesToReset.push(attributeToReset);\n                    }\n                }\n            }\n\n            if (variation.unitCombinationId !== this.selectedUnit)\n            {\n                newUnit = variation.unitCombinationId;\n            }\n\n            return { attributesToReset, newUnit };\n        },\n\n        /**\n         * resets all invalid attributes and change the unit, if required. Prints a message to the user if so.\n         * @param {object} invalidSelection\n         */\n        correctSelection(invalidSelection)\n        {\n            const messages   = [];\n            const attributes = JSON.parse(JSON.stringify(this.selectedAttributes));\n\n            for (const attributeToReset of invalidSelection.attributesToReset)\n            {\n                messages.push(\n                    this.$translate("Ceres::Template.singleItemNotAvailable", { name: attributeToReset.name })\n                );\n\n                attributes[attributeToReset.attributeId] = (!this.hasEmptyOption && App.config.item.showPleaseSelect) ? -1 : null;\n            }\n\n            if (invalidSelection.newUnit)\n            {\n                if (this.lastContentCount > 1 && this.possibleUnitCombinationIds.length > 1 && !(0,utils/* isNull */.Ft)(this.selectedUnit))\n                {\n                    messages.push(\n                        this.$translate("Ceres::Template.singleItemNotAvailable", { name:\n                                this.$translate("Ceres::Template.singleItemContent")\n                        })\n                    );\n                }\n\n                this.$store.commit(`${this.itemId}/variationSelect/selectItemUnit`, invalidSelection.newUnit);\n            }\n\n            this.$store.commit(`${this.itemId}/variationSelect/setItemSelectedAttributes`, attributes);\n\n            this.setVariation(this.currentSelection ? this.currentSelection.variationId : 0);\n\n            NotificationService.warn(\n                messages.join("<br>")\n            ).closeAfter(5000);\n        },\n\n        /**\n         * returns matching variations with current selection\n         * attributes and unitId could be filled, to check a specific selection\n         * @param {object} attributes\n         * @param {number} unitId\n         * @param {boolean} strict\n         */\n        filterVariations(attributes, unitId, strict, ignoreUnit)\n        {\n            attributes = attributes || this.selectedAttributes;\n            unitId = unitId || this.selectedUnit;\n            strict = !!strict;\n            ignoreUnit = !!ignoreUnit;\n\n            const key = JSON.stringify(attributes) + "_" + unitId + "_" + strict + "_" + ignoreUnit;\n\n            if ((0,utils/* isDefined */.$K)(this.filteredVariationsCache[key]))\n            {\n                return this.filteredVariationsCache[key];\n            }\n\n            const uniqueValues = [...new Set(Object.values(attributes))];\n            const isEmptyOptionSelected = uniqueValues.length === 1 && (0,utils/* isNull */.Ft)(uniqueValues[0]);\n            const filteredVariations = this.variations.filter(variation =>\n            {\n                // the selected unit is not matching\n                if (!ignoreUnit && variation.unitCombinationId !== unitId)\n                {\n                    return false;\n                }\n\n                // the variation has no attributes (only checked, if any attribute has a selected value); or the variation has attributes and empty option is selected\n                // requires more than 0 attributes\n                if (((!isEmptyOptionSelected && !variation.attributes.length) || (isEmptyOptionSelected && variation.attributes.length))\n                    && this.attributes.length > 0)\n                {\n                    return false;\n                }\n\n                for (const attributeId in attributes)\n                {\n                    const variationAttribute = variation.attributes.find(variationAttribute =>\n                        variationAttribute.attributeId === parseInt(attributeId));\n\n                    // an attribute is not matching with selection\n                    if (variationAttribute &&\n                        variationAttribute.attributeValueId !== attributes[attributeId] &&\n                        (strict || !strict && !(0,utils/* isNull */.Ft)(attributes[attributeId]) && attributes[attributeId] !== -1))\n                    {\n                        return false;\n                    }\n                }\n\n                return true;\n            });\n\n            this.filteredVariationsCache[key] = filteredVariations;\n\n            return filteredVariations;\n        },\n\n        /**\n         * returns true, if the selection with a new attribute value would be valid\n         * @param {number} attributeId\n         * @param {[number, string, null]} attributeValueId\n         * @param {boolean} filterSalableVariations\n         */\n        isAttributeSelectionValid(attributeId, attributeValueId, filterSalableVariations)\n        {\n            attributeValueId = parseInt(attributeValueId) || null;\n            if (this.selectedAttributes[attributeId] === attributeValueId)\n            {\n                return true;\n            }\n\n            const selectedAttributes = JSON.parse(JSON.stringify(this.selectedAttributes));\n\n            selectedAttributes[attributeId] = parseInt(attributeValueId) || null;\n\n            const ignoreUnit = !(Object.keys(this.possibleUnits).length > 1 && this.isContentVisible);\n            let variations = this.filterVariations(selectedAttributes, null, null, ignoreUnit);\n\n            if (filterSalableVariations)\n            {\n                variations = variations.filter(variation => variation.isSalable)\n            }\n\n            return variations.length > 0;\n        },\n\n        /**\n         * returns true, if the selection with a new unitId would be valid\n         * @param {[number, string]} unitId\n         */\n        isUnitSelectionValid(unitId)\n        {\n            unitId = parseInt(unitId);\n            if (this.selectedUnit === unitId)\n            {\n                return true;\n            }\n\n            return this\n                .filterVariations(null, unitId)\n                .filter(variation => variation.isSalable)\n                .length > 0\n        },\n\n        /**\n         * dispatch vuex action \'loadVariation\' to archive a variation\n         * dispatches a custom event named \'onVariationChanged\'\n         * @param {[string, number, null]} variationId\n         */\n        setVariation(variationId)\n        {\n            if (!(0,utils/* isDefined */.$K)(variationId) && this.currentSelection)\n            {\n                variationId = this.currentSelection.variationId;\n            }\n\n            if ((0,utils/* isDefined */.$K)(variationId))\n            {\n                this.$store.dispatch(`${this.itemId}/loadVariation`, variationId).then(variation =>\n                {\n                    document.dispatchEvent(new CustomEvent("onVariationChanged",\n                        {\n                            detail:\n                                {\n                                    attributes: variation.attributes,\n                                    documents: variation.documents,\n                                    itemId: this.itemId\n                                }\n                        }));\n                });\n            }\n        },\n\n        isTextCut(content)\n        {\n            if (this.$refs.attributesContaner)\n            {\n                return (0,dom/* textWidth */.$H)(content, "Custom-Font, Helvetica, Arial, sans-serif") > this.$refs.attributesContaner[0].clientWidth;\n            }\n\n            return false;\n        },\n\n        getSelectedAttributeValueName(attribute)\n        {\n            const selectedAttributeValueId =  this.selectedAttributes[attribute.attributeId];\n            const selectedAttributeValue = attribute.values.find(attrValue => attrValue.attributeValueId === selectedAttributeValueId);\n\n            if (selectedAttributeValue)\n            {\n                return selectedAttributeValue.name;\n            }\n            else if (App.config.item.showPleaseSelect && selectedAttributeValueId === -1)\n            {\n                return this.$translate("Ceres::Template.singleItemPleaseSelect");\n            }\n            return this.$translate("Ceres::Template.singleItemNoSelection");\n        },\n\n        transformPossibleUnits(possibleUnits)\n        {\n            return Object.entries(possibleUnits).sort((unitA, unitB) => {\n                unitA = this.splitUnitName(unitA[1]);\n                unitB = this.splitUnitName(unitB[1]);\n                // order by unit\n                if (unitA[1] < unitB[1]) {\n                    return -1;\n                }\n                if (unitA[1] > unitB[1]) {\n                    return 1;\n                }\n                // order by content (count)\n                if (unitA[0] < unitB[0]) {\n                    return -1;\n                }\n                if (unitA[0] > unitB[0]) {\n                    return 1;\n                }\n                return 0;\n            });\n        },\n        splitUnitName(unitName) {\n            const unitNameSplit = unitName.split(" ");\n\n            if (!isNaN(unitNameSplit[0])) {\n                unitNameSplit[0] = unitNameSplit[0].replace(App.currencyPattern.separator_thousands, "");\n                unitNameSplit[0] = parseInt(unitNameSplit[0]);\n            }\n\n            return unitNameSplit;\n        }\n    },\n\n    watch:\n    {\n        currentSelection(value)\n        {\n            this.$store.commit(`${this.itemId}/variationSelect/setIsVariationSelected`, !!value);\n        },\n        variations()\n        {\n            // FIX unset variation cache after subsequent variations are loaded\n            this.filteredVariationsCache = {};\n        }\n    }\n});\n\n;// CONCATENATED MODULE: ./resources/js/src/app/components/item/VariationSelect.vue?vue&type=script&lang=js&\n /* harmony default export */ var item_VariationSelectvue_type_script_lang_js_ = (VariationSelectvue_type_script_lang_js_); \n// EXTERNAL MODULE: ./node_modules/vue-loader/lib/runtime/componentNormalizer.js\nvar componentNormalizer = __webpack_require__(1900);\n;// CONCATENATED MODULE: ./resources/js/src/app/components/item/VariationSelect.vue\n\n\n\n\n\n/* normalize component */\n;\nvar component = (0,componentNormalizer/* default */.Z)(\n  item_VariationSelectvue_type_script_lang_js_,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\n/* hot reload */\nif (false) { var api; }\ncomponent.options.__file = "resources/js/src/app/components/item/VariationSelect.vue"\n/* harmony default export */ var VariationSelect = (component.exports);//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiNTk5Ny5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFNLG9CQUFvQjtBQUMxQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGtCQUFrQixvREFBb0Q7QUFDdEU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHlCQUF5QjtBQUN6QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsK0JBQStCO0FBQy9CO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlDQUFpQztBQUNqQywrQkFBK0I7QUFDL0IsNkJBQTZCO0FBQzdCO0FBQ0E7QUFDQSxpREFBaUQsWUFBWSxhQUFhO0FBQzFFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsdUNBQXVDO0FBQ3ZDLHFDQUFxQztBQUNyQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxxQ0FBcUM7QUFDckMsbUNBQW1DO0FBQ25DO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG9EQUFvRDtBQUNwRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esb0RBQW9EO0FBQ3BEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwrQkFBK0I7QUFDL0I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQ0FBaUM7QUFDakM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLCtCQUErQjtBQUMvQiw2QkFBNkI7QUFDN0I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxxQ0FBcUMsa0NBQWtDO0FBQ3ZFLDJCQUEyQjtBQUMzQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNEJBQTRCLFNBQVMscUNBQXFDO0FBQzFFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EscUNBQXFDLG9DQUFvQztBQUN6RSwyQkFBMkI7QUFDM0I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxxQ0FBcUM7QUFDckM7QUFDQTtBQUNBLHFDQUFxQztBQUNyQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx1Q0FBdUM7QUFDdkMscUNBQXFDO0FBQ3JDLG1DQUFtQztBQUNuQztBQUNBLGlEQUFpRCxxQkFBcUI7QUFDdEU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxxQ0FBcUM7QUFDckM7QUFDQTtBQUNBLHFDQUFxQztBQUNyQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx1Q0FBdUM7QUFDdkMscUNBQXFDO0FBQ3JDLG1DQUFtQztBQUNuQztBQUNBLGlEQUFpRCxxQkFBcUI7QUFDdEU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxxQ0FBcUM7QUFDckM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG1DQUFtQztBQUNuQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxtQ0FBbUM7QUFDbkM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EscUNBQXFDO0FBQ3JDLG1DQUFtQztBQUNuQyxpQ0FBaUM7QUFDakM7QUFDQTtBQUNBLG1EQUFtRCxxQkFBcUI7QUFDeEU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx5Q0FBeUM7QUFDekMsdUNBQXVDO0FBQ3ZDO0FBQ0E7QUFDQSw2QkFBNkI7QUFDN0I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBLDRCQUE0Qix3Q0FBd0M7QUFDcEUsOEJBQThCLDJCQUEyQjtBQUN6RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHlCQUF5QjtBQUN6QjtBQUNBO0FBQ0E7QUFDQSwyQkFBMkI7QUFDM0IseUJBQXlCO0FBQ3pCLHVCQUF1QjtBQUN2QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwrQkFBK0I7QUFDL0IsNkJBQTZCO0FBQzdCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx5QkFBeUI7QUFDekIsdUJBQXVCO0FBQ3ZCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUU5VjZDO0FBQzZCOztBQUUxRSw0QkFBNEIsbUJBQU8sQ0FBQyxJQUFvQzs7QUFFeEUsNEVBQWU7O0FBRWY7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLG9CQUFvQixtQ0FBaUI7QUFDckM7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGdCQUFnQiwyQkFBUztBQUN6QjtBQUNBO0FBQ0E7QUFDQSwyQkFBMkIsMkJBQVM7QUFDcEM7QUFDQTtBQUNBO0FBQ0EscUJBQXFCLDJCQUFTO0FBQzlCO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBLDBFQUEwRSx3QkFBTTtBQUNoRjtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQSxxQkFBcUIsd0JBQU07QUFDM0I7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsZ0dBQWdHLHdCQUFNO0FBQ3RHO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUEsZ0JBQWdCLDJCQUFTO0FBQ3pCO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLHVFQUF1RSx3QkFBTTtBQUM3RTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSwrQ0FBK0Msd0JBQU07QUFDckQ7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUIsMkJBQVM7QUFDMUI7QUFDQTtBQUNBOztBQUVBLGdCQUFnQiwyQkFBUztBQUN6QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSx1QkFBdUIseUJBQVM7QUFDaEM7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7OztBQzFzQjZJLENBQUMsaUZBQWUsdUNBQUcsRUFBQyxDOzs7O0FDQXBFO0FBQzNCO0FBQ0w7OztBQUc5RDtBQUNBLENBQXNHO0FBQ3RHLGdCQUFnQixzQ0FBVTtBQUMxQixFQUFFLDRDQUFNO0FBQ1IsRUFBRSxNQUFNO0FBQ1IsRUFBRSxlQUFlO0FBQ2pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLElBQUksS0FBVSxFQUFFLFlBaUJmO0FBQ0Q7QUFDQSxvREFBZSIsInNvdXJjZXMiOlsid2VicGFjazovL0NlcmVzLy4vcmVzb3VyY2VzL2pzL3NyYy9hcHAvY29tcG9uZW50cy9pdGVtL1ZhcmlhdGlvblNlbGVjdC52dWU/ZGY5ZiIsIndlYnBhY2s6Ly9DZXJlcy8uL3Jlc291cmNlcy9qcy9zcmMvYXBwL2NvbXBvbmVudHMvaXRlbS9WYXJpYXRpb25TZWxlY3QudnVlPzMxODUiLCJ3ZWJwYWNrOi8vQ2VyZXMvcmVzb3VyY2VzL2pzL3NyYy9hcHAvY29tcG9uZW50cy9pdGVtL1ZhcmlhdGlvblNlbGVjdC52dWU/MTQ0NyIsIndlYnBhY2s6Ly9DZXJlcy8uL3Jlc291cmNlcy9qcy9zcmMvYXBwL2NvbXBvbmVudHMvaXRlbS9WYXJpYXRpb25TZWxlY3QudnVlPzMwZWEiLCJ3ZWJwYWNrOi8vQ2VyZXMvLi9yZXNvdXJjZXMvanMvc3JjL2FwcC9jb21wb25lbnRzL2l0ZW0vVmFyaWF0aW9uU2VsZWN0LnZ1ZT80NzkyIl0sInNvdXJjZXNDb250ZW50IjpbInZhciByZW5kZXIgPSBmdW5jdGlvbiAoKSB7XG4gIHZhciBfdm0gPSB0aGlzXG4gIHZhciBfaCA9IF92bS4kY3JlYXRlRWxlbWVudFxuICB2YXIgX2MgPSBfdm0uX3NlbGYuX2MgfHwgX2hcbiAgcmV0dXJuIF9jKFxuICAgIFwiZGl2XCIsXG4gICAgeyBzdGF0aWNDbGFzczogXCJyb3dcIiB9LFxuICAgIFtcbiAgICAgIF92bS5hdHRyaWJ1dGVzLmxlbmd0aCB8fFxuICAgICAgKF92bS5wb3NzaWJsZVVuaXRDb21iaW5hdGlvbklkcy5sZW5ndGggPiAxICYmIF92bS5pc0NvbnRlbnRWaXNpYmxlKVxuICAgICAgICA/IFtcbiAgICAgICAgICAgIF92bS5fbChfdm0uYXR0cmlidXRlcywgZnVuY3Rpb24gKGF0dHJpYnV0ZSwgaW5kZXgpIHtcbiAgICAgICAgICAgICAgcmV0dXJuIF9jKFxuICAgICAgICAgICAgICAgIFwiZGl2XCIsXG4gICAgICAgICAgICAgICAgeyBrZXk6IGluZGV4LCBzdGF0aWNDbGFzczogXCJjb2wtMTIgdmFyaWF0aW9uLXNlbGVjdFwiIH0sXG4gICAgICAgICAgICAgICAgW1xuICAgICAgICAgICAgICAgICAgYXR0cmlidXRlLnR5cGUgPT09IFwiZHJvcGRvd25cIlxuICAgICAgICAgICAgICAgICAgICA/IF9jKFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJkaXZcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgcmVmOiBcImF0dHJpYnV0ZXNDb250YW5lclwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICByZWZJbkZvcjogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgc3RhdGljQ2xhc3M6IFwiaW5wdXQtdW5pdFwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgIFtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgX2MoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJzZWxlY3RcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGF0aWNDbGFzczogXCJjdXN0b20tc2VsZWN0XCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhdHRyczoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZDogXCJjdXN0b20tc2VsZWN0X1wiICsgYXR0cmlidXRlLm5hbWUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiZGF0YS10ZXN0aW5nXCI6IFwidmFyaWF0aW9uLXNlbGVjdC1kcm9wZG93blwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9uOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNoYW5nZTogZnVuY3Rpb24gKCRldmVudCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBfdm0uc2VsZWN0QXR0cmlidXRlKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXR0cmlidXRlLmF0dHJpYnV0ZUlkLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJGV2ZW50LnRhcmdldC52YWx1ZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIClcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBbXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfdm0uYWRkUGxlYXNlU2VsZWN0T3B0aW9uIHx8ICFfdm0uaGFzU2VsZWN0aW9uXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgID8gX2MoXCJvcHRpb25cIiwgeyBkb21Qcm9wczogeyB2YWx1ZTogLTEgfSB9LCBbXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfdm0uX3YoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF92bS5fcyhcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfdm0uJHRyYW5zbGF0ZShcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiQ2VyZXM6OlRlbXBsYXRlLnNpbmdsZUl0ZW1QbGVhc2VTZWxlY3RcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIClcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBdKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA6IF92bS5fZSgpLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX3ZtLl92KFwiIFwiKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF92bS5oYXNFbXB0eU9wdGlvbiB8fFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX3ZtLnNlbGVjdGVkQXR0cmlidXRlc1thdHRyaWJ1dGUuYXR0cmlidXRlSWRdID09PVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBudWxsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgID8gX2MoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIm9wdGlvblwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkb21Qcm9wczoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlOiBudWxsLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbGVjdGVkOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX3ZtLnNlbGVjdGVkQXR0cmlidXRlc1tcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXR0cmlidXRlLmF0dHJpYnV0ZUlkXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBdID09PSBudWxsLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX3ZtLl92KFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF92bS5fcyhcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF92bS4kdHJhbnNsYXRlKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIkNlcmVzOjpUZW1wbGF0ZS5zaW5nbGVJdGVtTm9TZWxlY3Rpb25cIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIClcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDogX3ZtLl9lKCksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfdm0uX3YoXCIgXCIpLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX3ZtLl9sKGF0dHJpYnV0ZS52YWx1ZXMsIGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gX2MoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJvcHRpb25cIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBrZXk6IHZhbHVlLmF0dHJpYnV0ZVZhbHVlSWQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkb21Qcm9wczoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZTogdmFsdWUuYXR0cmlidXRlVmFsdWVJZCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VsZWN0ZWQ6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWUuYXR0cmlidXRlVmFsdWVJZCA9PT1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfdm0uc2VsZWN0ZWRBdHRyaWJ1dGVzW1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXR0cmlidXRlLmF0dHJpYnV0ZUlkXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBbXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfdm0uaXNBdHRyaWJ1dGVTZWxlY3Rpb25WYWxpZChcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXR0cmlidXRlLmF0dHJpYnV0ZUlkLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZS5hdHRyaWJ1dGVWYWx1ZUlkLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0cnVlXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgID8gW1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX3ZtLl92KFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIlxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIiArXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX3ZtLl9zKHZhbHVlLm5hbWUpICtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIlxcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgOiBfdm0uaXNBdHRyaWJ1dGVTZWxlY3Rpb25WYWxpZChcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGF0dHJpYnV0ZS5hdHRyaWJ1dGVJZCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlLmF0dHJpYnV0ZVZhbHVlSWQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmYWxzZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIClcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPyBbXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfdm0uX3YoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiXFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiICtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfdm0uX3MoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfdm0uJHRyYW5zbGF0ZShcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJDZXJlczo6VGVtcGxhdGUuc2luZ2xlSXRlbU5vdFNhbGFibGVBdHRyaWJ1dGVcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgeyBuYW1lOiB2YWx1ZS5uYW1lIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIClcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApICtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIlxcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgOiBbXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfdm0uX3YoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiXFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiICtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfdm0uX3MoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfdm0uJHRyYW5zbGF0ZShcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJDZXJlczo6VGVtcGxhdGUuc2luZ2xlSXRlbUludmFsaWRBdHRyaWJ1dGVcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgeyBuYW1lOiB2YWx1ZS5uYW1lIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIClcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApICtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIlxcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIClcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgMlxuICAgICAgICAgICAgICAgICAgICAgICAgICApLFxuICAgICAgICAgICAgICAgICAgICAgICAgICBfdm0uX3YoXCIgXCIpLFxuICAgICAgICAgICAgICAgICAgICAgICAgICBfYyhcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImxhYmVsXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGlyZWN0aXZlczogW1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogXCJ0b29sdGlwXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmF3TmFtZTogXCJ2LXRvb2x0aXBcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZTogX3ZtLmlzVGV4dEN1dChhdHRyaWJ1dGUubmFtZSksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZXhwcmVzc2lvbjogXCJpc1RleHRDdXQoYXR0cmlidXRlLm5hbWUpXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICBdLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXR0cnM6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yOiBcImN1c3RvbS1zZWxlY3RfXCIgKyBhdHRyaWJ1dGUubmFtZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJkYXRhLXRvZ2dsZVwiOiBcInRvb2x0aXBcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJkYXRhLXBsYWNlbWVudFwiOiBcInRvcFwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aXRsZTogYXR0cmlidXRlLm5hbWUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiZGF0YS10ZXN0aW5nXCI6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJ2YXJpYXRpb24tc2VsZWN0LWRyb3Bkb3duLWxhYmVsXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgW192bS5fdihfdm0uX3MoYXR0cmlidXRlLm5hbWUpKV1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgKSxcbiAgICAgICAgICAgICAgICAgICAgICAgIF1cbiAgICAgICAgICAgICAgICAgICAgICApXG4gICAgICAgICAgICAgICAgICAgIDogYXR0cmlidXRlLnR5cGUgPT09IFwiYm94XCIgfHwgYXR0cmlidXRlLnR5cGUgPT09IFwiaW1hZ2VcIlxuICAgICAgICAgICAgICAgICAgICA/IF9jKFwiZGl2XCIsIFtcbiAgICAgICAgICAgICAgICAgICAgICAgIF9jKFxuICAgICAgICAgICAgICAgICAgICAgICAgICBcInNwYW5cIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0YXRpY0NsYXNzOiBcInRleHQtbXV0ZWRcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhdHRyczogeyBcImRhdGEtdGVzdGluZ1wiOiBcImF0dHJpYnV0ZS1uYW1lXCIgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgW192bS5fdihfdm0uX3MoYXR0cmlidXRlLm5hbWUpICsgXCI6XCIpXVxuICAgICAgICAgICAgICAgICAgICAgICAgKSxcbiAgICAgICAgICAgICAgICAgICAgICAgIF92bS5fdihcIiBcIiksXG4gICAgICAgICAgICAgICAgICAgICAgICBfYyhcbiAgICAgICAgICAgICAgICAgICAgICAgICAgXCJiXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgIHsgYXR0cnM6IHsgXCJkYXRhLXRlc3RpbmdcIjogXCJhdHRyaWJ1dGUtdmFsdWVcIiB9IH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgIFtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfdm0uX3YoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfdm0uX3MoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF92bS5nZXRTZWxlY3RlZEF0dHJpYnV0ZVZhbHVlTmFtZShhdHRyaWJ1dGUpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICApXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgXVxuICAgICAgICAgICAgICAgICAgICAgICAgKSxcbiAgICAgICAgICAgICAgICAgICAgICAgIF92bS5fdihcIiBcIiksXG4gICAgICAgICAgICAgICAgICAgICAgICBfYyhcbiAgICAgICAgICAgICAgICAgICAgICAgICAgXCJkaXZcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0YXRpY0NsYXNzOiBcInYtcy1ib3hlcyBweS0zXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2xhc3M6IHsgaW1hZ2VzOiBhdHRyaWJ1dGUudHlwZSA9PT0gXCJpbWFnZVwiIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgIFtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfdm0uYWRkUGxlYXNlU2VsZWN0T3B0aW9uXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICA/IF9jKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiZGl2XCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RhdGljQ2xhc3M6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwidi1zLWJveCBiZy13aGl0ZSBlbXB0eS1vcHRpb25cIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNsYXNzOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFjdGl2ZTpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfdm0uc2VsZWN0ZWRBdHRyaWJ1dGVzW1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXR0cmlidXRlLmF0dHJpYnV0ZUlkXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXSA9PT0gLTEsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGludmFsaWQ6ICFfdm0uaXNBdHRyaWJ1dGVTZWxlY3Rpb25WYWxpZChcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhdHRyaWJ1dGUuYXR0cmlidXRlSWQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLTFcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhdHRyczoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImRhdGEtdGVzdGluZ1wiOiBcInZhcmlhdGlvbi1zZWxlY3QtYm94XCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb246IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2xpY2s6IGZ1bmN0aW9uICgkZXZlbnQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gX3ZtLnNlbGVjdEF0dHJpYnV0ZShcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGF0dHJpYnV0ZS5hdHRyaWJ1dGVJZCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC0xXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9jKFwic3BhblwiLCB7IHN0YXRpY0NsYXNzOiBcIm14LTNcIiB9LCBbXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF92bS5fdihcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfdm0uX3MoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfdm0uJHRyYW5zbGF0ZShcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJDZXJlczo6VGVtcGxhdGUuc2luZ2xlSXRlbVBsZWFzZVNlbGVjdFwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXSksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICA6IF92bS5fZSgpLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF92bS5fdihcIiBcIiksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgX3ZtLmhhc0VtcHR5T3B0aW9uXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICA/IF9jKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiZGl2XCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RhdGljQ2xhc3M6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwidi1zLWJveCBiZy13aGl0ZSBlbXB0eS1vcHRpb25cIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNsYXNzOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFjdGl2ZTpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfdm0uc2VsZWN0ZWRBdHRyaWJ1dGVzW1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXR0cmlidXRlLmF0dHJpYnV0ZUlkXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXSA9PT0gbnVsbCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaW52YWxpZDogIV92bS5pc0F0dHJpYnV0ZVNlbGVjdGlvblZhbGlkKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGF0dHJpYnV0ZS5hdHRyaWJ1dGVJZCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBudWxsLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRydWVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhdHRyczoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImRhdGEtdGVzdGluZ1wiOiBcInZhcmlhdGlvbi1zZWxlY3QtYm94XCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb246IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2xpY2s6IGZ1bmN0aW9uICgkZXZlbnQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gX3ZtLnNlbGVjdEF0dHJpYnV0ZShcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGF0dHJpYnV0ZS5hdHRyaWJ1dGVJZCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG51bGxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgW1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX2MoXCJzcGFuXCIsIHsgc3RhdGljQ2xhc3M6IFwibXgtM1wiIH0sIFtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX3ZtLl92KFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF92bS5fcyhcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF92bS4kdHJhbnNsYXRlKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIkNlcmVzOjpUZW1wbGF0ZS5zaW5nbGVJdGVtTm9TZWxlY3Rpb25cIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIClcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF0pLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgOiBfdm0uX2UoKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfdm0uX3YoXCIgXCIpLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF92bS5fbChhdHRyaWJ1dGUudmFsdWVzLCBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBfYyhcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJkaXZcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRpcmVjdGl2ZXM6IFtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogXCJ0b29sdGlwXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJhd05hbWU6IFwidi10b29sdGlwXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBleHByZXNzaW9uOiBcInRydWVcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBrZXk6IHZhbHVlLmF0dHJpYnV0ZVZhbHVlSWQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RhdGljQ2xhc3M6IFwidi1zLWJveCBiZy13aGl0ZVwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNsYXNzOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhY3RpdmU6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlLmF0dHJpYnV0ZVZhbHVlSWQgPT09XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF92bS5zZWxlY3RlZEF0dHJpYnV0ZXNbXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXR0cmlidXRlLmF0dHJpYnV0ZUlkXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbnZhbGlkOiAhX3ZtLmlzQXR0cmlidXRlU2VsZWN0aW9uVmFsaWQoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGF0dHJpYnV0ZS5hdHRyaWJ1dGVJZCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWUuYXR0cmlidXRlVmFsdWVJZCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHJ1ZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGF0dHJzOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImRhdGEtdGVzdGluZ1wiOiBcInZhcmlhdGlvbi1zZWxlY3QtYm94XCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImRhdGEtaHRtbFwiOiBcInRydWVcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiZGF0YS10b2dnbGVcIjogXCJ0b29sdGlwXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImRhdGEtcGxhY2VtZW50XCI6IFwidG9wXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImRhdGEtb3JpZ2luYWwtdGl0bGVcIjogX3ZtLmdldFRvb2x0aXAoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGF0dHJpYnV0ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvbjoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2xpY2s6IGZ1bmN0aW9uICgkZXZlbnQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIF92bS5zZWxlY3RBdHRyaWJ1dGUoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXR0cmlidXRlLmF0dHJpYnV0ZUlkLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlLmF0dHJpYnV0ZVZhbHVlSWRcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBbXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXR0cmlidXRlLnR5cGUgPT09IFwiYm94XCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgID8gX2MoXCJzcGFuXCIsIHsgc3RhdGljQ2xhc3M6IFwibXgtM1wiIH0sIFtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfdm0uX3YoX3ZtLl9zKHZhbHVlLm5hbWUpKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDogX2MoXCJpbWdcIiwge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0YXRpY0NsYXNzOiBcInAtMVwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGF0dHJzOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzcmM6IHZhbHVlLmltYWdlVXJsLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYWx0OiB2YWx1ZS5uYW1lLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBdXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICApXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSksXG4gICAgICAgICAgICAgICAgICAgICAgICAgIF0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgIDJcbiAgICAgICAgICAgICAgICAgICAgICAgICksXG4gICAgICAgICAgICAgICAgICAgICAgXSlcbiAgICAgICAgICAgICAgICAgICAgOiBfdm0uX2UoKSxcbiAgICAgICAgICAgICAgICBdXG4gICAgICAgICAgICAgIClcbiAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgX3ZtLl92KFwiIFwiKSxcbiAgICAgICAgICAgIF92bS5wb3NzaWJsZVVuaXRDb21iaW5hdGlvbklkcy5sZW5ndGggPiAxICYmIF92bS5pc0NvbnRlbnRWaXNpYmxlXG4gICAgICAgICAgICAgID8gX2MoXCJkaXZcIiwgeyBzdGF0aWNDbGFzczogXCJjb2wtMTIgdmFyaWF0aW9uLXNlbGVjdFwiIH0sIFtcbiAgICAgICAgICAgICAgICAgIF9jKFwiZGl2XCIsIHsgc3RhdGljQ2xhc3M6IFwiaW5wdXQtdW5pdFwiIH0sIFtcbiAgICAgICAgICAgICAgICAgICAgX2MoXG4gICAgICAgICAgICAgICAgICAgICAgXCJzZWxlY3RcIixcbiAgICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzdGF0aWNDbGFzczogXCJjdXN0b20tc2VsZWN0XCIsXG4gICAgICAgICAgICAgICAgICAgICAgICBhdHRyczoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICBpZDogXCJ1bml0LWNvbWJpbmF0aW9uLWlkcy1zZWxlY3RcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgXCJkYXRhLXRlc3RpbmdcIjogXCJ2YXJpYXRpb24tc2VsZWN0LXVuaXRcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICBvbjoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICBjaGFuZ2U6IGZ1bmN0aW9uICgkZXZlbnQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gX3ZtLnNlbGVjdFVuaXQoJGV2ZW50LnRhcmdldC52YWx1ZSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICBfdm0uX2woXG4gICAgICAgICAgICAgICAgICAgICAgICBfdm0ucG9zc2libGVVbml0Q29tYmluYXRpb25JZHMsXG4gICAgICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiAodW5pdENvbWJpbmF0aW9uSWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIF9jKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwib3B0aW9uXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAga2V5OiB1bml0Q29tYmluYXRpb25JZCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRvbVByb3BzOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlOiB1bml0Q29tYmluYXRpb25JZCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VsZWN0ZWQ6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFyc2VJbnQodW5pdENvbWJpbmF0aW9uSWQpID09PVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF92bS5zZWxlY3RlZFVuaXQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgW1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX3ZtLmlzVW5pdFNlbGVjdGlvblZhbGlkKHVuaXRDb21iaW5hdGlvbklkKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA/IFtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF92bS5fdihcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJcXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCIgK1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF92bS5fcyhcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF92bS5wb3NzaWJsZVVuaXRzW3VuaXRDb21iaW5hdGlvbklkXVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICkgK1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiXFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA6IFtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF92bS5fdihcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJcXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCIgK1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF92bS5fcyhcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF92bS4kdHJhbnNsYXRlKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIkNlcmVzOjpUZW1wbGF0ZS5zaW5nbGVJdGVtSW52YWxpZEF0dHJpYnV0ZVwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogX3ZtLnBvc3NpYmxlVW5pdHNbXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1bml0Q29tYmluYXRpb25JZFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIClcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApICtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIlxcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAyXG4gICAgICAgICAgICAgICAgICAgICAgICAgIClcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICApLFxuICAgICAgICAgICAgICAgICAgICAgIDBcbiAgICAgICAgICAgICAgICAgICAgKSxcbiAgICAgICAgICAgICAgICAgICAgX3ZtLl92KFwiIFwiKSxcbiAgICAgICAgICAgICAgICAgICAgX2MoXG4gICAgICAgICAgICAgICAgICAgICAgXCJsYWJlbFwiLFxuICAgICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGF0dHJzOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgIGZvcjogXCJ1bml0LWNvbWJpbmF0aW9uLWlkcy1zZWxlY3RcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgXCJkYXRhLXRlc3RpbmdcIjogXCJ2YXJpYXRpb24tc2VsZWN0LXVuaXQtbGFiZWxcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICBbXG4gICAgICAgICAgICAgICAgICAgICAgICBfdm0uX3YoXG4gICAgICAgICAgICAgICAgICAgICAgICAgIF92bS5fcyhcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfdm0uJHRyYW5zbGF0ZShcIkNlcmVzOjpUZW1wbGF0ZS5zaW5nbGVJdGVtQ29udGVudFwiKVxuICAgICAgICAgICAgICAgICAgICAgICAgICApXG4gICAgICAgICAgICAgICAgICAgICAgICApLFxuICAgICAgICAgICAgICAgICAgICAgIF1cbiAgICAgICAgICAgICAgICAgICAgKSxcbiAgICAgICAgICAgICAgICAgIF0pLFxuICAgICAgICAgICAgICAgIF0pXG4gICAgICAgICAgICAgIDogX3ZtLl9lKCksXG4gICAgICAgICAgXVxuICAgICAgICA6IFtfdm0uX3QoXCJkZWZhdWx0XCIpXSxcbiAgICBdLFxuICAgIDJcbiAgKVxufVxudmFyIHN0YXRpY1JlbmRlckZucyA9IFtdXG5yZW5kZXIuX3dpdGhTdHJpcHBlZCA9IHRydWVcblxuZXhwb3J0IHsgcmVuZGVyLCBzdGF0aWNSZW5kZXJGbnMgfSIsImV4cG9ydCAqIGZyb20gXCItIS4uLy4uLy4uLy4uLy4uLy4uL25vZGVfbW9kdWxlcy92dWUtbG9hZGVyL2xpYi9sb2FkZXJzL3RlbXBsYXRlTG9hZGVyLmpzPz92dWUtbG9hZGVyLW9wdGlvbnMhLi4vLi4vLi4vLi4vLi4vLi4vbm9kZV9tb2R1bGVzL3Z1ZS1sb2FkZXIvbGliL2luZGV4LmpzPz92dWUtbG9hZGVyLW9wdGlvbnMhLi9WYXJpYXRpb25TZWxlY3QudnVlP3Z1ZSZ0eXBlPXRlbXBsYXRlJmlkPTRhOTM5ZDA1JlwiIiwiPHRlbXBsYXRlPlxuICAgIDxkaXYgY2xhc3M9XCJyb3dcIj5cbiAgICAgICAgPHRlbXBsYXRlIHYtaWY9XCJhdHRyaWJ1dGVzLmxlbmd0aCB8fCAocG9zc2libGVVbml0Q29tYmluYXRpb25JZHMubGVuZ3RoID4gMSAmJiBpc0NvbnRlbnRWaXNpYmxlKVwiPlxuICAgICAgICAgICAgPGRpdiBjbGFzcz1cImNvbC0xMiB2YXJpYXRpb24tc2VsZWN0XCIgdi1mb3I9XCIoYXR0cmlidXRlLCBpbmRleCkgaW4gYXR0cmlidXRlc1wiIDprZXk9XCJpbmRleFwiPlxuICAgICAgICAgICAgICAgIDwhLS0gZHJvcGRvd24gLS0+XG4gICAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cImlucHV0LXVuaXRcIiByZWY9XCJhdHRyaWJ1dGVzQ29udGFuZXJcIiB2LWlmPVwiYXR0cmlidXRlLnR5cGUgPT09ICdkcm9wZG93bidcIj5cbiAgICAgICAgICAgICAgICAgICAgPHNlbGVjdCA6aWQ9XCInY3VzdG9tLXNlbGVjdF8nICsgYXR0cmlidXRlLm5hbWVcIiBjbGFzcz1cImN1c3RvbS1zZWxlY3RcIiBAY2hhbmdlPVwic2VsZWN0QXR0cmlidXRlKGF0dHJpYnV0ZS5hdHRyaWJ1dGVJZCwgJGV2ZW50LnRhcmdldC52YWx1ZSlcIiBkYXRhLXRlc3Rpbmc9XCJ2YXJpYXRpb24tc2VsZWN0LWRyb3Bkb3duXCI+XG4gICAgICAgICAgICAgICAgICAgICAgICA8b3B0aW9uIDp2YWx1ZT1cIi0xXCIgdi1pZj1cImFkZFBsZWFzZVNlbGVjdE9wdGlvbiB8fCAhaGFzU2VsZWN0aW9uXCI+e3sgJHRyYW5zbGF0ZShcIkNlcmVzOjpUZW1wbGF0ZS5zaW5nbGVJdGVtUGxlYXNlU2VsZWN0XCIpIH19PC9vcHRpb24+XG4gICAgICAgICAgICAgICAgICAgICAgICA8b3B0aW9uXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDp2YWx1ZT1cIm51bGxcIiB2LWlmPVwiaGFzRW1wdHlPcHRpb24gfHwgc2VsZWN0ZWRBdHRyaWJ1dGVzW2F0dHJpYnV0ZS5hdHRyaWJ1dGVJZF0gPT09IG51bGxcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA6c2VsZWN0ZWQ9XCJzZWxlY3RlZEF0dHJpYnV0ZXNbYXR0cmlidXRlLmF0dHJpYnV0ZUlkXSA9PT0gbnVsbFwiPnt7ICR0cmFuc2xhdGUoXCJDZXJlczo6VGVtcGxhdGUuc2luZ2xlSXRlbU5vU2VsZWN0aW9uXCIpIH19PC9vcHRpb24+XG4gICAgICAgICAgICAgICAgICAgICAgICA8b3B0aW9uXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHYtZm9yPVwidmFsdWUgaW4gYXR0cmlidXRlLnZhbHVlc1wiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDp2YWx1ZT1cInZhbHVlLmF0dHJpYnV0ZVZhbHVlSWRcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA6c2VsZWN0ZWQ9XCJ2YWx1ZS5hdHRyaWJ1dGVWYWx1ZUlkID09PSBzZWxlY3RlZEF0dHJpYnV0ZXNbYXR0cmlidXRlLmF0dHJpYnV0ZUlkXVwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDprZXk9XCJ2YWx1ZS5hdHRyaWJ1dGVWYWx1ZUlkXCI+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPHRlbXBsYXRlIHYtaWY9XCJpc0F0dHJpYnV0ZVNlbGVjdGlvblZhbGlkKGF0dHJpYnV0ZS5hdHRyaWJ1dGVJZCwgdmFsdWUuYXR0cmlidXRlVmFsdWVJZCwgdHJ1ZSlcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAge3sgdmFsdWUubmFtZSB9fVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvdGVtcGxhdGU+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPHRlbXBsYXRlIHYtZWxzZS1pZj1cImlzQXR0cmlidXRlU2VsZWN0aW9uVmFsaWQoYXR0cmlidXRlLmF0dHJpYnV0ZUlkLCB2YWx1ZS5hdHRyaWJ1dGVWYWx1ZUlkLCBmYWxzZSlcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAge3sgJHRyYW5zbGF0ZShcIkNlcmVzOjpUZW1wbGF0ZS5zaW5nbGVJdGVtTm90U2FsYWJsZUF0dHJpYnV0ZVwiLCB7IFwibmFtZVwiOiB2YWx1ZS5uYW1lIH0pIH19XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPC90ZW1wbGF0ZT5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8dGVtcGxhdGUgdi1lbHNlPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7eyAkdHJhbnNsYXRlKFwiQ2VyZXM6OlRlbXBsYXRlLnNpbmdsZUl0ZW1JbnZhbGlkQXR0cmlidXRlXCIsIHsgXCJuYW1lXCI6IHZhbHVlLm5hbWUgfSkgfX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L3RlbXBsYXRlPlxuICAgICAgICAgICAgICAgICAgICAgICAgPC9vcHRpb24+XG4gICAgICAgICAgICAgICAgICAgIDwvc2VsZWN0PlxuICAgICAgICAgICAgICAgICAgICA8bGFiZWwgOmZvcj1cIidjdXN0b20tc2VsZWN0XycgKyBhdHRyaWJ1dGUubmFtZVwiIHYtdG9vbHRpcD1cImlzVGV4dEN1dChhdHRyaWJ1dGUubmFtZSlcIiBkYXRhLXRvZ2dsZT1cInRvb2x0aXBcIiBkYXRhLXBsYWNlbWVudD1cInRvcFwiIDp0aXRsZT1cImF0dHJpYnV0ZS5uYW1lXCIgZGF0YS10ZXN0aW5nPVwidmFyaWF0aW9uLXNlbGVjdC1kcm9wZG93bi1sYWJlbFwiPnt7IGF0dHJpYnV0ZS5uYW1lIH19PC9sYWJlbD5cbiAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICA8IS0tIC9kcm9wZG93biAtLT5cblxuICAgICAgICAgICAgICAgIDwhLS0gYm94IGFuZCBpbWFnZSAtLT5cbiAgICAgICAgICAgICAgICA8ZGl2IHYtZWxzZS1pZj1cImF0dHJpYnV0ZS50eXBlID09PSAnYm94JyB8fCBhdHRyaWJ1dGUudHlwZSA9PT0gJ2ltYWdlJ1wiPlxuICAgICAgICAgICAgICAgICAgICA8c3BhbiBjbGFzcz1cInRleHQtbXV0ZWRcIiBkYXRhLXRlc3Rpbmc9XCJhdHRyaWJ1dGUtbmFtZVwiPnt7IGF0dHJpYnV0ZS5uYW1lIH19Ojwvc3Bhbj4gPGIgZGF0YS10ZXN0aW5nPVwiYXR0cmlidXRlLXZhbHVlXCI+e3sgZ2V0U2VsZWN0ZWRBdHRyaWJ1dGVWYWx1ZU5hbWUoYXR0cmlidXRlKSB9fTwvYj5cbiAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cInYtcy1ib3hlcyBweS0zXCIgOmNsYXNzPVwieyAnaW1hZ2VzJzogYXR0cmlidXRlLnR5cGUgPT09ICdpbWFnZScgfVwiPlxuICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cInYtcy1ib3ggYmctd2hpdGUgZW1wdHktb3B0aW9uXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGF0YS10ZXN0aW5nPVwidmFyaWF0aW9uLXNlbGVjdC1ib3hcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2LWlmPVwiYWRkUGxlYXNlU2VsZWN0T3B0aW9uXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgQGNsaWNrPVwic2VsZWN0QXR0cmlidXRlKGF0dHJpYnV0ZS5hdHRyaWJ1dGVJZCwgLTEpXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgOmNsYXNzPVwieyAnYWN0aXZlJzogc2VsZWN0ZWRBdHRyaWJ1dGVzW2F0dHJpYnV0ZS5hdHRyaWJ1dGVJZF0gPT09IC0xLCAnaW52YWxpZCc6ICFpc0F0dHJpYnV0ZVNlbGVjdGlvblZhbGlkKGF0dHJpYnV0ZS5hdHRyaWJ1dGVJZCwgLTEpIH1cIj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8c3BhbiBjbGFzcz1cIm14LTNcIj57eyAkdHJhbnNsYXRlKFwiQ2VyZXM6OlRlbXBsYXRlLnNpbmdsZUl0ZW1QbGVhc2VTZWxlY3RcIikgfX08L3NwYW4+XG4gICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJ2LXMtYm94IGJnLXdoaXRlIGVtcHR5LW9wdGlvblwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhdGEtdGVzdGluZz1cInZhcmlhdGlvbi1zZWxlY3QtYm94XCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdi1pZj1cImhhc0VtcHR5T3B0aW9uXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgQGNsaWNrPVwic2VsZWN0QXR0cmlidXRlKGF0dHJpYnV0ZS5hdHRyaWJ1dGVJZCwgbnVsbClcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICA6Y2xhc3M9XCJ7ICdhY3RpdmUnOiBzZWxlY3RlZEF0dHJpYnV0ZXNbYXR0cmlidXRlLmF0dHJpYnV0ZUlkXSA9PT0gbnVsbCwgJ2ludmFsaWQnOiAhaXNBdHRyaWJ1dGVTZWxlY3Rpb25WYWxpZChhdHRyaWJ1dGUuYXR0cmlidXRlSWQsIG51bGwsIHRydWUpIH1cIj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8c3BhbiBjbGFzcz1cIm14LTNcIj57eyAkdHJhbnNsYXRlKFwiQ2VyZXM6OlRlbXBsYXRlLnNpbmdsZUl0ZW1Ob1NlbGVjdGlvblwiKSB9fTwvc3Bhbj5cbiAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuXG4gICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVwidi1zLWJveCBiZy13aGl0ZVwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhdGEtdGVzdGluZz1cInZhcmlhdGlvbi1zZWxlY3QtYm94XCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdi1mb3I9XCJ2YWx1ZSBpbiBhdHRyaWJ1dGUudmFsdWVzXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgQGNsaWNrPVwic2VsZWN0QXR0cmlidXRlKGF0dHJpYnV0ZS5hdHRyaWJ1dGVJZCwgdmFsdWUuYXR0cmlidXRlVmFsdWVJZClcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICA6Y2xhc3M9XCJ7ICdhY3RpdmUnOiB2YWx1ZS5hdHRyaWJ1dGVWYWx1ZUlkID09PSBzZWxlY3RlZEF0dHJpYnV0ZXNbYXR0cmlidXRlLmF0dHJpYnV0ZUlkXSwgJ2ludmFsaWQnOiAhaXNBdHRyaWJ1dGVTZWxlY3Rpb25WYWxpZChhdHRyaWJ1dGUuYXR0cmlidXRlSWQsIHZhbHVlLmF0dHJpYnV0ZVZhbHVlSWQsIHRydWUpIH1cIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2LXRvb2x0aXA9XCJ0cnVlXCIgZGF0YS1odG1sPVwidHJ1ZVwiIGRhdGEtdG9nZ2xlPVwidG9vbHRpcFwiIGRhdGEtcGxhY2VtZW50PVwidG9wXCIgOmRhdGEtb3JpZ2luYWwtdGl0bGU9XCJnZXRUb29sdGlwKGF0dHJpYnV0ZSwgdmFsdWUpXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgOmtleT1cInZhbHVlLmF0dHJpYnV0ZVZhbHVlSWRcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8c3BhbiBjbGFzcz1cIm14LTNcIiB2LWlmPVwiYXR0cmlidXRlLnR5cGUgPT09ICdib3gnXCI+e3sgdmFsdWUubmFtZSB9fTwvc3Bhbj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8aW1nIGNsYXNzPVwicC0xXCIgdi1lbHNlIDpzcmM9XCJ2YWx1ZS5pbWFnZVVybFwiIDphbHQ9XCJ2YWx1ZS5uYW1lXCI+XG4gICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgPCEtLSAvYm94IGFuZCBpbWFnZSAtLT5cbiAgICAgICAgICAgIDwvZGl2PlxuXG4gICAgICAgICAgICA8IS0tIHVuaXRzIC0tPlxuICAgICAgICAgICAgPGRpdiBjbGFzcz1cImNvbC0xMiB2YXJpYXRpb24tc2VsZWN0XCIgdi1pZj1cInBvc3NpYmxlVW5pdENvbWJpbmF0aW9uSWRzLmxlbmd0aCA+IDEgJiYgaXNDb250ZW50VmlzaWJsZVwiPlxuICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJpbnB1dC11bml0XCI+XG4gICAgICAgICAgICAgICAgICAgIDxzZWxlY3QgaWQ9XCJ1bml0LWNvbWJpbmF0aW9uLWlkcy1zZWxlY3RcIiBjbGFzcz1cImN1c3RvbS1zZWxlY3RcIiBAY2hhbmdlPVwic2VsZWN0VW5pdCgkZXZlbnQudGFyZ2V0LnZhbHVlKVwiIGRhdGEtdGVzdGluZz1cInZhcmlhdGlvbi1zZWxlY3QtdW5pdFwiPlxuICAgICAgICAgICAgICAgICAgICAgICAgPG9wdGlvblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2LWZvcj1cInVuaXRDb21iaW5hdGlvbklkIGluIHBvc3NpYmxlVW5pdENvbWJpbmF0aW9uSWRzXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgOnZhbHVlPVwidW5pdENvbWJpbmF0aW9uSWRcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA6c2VsZWN0ZWQ9XCJwYXJzZUludCh1bml0Q29tYmluYXRpb25JZCkgPT09IHNlbGVjdGVkVW5pdFwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDprZXk9XCJ1bml0Q29tYmluYXRpb25JZFwiPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDx0ZW1wbGF0ZSB2LWlmPVwiaXNVbml0U2VsZWN0aW9uVmFsaWQodW5pdENvbWJpbmF0aW9uSWQpXCI+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHt7IHBvc3NpYmxlVW5pdHNbdW5pdENvbWJpbmF0aW9uSWRdIH19XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPC90ZW1wbGF0ZT5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8dGVtcGxhdGUgdi1lbHNlPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7eyAkdHJhbnNsYXRlKFwiQ2VyZXM6OlRlbXBsYXRlLnNpbmdsZUl0ZW1JbnZhbGlkQXR0cmlidXRlXCIsIHsgXCJuYW1lXCI6IHBvc3NpYmxlVW5pdHNbdW5pdENvbWJpbmF0aW9uSWRdIH0pIH19XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPC90ZW1wbGF0ZT5cbiAgICAgICAgICAgICAgICAgICAgICAgIDwvb3B0aW9uPlxuICAgICAgICAgICAgICAgICAgICA8L3NlbGVjdD5cbiAgICAgICAgICAgICAgICAgICAgPGxhYmVsIGZvcj1cInVuaXQtY29tYmluYXRpb24taWRzLXNlbGVjdFwiIGRhdGEtdGVzdGluZz1cInZhcmlhdGlvbi1zZWxlY3QtdW5pdC1sYWJlbFwiPnt7ICR0cmFuc2xhdGUoXCJDZXJlczo6VGVtcGxhdGUuc2luZ2xlSXRlbUNvbnRlbnRcIikgfX08L2xhYmVsPlxuICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICA8IS0tIC91bml0cyAtLT5cbiAgICAgICAgPC90ZW1wbGF0ZT5cblxuICAgICAgICA8dGVtcGxhdGUgdi1lbHNlPlxuICAgICAgICAgICAgPHNsb3Q+PC9zbG90PlxuICAgICAgICA8L3RlbXBsYXRlPlxuICAgIDwvZGl2PlxuPC90ZW1wbGF0ZT5cblxuPHNjcmlwdD5cbmltcG9ydCB7IHRleHRXaWR0aCB9IGZyb20gXCIuLi8uLi9oZWxwZXIvZG9tXCI7XG5pbXBvcnQgeyBpc0RlZmluZWQsIGlzTnVsbCwgaXNOdWxsT3JVbmRlZmluZWQgfSBmcm9tIFwiLi4vLi4vaGVscGVyL3V0aWxzXCI7XG5cbmNvbnN0IE5vdGlmaWNhdGlvblNlcnZpY2UgPSByZXF1aXJlKFwiLi4vLi4vc2VydmljZXMvTm90aWZpY2F0aW9uU2VydmljZVwiKTtcblxuZXhwb3J0IGRlZmF1bHQge1xuXG4gICAgbmFtZTogXCJ2YXJpYXRpb24tc2VsZWN0XCIsXG5cbiAgICBwcm9wczoge1xuICAgICAgICBmb3JjZUNvbnRlbnQ6XG4gICAgICAgIHtcbiAgICAgICAgICAgIHR5cGU6IEJvb2xlYW4sXG4gICAgICAgICAgICBkZWZhdWx0OiBmYWxzZVxuICAgICAgICB9XG4gICAgfSxcblxuICAgIGluamVjdDoge1xuICAgICAgICBpdGVtSWQ6IHtcbiAgICAgICAgICAgIGRlZmF1bHQ6IG51bGxcbiAgICAgICAgfVxuICAgIH0sXG5cbiAgICBkYXRhKClcbiAgICB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBmaWx0ZXJlZFZhcmlhdGlvbnNDYWNoZToge30sXG4gICAgICAgICAgICBsYXN0Q29udGVudENvdW50OiAwXG4gICAgICAgIH07XG4gICAgfSxcblxuICAgIG1vdW50ZWQoKVxuICAgIHtcbiAgICAgICAgLy8gaW5pdGlhbGx5IGNoZWNrIGZvciB2YWxpZCBzZWxlY3Rpb24gYW5kIGRpc2FibGUgYWRkIHRvIGJhc2tldCBidXR0b25cbiAgICAgICAgdGhpcy4kc3RvcmUuY29tbWl0KGAke3RoaXMuaXRlbUlkfS92YXJpYXRpb25TZWxlY3Qvc2V0SXNWYXJpYXRpb25TZWxlY3RlZGAsICEhdGhpcy5jdXJyZW50U2VsZWN0aW9uKTtcbiAgICB9LFxuXG4gICAgY29tcHV0ZWQ6XG4gICAge1xuICAgICAgICBjdXJyZW50VmFyaWF0aW9uKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuJHN0b3JlLmdldHRlcnNbYCR7dGhpcy5pdGVtSWR9L2N1cnJlbnRJdGVtVmFyaWF0aW9uYF07XG4gICAgICAgIH0sXG5cbiAgICAgICAgY3VycmVudFZhcmlhdGlvblNlbGVjdCgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLiRzdG9yZS5zdGF0ZS5pdGVtc1t0aGlzLml0ZW1JZF0gJiYgdGhpcy4kc3RvcmUuc3RhdGUuaXRlbXNbdGhpcy5pdGVtSWRdLnZhcmlhdGlvblNlbGVjdDtcbiAgICAgICAgfSxcblxuICAgICAgICAvKipcbiAgICAgICAgICogcmV0dXJucyB0cnVlIGlmIGFueSB2YXJpYXRpb24gaGFzIG5vIGF0dHJpYnV0ZXNcbiAgICAgICAgICovXG4gICAgICAgIGhhc0VtcHR5T3B0aW9uKClcbiAgICAgICAge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMudmFyaWF0aW9ucy5zb21lKHZhcmlhdGlvbiA9PiAhdmFyaWF0aW9uLmF0dHJpYnV0ZXMubGVuZ3RoKTtcbiAgICAgICAgfSxcblxuICAgICAgICBhZGRQbGVhc2VTZWxlY3RPcHRpb24oKVxuICAgICAgICB7XG4gICAgICAgICAgICByZXR1cm4gQXBwLmNvbmZpZy5pdGVtLnNob3dQbGVhc2VTZWxlY3Q7XG4gICAgICAgIH0sXG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIHJldHVybnMgdGhlIHZhcmlhdGlvbiwgYmFzZWQgb24gdGhlIHNlbGVjdGVkIGF0dHJpYnV0ZXMgLyB1bml0XG4gICAgICAgICAqIHJldHVybnMgZmFsc2UgaWYgdGhlcmUgYXJlIG5vbmUgb3IgbXVsdGlwbGUgcmVzdWx0c1xuICAgICAgICAgKi9cbiAgICAgICAgY3VycmVudFNlbGVjdGlvbigpXG4gICAgICAgIHtcbiAgICAgICAgICAgIGNvbnN0IGZpbHRlcmVkVmFyaWF0aW9ucyA9IHRoaXMuZmlsdGVyVmFyaWF0aW9ucyhudWxsLCBudWxsLCB0cnVlKTtcblxuICAgICAgICAgICAgaWYgKGZpbHRlcmVkVmFyaWF0aW9ucy5sZW5ndGggPT09IDEpXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZpbHRlcmVkVmFyaWF0aW9uc1swXTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9LFxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiByZXR1cm5zIGFsbCB1bml0cywgc2VsZWN0YWJsZSBieSBjdXJyZW50IHNlbGVjdGlvblxuICAgICAgICAgKiBwcm9wICdmb3JjZUNvbnRlbnQnIHdpdGggdmFsdWUgdHJ1ZSB3aWxsIHJldHVybiBhbGwgdW5pdHMsIHdpdGhvdXQgZmlsdGVyaW5nXG4gICAgICAgICAqL1xuICAgICAgICBwb3NzaWJsZVVuaXRzKClcbiAgICAgICAge1xuICAgICAgICAgICAgLy8gdXNlIGFuIG9iamVjdCwgdG8gbWFrZSB0aGUgZW50cmllcyB1bmlxdWVcbiAgICAgICAgICAgIGNvbnN0IHBvc3NpYmxlVW5pdHMgPSB7fTtcbiAgICAgICAgICAgIGNvbnN0IHZhcmlhdGlvbnMgPSB0aGlzLmZvcmNlQ29udGVudCA/IHRoaXMudmFyaWF0aW9ucyA6IHRoaXMuZmlsdGVyVmFyaWF0aW9ucyhudWxsLCBudWxsLCBudWxsLCB0cnVlKTtcblxuICAgICAgICAgICAgZm9yIChjb25zdCB2YXJpYXRpb24gb2YgdmFyaWF0aW9ucylcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBwb3NzaWJsZVVuaXRzW3ZhcmlhdGlvbi51bml0Q29tYmluYXRpb25JZF0gPSB2YXJpYXRpb24udW5pdE5hbWU7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHJldHVybiBwb3NzaWJsZVVuaXRzO1xuICAgICAgICB9LFxuXG4gICAgICAgIHBvc3NpYmxlVW5pdENvbWJpbmF0aW9uSWRzKClcbiAgICAgICAge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMudHJhbnNmb3JtUG9zc2libGVVbml0cyh0aGlzLnBvc3NpYmxlVW5pdHMpLm1hcCh2YWx1ZSA9PiB2YWx1ZVswXSk7XG4gICAgICAgIH0sXG5cbiAgICAgICAgaXNDb250ZW50VmlzaWJsZSgpXG4gICAgICAgIHtcbiAgICAgICAgICAgIHJldHVybiAhdGhpcy5mb3JjZUNvbnRlbnQgJiYgISF0aGlzLmN1cnJlbnRTZWxlY3Rpb24gfHwgdGhpcy5mb3JjZUNvbnRlbnQ7XG4gICAgICAgIH0sXG5cbiAgICAgICAgaGFzU2VsZWN0aW9uKClcbiAgICAgICAge1xuICAgICAgICAgICAgcmV0dXJuICFpc051bGxPclVuZGVmaW5lZCh0aGlzLnNlbGVjdGVkQXR0cmlidXRlcykgJiYgIU9iamVjdC52YWx1ZXModGhpcy5zZWxlY3RlZEF0dHJpYnV0ZXMpLnNvbWUoKHZhbHVlKSA9PiB2YWx1ZSA8IDApO1xuICAgICAgICB9LFxuXG4gICAgICAgIGF0dHJpYnV0ZXMoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5jdXJyZW50VmFyaWF0aW9uU2VsZWN0ICYmIHRoaXMuY3VycmVudFZhcmlhdGlvblNlbGVjdC5hdHRyaWJ1dGVzO1xuICAgICAgICB9LFxuXG4gICAgICAgIHNlbGVjdGVkQXR0cmlidXRlcygpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmN1cnJlbnRWYXJpYXRpb25TZWxlY3QgJiYgdGhpcy5jdXJyZW50VmFyaWF0aW9uU2VsZWN0LnNlbGVjdGVkQXR0cmlidXRlcztcbiAgICAgICAgfSxcblxuICAgICAgICBzZWxlY3RlZFVuaXQoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5jdXJyZW50VmFyaWF0aW9uU2VsZWN0ICYmIHRoaXMuY3VycmVudFZhcmlhdGlvblNlbGVjdC5zZWxlY3RlZFVuaXQ7XG4gICAgICAgIH0sXG5cbiAgICAgICAgdmFyaWF0aW9ucygpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmN1cnJlbnRWYXJpYXRpb25TZWxlY3QgJiYgdGhpcy5jdXJyZW50VmFyaWF0aW9uU2VsZWN0LnZhcmlhdGlvbnM7XG4gICAgICAgIH1cbiAgICB9LFxuXG4gICAgbWV0aG9kczpcbiAgICB7XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBzZWxlY3QgYW4gYXR0cmlidXRlIGFuZCBjaGVjaywgaWYgdGhlIHNlbGVjdGlvbiBpcyB2YWxpZDsgaWYgbm90LCB1bnNldEludmFsaWRTZWxlY3Rpb24gd2lsbCBiZSBleGVjdXRlZFxuICAgICAgICAgKiBAcGFyYW0ge251bWJlcn0gYXR0cmlidXRlSWRcbiAgICAgICAgICogQHBhcmFtIHtbbnVtYmVyLCBzdHJpbmcsIG51bGxdfSBhdHRyaWJ1dGVWYWx1ZUlkXG4gICAgICAgICAqL1xuICAgICAgICBzZWxlY3RBdHRyaWJ1dGUoYXR0cmlidXRlSWQsIGF0dHJpYnV0ZVZhbHVlSWQpXG4gICAgICAgIHtcbiAgICAgICAgICAgIGF0dHJpYnV0ZVZhbHVlSWQgPSBwYXJzZUludChhdHRyaWJ1dGVWYWx1ZUlkKSB8fCBudWxsO1xuXG4gICAgICAgICAgICBpZiAodGhpcy5zZWxlY3RlZEF0dHJpYnV0ZXNbYXR0cmlidXRlSWRdICE9PSBhdHRyaWJ1dGVWYWx1ZUlkKVxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIHRoaXMuJHN0b3JlLmNvbW1pdChgJHt0aGlzLml0ZW1JZH0vdmFyaWF0aW9uU2VsZWN0L3NlbGVjdEl0ZW1BdHRyaWJ1dGVgLCB7IGF0dHJpYnV0ZUlkLCBhdHRyaWJ1dGVWYWx1ZUlkIH0pO1xuICAgICAgICAgICAgICAgIHRoaXMub25TZWxlY3Rpb25DaGFuZ2UoYXR0cmlidXRlSWQsIGF0dHJpYnV0ZVZhbHVlSWQsIG51bGwpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBzZWxlY3QgYSB1bml0IGFuZCBjaGVjaywgaWYgdGhlIHNlbGVjdGlvbiBpcyB2YWxpZDsgaWYgbm90LCB1bnNldEludmFsaWRTZWxlY3Rpb24gd2lsbCBiZSBleGVjdXRlZFxuICAgICAgICAgKiBAcGFyYW0ge1tudW1iZXIsIHN0cmluZ119IHVuaXRJZFxuICAgICAgICAgKi9cbiAgICAgICAgc2VsZWN0VW5pdCh1bml0SWQpXG4gICAgICAgIHtcbiAgICAgICAgICAgIHVuaXRJZCA9IHBhcnNlSW50KHVuaXRJZCk7XG4gICAgICAgICAgICB0aGlzLiRzdG9yZS5jb21taXQoYCR7dGhpcy5pdGVtSWR9L3ZhcmlhdGlvblNlbGVjdC9zZWxlY3RJdGVtVW5pdGAsIHVuaXRJZCk7XG4gICAgICAgICAgICB0aGlzLm9uU2VsZWN0aW9uQ2hhbmdlKG51bGwsIG51bGwsIHVuaXRJZCk7XG4gICAgICAgIH0sXG5cbiAgICAgICAgb25TZWxlY3Rpb25DaGFuZ2UoYXR0cmlidXRlSWQsIGF0dHJpYnV0ZVZhbHVlSWQsIHVuaXRJZClcbiAgICAgICAge1xuICAgICAgICAgICAgaWYgKHRoaXMuY3VycmVudFNlbGVjdGlvbilcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICB0aGlzLnNldFZhcmlhdGlvbih0aGlzLmN1cnJlbnRTZWxlY3Rpb24udmFyaWF0aW9uSWQpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAoIXRoaXMuaGFzU2VsZWN0aW9uKVxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIC8vIHVzZXIgc3dpdGNoZWQgYmFjayB0byBcInBsZWFzZSBzZWxlY3RcIlxuICAgICAgICAgICAgICAgIHRoaXMuc2V0VmFyaWF0aW9uKDApO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZVxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIHRoaXMudW5zZXRJbnZhbGlkU2VsZWN0aW9uKGF0dHJpYnV0ZUlkLCBhdHRyaWJ1dGVWYWx1ZUlkLCB1bml0SWQpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB0aGlzLmxhc3RDb250ZW50Q291bnQgPSB0aGlzLnBvc3NpYmxlVW5pdENvbWJpbmF0aW9uSWRzLmxlbmd0aDtcbiAgICAgICAgfSxcblxuICAgICAgICAvKipcbiAgICAgICAgICogY2hhbmdlcyB0aGUgc2VsZWN0ZWQgYXR0cmlidXRlcyAvIHVuaXQsIHRvIGVuc3VyZSBhIHZhbGlkIHNlZWxjdGlvblxuICAgICAgICAgKiBAcGFyYW0ge1tudW1iZXIsIG51bGxdfSBhdHRyaWJ1dGVJZFxuICAgICAgICAgKiBAcGFyYW0ge1tudW1iZXIsIG51bGxdfSBhdHRyaWJ1dGVWYWx1ZUlkXG4gICAgICAgICAqIEBwYXJhbSB7W251bWJlciwgbnVsbF19IHVuaXRJZFxuICAgICAgICAgKi9cbiAgICAgICAgdW5zZXRJbnZhbGlkU2VsZWN0aW9uKGF0dHJpYnV0ZUlkLCBhdHRyaWJ1dGVWYWx1ZUlkLCB1bml0SWQpXG4gICAgICAgIHtcbiAgICAgICAgICAgIGNvbnN0IHF1YWxpZmllZFZhcmlhdGlvbnMgPSB0aGlzLmdldFF1YWxpZmllZFZhcmlhdGlvbnMoYXR0cmlidXRlSWQsIGF0dHJpYnV0ZVZhbHVlSWQsIHVuaXRJZCk7XG4gICAgICAgICAgICBjb25zdCBjbG9zZXN0VmFyaWF0aW9ucyA9IHRoaXMuZ2V0Q2xvc2VzdFZhcmlhdGlvbnMocXVhbGlmaWVkVmFyaWF0aW9ucyk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8vIGlmIHRoZSBzYWxhYmxlICdjbG9zZXN0VmFyaWF0aW9ucycgaXMgdW5kZWZpbmVkLCB0YWtlIHRoZSBub3Qtc2FsYWJsZSBvbmVcbiAgICAgICAgICAgIGNvbnN0IGNsb3Nlc3RWYXJpYXRpb24gPSBjbG9zZXN0VmFyaWF0aW9uc1swXSB8fCBjbG9zZXN0VmFyaWF0aW9uc1sxXTtcblxuICAgICAgICAgICAgaWYgKCFjbG9zZXN0VmFyaWF0aW9uKVxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgY29uc3QgaW52YWxpZFNlbGVjdGlvbiA9IHRoaXMuZ2V0SW52YWxpZFNlbGVjdGlvbkJ5VmFyaWF0aW9uKGNsb3Nlc3RWYXJpYXRpb24pO1xuXG4gICAgICAgICAgICB0aGlzLmNvcnJlY3RTZWxlY3Rpb24oaW52YWxpZFNlbGVjdGlvbik7XG4gICAgICAgIH0sXG5cbiAgICAgICAgZ2V0VG9vbHRpcChhdHRyaWJ1dGUsIGF0dHJpYnV0ZVZhbHVlKVxuICAgICAgICB7XG4gICAgICAgICAgICBpZighdGhpcy5pc0F0dHJpYnV0ZVNlbGVjdGlvblZhbGlkKGF0dHJpYnV0ZS5hdHRyaWJ1dGVJZCwgYXR0cmlidXRlVmFsdWUuYXR0cmlidXRlVmFsdWVJZCwgdHJ1ZSkpXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuZ2V0SW52YWxpZE9wdGlvblRvb2x0aXAoYXR0cmlidXRlLmF0dHJpYnV0ZUlkLCBhdHRyaWJ1dGVWYWx1ZS5hdHRyaWJ1dGVWYWx1ZUlkKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYoYXR0cmlidXRlLnR5cGUgPT09IFwiaW1hZ2VcIilcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy4kdHJhbnNsYXRlKFwiQ2VyZXM6OlRlbXBsYXRlLnNpbmdsZUl0ZW1BdHRyaWJ1dGVUb29sdGlwXCIsIHtcbiAgICAgICAgICAgICAgICAgICAgYXR0cmlidXRlOiBhdHRyaWJ1dGUubmFtZSxcbiAgICAgICAgICAgICAgICAgICAgdmFsdWU6IGF0dHJpYnV0ZVZhbHVlLm5hbWVcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgcmV0dXJuIFwiXCI7XG4gICAgICAgIH0sXG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIHJldHVybnMgYSBzdHJpbmcgZm9yIGJveCB0b29sdGlwcywgZm9yIG5vdCBhdmFpbGFibGUgb3B0aW9uc1xuICAgICAgICAgKiBAcGFyYW0ge251bWJlcn0gYXR0cmlidXRlSWRcbiAgICAgICAgICogQHBhcmFtIHtudW1iZXJ9IGF0dHJpYnV0ZVZhbHVlSWRcbiAgICAgICAgICovXG4gICAgICAgIGdldEludmFsaWRPcHRpb25Ub29sdGlwKGF0dHJpYnV0ZUlkLCBhdHRyaWJ1dGVWYWx1ZUlkKVxuICAgICAgICB7XG4gICAgICAgICAgICBjb25zdCBxdWFsaWZpZWRWYXJpYXRpb25zID0gdGhpcy5nZXRRdWFsaWZpZWRWYXJpYXRpb25zKGF0dHJpYnV0ZUlkLCBhdHRyaWJ1dGVWYWx1ZUlkKTtcbiAgICAgICAgICAgIGNvbnN0IGNsb3Nlc3RWYXJpYXRpb25zICAgPSB0aGlzLmdldENsb3Nlc3RWYXJpYXRpb25zKHF1YWxpZmllZFZhcmlhdGlvbnMpO1xuXG4gICAgICAgICAgICBpZiAoIWNsb3Nlc3RWYXJpYXRpb25zIHx8IGNsb3Nlc3RWYXJpYXRpb25zLmxlbmd0aCA8PSAwKVxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIHJldHVybiBcIlwiO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBjb25zdCBpbnZhbGlkU2VsZWN0aW9ucyA9IFtcbiAgICAgICAgICAgICAgICAhIWNsb3Nlc3RWYXJpYXRpb25zWzBdID8gdGhpcy5nZXRJbnZhbGlkU2VsZWN0aW9uQnlWYXJpYXRpb24oY2xvc2VzdFZhcmlhdGlvbnNbMF0pIDogbnVsbCxcbiAgICAgICAgICAgICAgICAhIWNsb3Nlc3RWYXJpYXRpb25zWzFdID8gdGhpcy5nZXRJbnZhbGlkU2VsZWN0aW9uQnlWYXJpYXRpb24oY2xvc2VzdFZhcmlhdGlvbnNbMV0pIDogbnVsbFxuICAgICAgICAgICAgXTtcblxuICAgICAgICAgICAgaWYgKCEhaW52YWxpZFNlbGVjdGlvbnNbMF1cbiAgICAgICAgICAgICAgICAmJiAhIWludmFsaWRTZWxlY3Rpb25zWzFdXG4gICAgICAgICAgICAgICAgJiYgaW52YWxpZFNlbGVjdGlvbnNbMF0uYXR0cmlidXRlc1RvUmVzZXQubGVuZ3RoID4gaW52YWxpZFNlbGVjdGlvbnNbMV0uYXR0cmlidXRlc1RvUmVzZXQubGVuZ3RoKVxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIC8vIHRoZXJlIGlzIGEgbm9uLXNhbGFibGUgdmFyaWF0aW9uIHdpdGggbGVzcyBjaGFuZ2VzXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuJHRyYW5zbGF0ZShcIkNlcmVzOjpUZW1wbGF0ZS5zaW5nbGVJdGVtTm90U2FsYWJsZVwiKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgY29uc3QgaW52YWxpZFNlbGVjdGlvbiA9IGludmFsaWRTZWxlY3Rpb25zWzBdIHx8IGludmFsaWRTZWxlY3Rpb25zWzFdO1xuICAgICAgICAgICAgY29uc3QgbmFtZXMgPSBbXTtcblxuICAgICAgICAgICAgZm9yIChjb25zdCBhdHRyaWJ1dGUgb2YgaW52YWxpZFNlbGVjdGlvbi5hdHRyaWJ1dGVzVG9SZXNldClcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBpZiAoYXR0cmlidXRlLmF0dHJpYnV0ZUlkICE9PSBhdHRyaWJ1dGVJZClcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgIG5hbWVzLnB1c2goXCI8Yj5cIiArIGF0dHJpYnV0ZS5uYW1lICtcIjwvYj5cIik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGludmFsaWRTZWxlY3Rpb24ubmV3VW5pdClcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBuYW1lcy5wdXNoKFxuICAgICAgICAgICAgICAgICAgICBcIjxiPlwiICsgdGhpcy4kdHJhbnNsYXRlKFwiQ2VyZXM6OlRlbXBsYXRlLnNpbmdsZUl0ZW1Db250ZW50XCIpICsgXCI8L2I+XCJcbiAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAoIW5hbWVzLmxlbmd0aClcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuJHRyYW5zbGF0ZShcIkNlcmVzOjpUZW1wbGF0ZS5zaW5nbGVJdGVtTm90QXZhaWxhYmxlSW5TZWxlY3Rpb25cIiwgeyBuYW1lOiBuYW1lcy5qb2luKFwiLCBcIikgfSk7XG4gICAgICAgIH0sXG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIHJldHVybnMgYSBsaXN0IG9mIHZhcmlhdGlvbnMsIGZpbHRlcmVkIGJ5IGF0dHJpYnV0ZSBvciB1bml0XG4gICAgICAgICAqIEBwYXJhbSB7W251bWJlciwgbnVsbF19IGF0dHJpYnV0ZUlkXG4gICAgICAgICAqIEBwYXJhbSB7W251bWJlciwgbnVsbF19IGF0dHJpYnV0ZVZhbHVlSWRcbiAgICAgICAgICogQHBhcmFtIHtbbnVtYmVyLCBudWxsXX0gdW5pdElkXG4gICAgICAgICAqL1xuICAgICAgICBnZXRRdWFsaWZpZWRWYXJpYXRpb25zKGF0dHJpYnV0ZUlkLCBhdHRyaWJ1dGVWYWx1ZUlkLCB1bml0SWQpXG4gICAgICAgIHtcbiAgICAgICAgICAgIGlmIChpc0RlZmluZWQoYXR0cmlidXRlVmFsdWVJZCkpXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMudmFyaWF0aW9ucy5maWx0ZXIodmFyaWF0aW9uID0+XG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gaXNEZWZpbmVkKHZhcmlhdGlvbi5hdHRyaWJ1dGVzLmZpbmQoYXR0cmlidXRlID0+XG4gICAgICAgICAgICAgICAgICAgICAgICBhdHRyaWJ1dGUuYXR0cmlidXRlSWQgPT09IGF0dHJpYnV0ZUlkICYmIGF0dHJpYnV0ZS5hdHRyaWJ1dGVWYWx1ZUlkID09PSBhdHRyaWJ1dGVWYWx1ZUlkKSk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmIChpc0RlZmluZWQodW5pdElkKSlcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy52YXJpYXRpb25zLmZpbHRlcih2YXJpYXRpb24gPT4gdmFyaWF0aW9uLnVuaXRDb21iaW5hdGlvbklkID09PSB1bml0SWQpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICByZXR1cm4gdGhpcy52YXJpYXRpb25zLmZpbHRlcih2YXJpYXRpb24gPT4gIXZhcmlhdGlvbi5hdHRyaWJ1dGVzLmxlbmd0aCk7XG4gICAgICAgIH0sXG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIHJldHVybiBhIHNhbGFibGUgYW5kIGEgbm9uLXNhbGFibGUgdmFyaWF0aW9uIHdpdGggdGhlIG1pbmltdW0gbnVtYmVyIG9mIGNoYW5nZXMgb24gYXR0cmlidXRlcyBjb21wYXJlZCB0byB0aGUgY3VycmVudCBzZWxlY3Rpb24uXG4gICAgICAgICAqIEBwYXJhbSB7YXJyYXl9IHF1YWxpZmllZFZhcmlhdGlvbnNcbiAgICAgICAgICovXG4gICAgICAgIGdldENsb3Nlc3RWYXJpYXRpb25zKHF1YWxpZmllZFZhcmlhdGlvbnMpXG4gICAgICAgIHtcbiAgICAgICAgICAgIGxldCBjbG9zZXN0U2FsYWJsZVZhcmlhdGlvbiwgbnVtYmVyT2ZTYWxhYmxlQ2hhbmdlcztcbiAgICAgICAgICAgIGxldCBjbG9zZXN0Tm9uU2FsYWJsZVZhcmlhdGlvbiwgbnVtYmVyT2ZOb25TYWxhYmxlQ2hhbmdlcztcblxuICAgICAgICAgICAgZm9yIChjb25zdCB2YXJpYXRpb24gb2YgcXVhbGlmaWVkVmFyaWF0aW9ucylcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBsZXQgY2hhbmdlcyA9IDA7XG5cbiAgICAgICAgICAgICAgICBpZiAodmFyaWF0aW9uLnVuaXRDb21iaW5hdGlvbklkICE9PSB0aGlzLnNlbGVjdGVkVW5pdCAmJiAhaXNOdWxsKHRoaXMuc2VsZWN0ZWRVbml0KSlcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgIC8vIHdoZW4gdGhlIHVuaXQgZHJvcGRvd24gaXNuJ3QgdmlzaWJsZSwgaXQgc2hvdWxkIGhhdmUgYSBsb3dlciB3ZWlnaHQgZm9yIHJlc2V0IGludmVzdGlnYXRpb25zXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHVuaXRXZWlnaHQgPSB0aGlzLnBvc3NpYmxlVW5pdENvbWJpbmF0aW9uSWRzLmxlbmd0aCA+IDEgJiYgdGhpcy5pc0NvbnRlbnRWaXNpYmxlID8gMC45IDogMC4xO1xuXG4gICAgICAgICAgICAgICAgICAgIGNoYW5nZXMgKz0gdW5pdFdlaWdodDtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IGF0dHJpYnV0ZSBvZiB2YXJpYXRpb24uYXR0cmlidXRlcylcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLnNlbGVjdGVkQXR0cmlidXRlc1thdHRyaWJ1dGUuYXR0cmlidXRlSWRdICE9PSBhdHRyaWJ1dGUuYXR0cmlidXRlVmFsdWVJZClcbiAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgY2hhbmdlcysrO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgaWYodmFyaWF0aW9uLmlzU2FsYWJsZSAmJiAoIW51bWJlck9mU2FsYWJsZUNoYW5nZXMgfHwgY2hhbmdlcyA8IG51bWJlck9mU2FsYWJsZUNoYW5nZXMpKVxuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgY2xvc2VzdFNhbGFibGVWYXJpYXRpb24gPSB2YXJpYXRpb247XG4gICAgICAgICAgICAgICAgICAgIG51bWJlck9mU2FsYWJsZUNoYW5nZXMgPSBjaGFuZ2VzO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIGlmICghdmFyaWF0aW9uLmlzU2FsYWJsZSAmJiAoIW51bWJlck9mTm9uU2FsYWJsZUNoYW5nZXMgfHwgY2hhbmdlcyA8IG51bWJlck9mTm9uU2FsYWJsZUNoYW5nZXMpKVxuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgY2xvc2VzdE5vblNhbGFibGVWYXJpYXRpb24gPSB2YXJpYXRpb247XG4gICAgICAgICAgICAgICAgICAgIG51bWJlck9mTm9uU2FsYWJsZUNoYW5nZXMgPSBjaGFuZ2VzO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgcmV0dXJuIFtjbG9zZXN0U2FsYWJsZVZhcmlhdGlvbiwgY2xvc2VzdE5vblNhbGFibGVWYXJpYXRpb25dO1xuICAgICAgICB9LFxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiByZXR1cm5zIG9iamVjdCB3aXRoIGFycmF5ICdhdHRyaWJ1dGVzVG9SZXNldCcgYW5kIG5ld1VuaXQuIFRoZSBhdHRyaWJ1dGVzVG9SZXNldCBjb250YWlucyBhbGwgYXR0cmlidXRlcywgd2hpY2ggYXJlIG5vdCBtYXRjaGluZyB3aXRoIHRoZSBnaXZlbiB2YXJpYXRpb25cbiAgICAgICAgICogQHBhcmFtIHtvYmplY3R9IHZhcmlhdGlvblxuICAgICAgICAgKi9cbiAgICAgICAgZ2V0SW52YWxpZFNlbGVjdGlvbkJ5VmFyaWF0aW9uKHZhcmlhdGlvbilcbiAgICAgICAge1xuICAgICAgICAgICAgY29uc3QgYXR0cmlidXRlc1RvUmVzZXQgPSBbXTtcbiAgICAgICAgICAgIGxldCBuZXdVbml0ID0gbnVsbDtcblxuICAgICAgICAgICAgZm9yIChsZXQgc2VsZWN0ZWRBdHRyaWJ1dGVJZCBpbiB0aGlzLnNlbGVjdGVkQXR0cmlidXRlcylcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBzZWxlY3RlZEF0dHJpYnV0ZUlkID0gcGFyc2VJbnQoc2VsZWN0ZWRBdHRyaWJ1dGVJZCk7XG4gICAgICAgICAgICAgICAgY29uc3QgdmFyaWF0aW9uQXR0cmlidXRlID0gdmFyaWF0aW9uLmF0dHJpYnV0ZXMuZmluZChhdHRyaWJ1dGUgPT4gYXR0cmlidXRlLmF0dHJpYnV0ZUlkID09PSBzZWxlY3RlZEF0dHJpYnV0ZUlkKTtcblxuICAgICAgICAgICAgICAgIGlmICghaXNOdWxsKHRoaXMuc2VsZWN0ZWRBdHRyaWJ1dGVzW3NlbGVjdGVkQXR0cmlidXRlSWRdKSlcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgIGlmICh2YXJpYXRpb25BdHRyaWJ1dGUgJiYgdmFyaWF0aW9uQXR0cmlidXRlLmF0dHJpYnV0ZVZhbHVlSWQgIT09IHRoaXMuc2VsZWN0ZWRBdHRyaWJ1dGVzW3NlbGVjdGVkQXR0cmlidXRlSWRdIHx8ICF2YXJpYXRpb25BdHRyaWJ1dGUpXG4gICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGF0dHJpYnV0ZVRvUmVzZXQgPSB0aGlzLmF0dHJpYnV0ZXMuZmluZChhdHRyID0+IGF0dHIuYXR0cmlidXRlSWQgPT09IHNlbGVjdGVkQXR0cmlidXRlSWQpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBhdHRyaWJ1dGVzVG9SZXNldC5wdXNoKGF0dHJpYnV0ZVRvUmVzZXQpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAodmFyaWF0aW9uLnVuaXRDb21iaW5hdGlvbklkICE9PSB0aGlzLnNlbGVjdGVkVW5pdClcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBuZXdVbml0ID0gdmFyaWF0aW9uLnVuaXRDb21iaW5hdGlvbklkO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICByZXR1cm4geyBhdHRyaWJ1dGVzVG9SZXNldCwgbmV3VW5pdCB9O1xuICAgICAgICB9LFxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiByZXNldHMgYWxsIGludmFsaWQgYXR0cmlidXRlcyBhbmQgY2hhbmdlIHRoZSB1bml0LCBpZiByZXF1aXJlZC4gUHJpbnRzIGEgbWVzc2FnZSB0byB0aGUgdXNlciBpZiBzby5cbiAgICAgICAgICogQHBhcmFtIHtvYmplY3R9IGludmFsaWRTZWxlY3Rpb25cbiAgICAgICAgICovXG4gICAgICAgIGNvcnJlY3RTZWxlY3Rpb24oaW52YWxpZFNlbGVjdGlvbilcbiAgICAgICAge1xuICAgICAgICAgICAgY29uc3QgbWVzc2FnZXMgICA9IFtdO1xuICAgICAgICAgICAgY29uc3QgYXR0cmlidXRlcyA9IEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkodGhpcy5zZWxlY3RlZEF0dHJpYnV0ZXMpKTtcblxuICAgICAgICAgICAgZm9yIChjb25zdCBhdHRyaWJ1dGVUb1Jlc2V0IG9mIGludmFsaWRTZWxlY3Rpb24uYXR0cmlidXRlc1RvUmVzZXQpXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgbWVzc2FnZXMucHVzaChcbiAgICAgICAgICAgICAgICAgICAgdGhpcy4kdHJhbnNsYXRlKFwiQ2VyZXM6OlRlbXBsYXRlLnNpbmdsZUl0ZW1Ob3RBdmFpbGFibGVcIiwgeyBuYW1lOiBhdHRyaWJ1dGVUb1Jlc2V0Lm5hbWUgfSlcbiAgICAgICAgICAgICAgICApO1xuXG4gICAgICAgICAgICAgICAgYXR0cmlidXRlc1thdHRyaWJ1dGVUb1Jlc2V0LmF0dHJpYnV0ZUlkXSA9ICghdGhpcy5oYXNFbXB0eU9wdGlvbiAmJiBBcHAuY29uZmlnLml0ZW0uc2hvd1BsZWFzZVNlbGVjdCkgPyAtMSA6IG51bGw7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmIChpbnZhbGlkU2VsZWN0aW9uLm5ld1VuaXQpXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMubGFzdENvbnRlbnRDb3VudCA+IDEgJiYgdGhpcy5wb3NzaWJsZVVuaXRDb21iaW5hdGlvbklkcy5sZW5ndGggPiAxICYmICFpc051bGwodGhpcy5zZWxlY3RlZFVuaXQpKVxuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgbWVzc2FnZXMucHVzaChcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuJHRyYW5zbGF0ZShcIkNlcmVzOjpUZW1wbGF0ZS5zaW5nbGVJdGVtTm90QXZhaWxhYmxlXCIsIHsgbmFtZTpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy4kdHJhbnNsYXRlKFwiQ2VyZXM6OlRlbXBsYXRlLnNpbmdsZUl0ZW1Db250ZW50XCIpXG4gICAgICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHRoaXMuJHN0b3JlLmNvbW1pdChgJHt0aGlzLml0ZW1JZH0vdmFyaWF0aW9uU2VsZWN0L3NlbGVjdEl0ZW1Vbml0YCwgaW52YWxpZFNlbGVjdGlvbi5uZXdVbml0KTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdGhpcy4kc3RvcmUuY29tbWl0KGAke3RoaXMuaXRlbUlkfS92YXJpYXRpb25TZWxlY3Qvc2V0SXRlbVNlbGVjdGVkQXR0cmlidXRlc2AsIGF0dHJpYnV0ZXMpO1xuXG4gICAgICAgICAgICB0aGlzLnNldFZhcmlhdGlvbih0aGlzLmN1cnJlbnRTZWxlY3Rpb24gPyB0aGlzLmN1cnJlbnRTZWxlY3Rpb24udmFyaWF0aW9uSWQgOiAwKTtcblxuICAgICAgICAgICAgTm90aWZpY2F0aW9uU2VydmljZS53YXJuKFxuICAgICAgICAgICAgICAgIG1lc3NhZ2VzLmpvaW4oXCI8YnI+XCIpXG4gICAgICAgICAgICApLmNsb3NlQWZ0ZXIoNTAwMCk7XG4gICAgICAgIH0sXG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIHJldHVybnMgbWF0Y2hpbmcgdmFyaWF0aW9ucyB3aXRoIGN1cnJlbnQgc2VsZWN0aW9uXG4gICAgICAgICAqIGF0dHJpYnV0ZXMgYW5kIHVuaXRJZCBjb3VsZCBiZSBmaWxsZWQsIHRvIGNoZWNrIGEgc3BlY2lmaWMgc2VsZWN0aW9uXG4gICAgICAgICAqIEBwYXJhbSB7b2JqZWN0fSBhdHRyaWJ1dGVzXG4gICAgICAgICAqIEBwYXJhbSB7bnVtYmVyfSB1bml0SWRcbiAgICAgICAgICogQHBhcmFtIHtib29sZWFufSBzdHJpY3RcbiAgICAgICAgICovXG4gICAgICAgIGZpbHRlclZhcmlhdGlvbnMoYXR0cmlidXRlcywgdW5pdElkLCBzdHJpY3QsIGlnbm9yZVVuaXQpXG4gICAgICAgIHtcbiAgICAgICAgICAgIGF0dHJpYnV0ZXMgPSBhdHRyaWJ1dGVzIHx8IHRoaXMuc2VsZWN0ZWRBdHRyaWJ1dGVzO1xuICAgICAgICAgICAgdW5pdElkID0gdW5pdElkIHx8IHRoaXMuc2VsZWN0ZWRVbml0O1xuICAgICAgICAgICAgc3RyaWN0ID0gISFzdHJpY3Q7XG4gICAgICAgICAgICBpZ25vcmVVbml0ID0gISFpZ25vcmVVbml0O1xuXG4gICAgICAgICAgICBjb25zdCBrZXkgPSBKU09OLnN0cmluZ2lmeShhdHRyaWJ1dGVzKSArIFwiX1wiICsgdW5pdElkICsgXCJfXCIgKyBzdHJpY3QgKyBcIl9cIiArIGlnbm9yZVVuaXQ7XG5cbiAgICAgICAgICAgIGlmIChpc0RlZmluZWQodGhpcy5maWx0ZXJlZFZhcmlhdGlvbnNDYWNoZVtrZXldKSlcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5maWx0ZXJlZFZhcmlhdGlvbnNDYWNoZVtrZXldO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBjb25zdCB1bmlxdWVWYWx1ZXMgPSBbLi4ubmV3IFNldChPYmplY3QudmFsdWVzKGF0dHJpYnV0ZXMpKV07XG4gICAgICAgICAgICBjb25zdCBpc0VtcHR5T3B0aW9uU2VsZWN0ZWQgPSB1bmlxdWVWYWx1ZXMubGVuZ3RoID09PSAxICYmIGlzTnVsbCh1bmlxdWVWYWx1ZXNbMF0pO1xuICAgICAgICAgICAgY29uc3QgZmlsdGVyZWRWYXJpYXRpb25zID0gdGhpcy52YXJpYXRpb25zLmZpbHRlcih2YXJpYXRpb24gPT5cbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAvLyB0aGUgc2VsZWN0ZWQgdW5pdCBpcyBub3QgbWF0Y2hpbmdcbiAgICAgICAgICAgICAgICBpZiAoIWlnbm9yZVVuaXQgJiYgdmFyaWF0aW9uLnVuaXRDb21iaW5hdGlvbklkICE9PSB1bml0SWQpXG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgLy8gdGhlIHZhcmlhdGlvbiBoYXMgbm8gYXR0cmlidXRlcyAob25seSBjaGVja2VkLCBpZiBhbnkgYXR0cmlidXRlIGhhcyBhIHNlbGVjdGVkIHZhbHVlKTsgb3IgdGhlIHZhcmlhdGlvbiBoYXMgYXR0cmlidXRlcyBhbmQgZW1wdHkgb3B0aW9uIGlzIHNlbGVjdGVkXG4gICAgICAgICAgICAgICAgLy8gcmVxdWlyZXMgbW9yZSB0aGFuIDAgYXR0cmlidXRlc1xuICAgICAgICAgICAgICAgIGlmICgoKCFpc0VtcHR5T3B0aW9uU2VsZWN0ZWQgJiYgIXZhcmlhdGlvbi5hdHRyaWJ1dGVzLmxlbmd0aCkgfHwgKGlzRW1wdHlPcHRpb25TZWxlY3RlZCAmJiB2YXJpYXRpb24uYXR0cmlidXRlcy5sZW5ndGgpKVxuICAgICAgICAgICAgICAgICAgICAmJiB0aGlzLmF0dHJpYnV0ZXMubGVuZ3RoID4gMClcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IGF0dHJpYnV0ZUlkIGluIGF0dHJpYnV0ZXMpXG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCB2YXJpYXRpb25BdHRyaWJ1dGUgPSB2YXJpYXRpb24uYXR0cmlidXRlcy5maW5kKHZhcmlhdGlvbkF0dHJpYnV0ZSA9PlxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyaWF0aW9uQXR0cmlidXRlLmF0dHJpYnV0ZUlkID09PSBwYXJzZUludChhdHRyaWJ1dGVJZCkpO1xuXG4gICAgICAgICAgICAgICAgICAgIC8vIGFuIGF0dHJpYnV0ZSBpcyBub3QgbWF0Y2hpbmcgd2l0aCBzZWxlY3Rpb25cbiAgICAgICAgICAgICAgICAgICAgaWYgKHZhcmlhdGlvbkF0dHJpYnV0ZSAmJlxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyaWF0aW9uQXR0cmlidXRlLmF0dHJpYnV0ZVZhbHVlSWQgIT09IGF0dHJpYnV0ZXNbYXR0cmlidXRlSWRdICYmXG4gICAgICAgICAgICAgICAgICAgICAgICAoc3RyaWN0IHx8ICFzdHJpY3QgJiYgIWlzTnVsbChhdHRyaWJ1dGVzW2F0dHJpYnV0ZUlkXSkgJiYgYXR0cmlidXRlc1thdHRyaWJ1dGVJZF0gIT09IC0xKSlcbiAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgdGhpcy5maWx0ZXJlZFZhcmlhdGlvbnNDYWNoZVtrZXldID0gZmlsdGVyZWRWYXJpYXRpb25zO1xuXG4gICAgICAgICAgICByZXR1cm4gZmlsdGVyZWRWYXJpYXRpb25zO1xuICAgICAgICB9LFxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiByZXR1cm5zIHRydWUsIGlmIHRoZSBzZWxlY3Rpb24gd2l0aCBhIG5ldyBhdHRyaWJ1dGUgdmFsdWUgd291bGQgYmUgdmFsaWRcbiAgICAgICAgICogQHBhcmFtIHtudW1iZXJ9IGF0dHJpYnV0ZUlkXG4gICAgICAgICAqIEBwYXJhbSB7W251bWJlciwgc3RyaW5nLCBudWxsXX0gYXR0cmlidXRlVmFsdWVJZFxuICAgICAgICAgKiBAcGFyYW0ge2Jvb2xlYW59IGZpbHRlclNhbGFibGVWYXJpYXRpb25zXG4gICAgICAgICAqL1xuICAgICAgICBpc0F0dHJpYnV0ZVNlbGVjdGlvblZhbGlkKGF0dHJpYnV0ZUlkLCBhdHRyaWJ1dGVWYWx1ZUlkLCBmaWx0ZXJTYWxhYmxlVmFyaWF0aW9ucylcbiAgICAgICAge1xuICAgICAgICAgICAgYXR0cmlidXRlVmFsdWVJZCA9IHBhcnNlSW50KGF0dHJpYnV0ZVZhbHVlSWQpIHx8IG51bGw7XG4gICAgICAgICAgICBpZiAodGhpcy5zZWxlY3RlZEF0dHJpYnV0ZXNbYXR0cmlidXRlSWRdID09PSBhdHRyaWJ1dGVWYWx1ZUlkKVxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBjb25zdCBzZWxlY3RlZEF0dHJpYnV0ZXMgPSBKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KHRoaXMuc2VsZWN0ZWRBdHRyaWJ1dGVzKSk7XG5cbiAgICAgICAgICAgIHNlbGVjdGVkQXR0cmlidXRlc1thdHRyaWJ1dGVJZF0gPSBwYXJzZUludChhdHRyaWJ1dGVWYWx1ZUlkKSB8fCBudWxsO1xuXG4gICAgICAgICAgICBjb25zdCBpZ25vcmVVbml0ID0gIShPYmplY3Qua2V5cyh0aGlzLnBvc3NpYmxlVW5pdHMpLmxlbmd0aCA+IDEgJiYgdGhpcy5pc0NvbnRlbnRWaXNpYmxlKTtcbiAgICAgICAgICAgIGxldCB2YXJpYXRpb25zID0gdGhpcy5maWx0ZXJWYXJpYXRpb25zKHNlbGVjdGVkQXR0cmlidXRlcywgbnVsbCwgbnVsbCwgaWdub3JlVW5pdCk7XG5cbiAgICAgICAgICAgIGlmIChmaWx0ZXJTYWxhYmxlVmFyaWF0aW9ucylcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICB2YXJpYXRpb25zID0gdmFyaWF0aW9ucy5maWx0ZXIodmFyaWF0aW9uID0+IHZhcmlhdGlvbi5pc1NhbGFibGUpXG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHJldHVybiB2YXJpYXRpb25zLmxlbmd0aCA+IDA7XG4gICAgICAgIH0sXG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIHJldHVybnMgdHJ1ZSwgaWYgdGhlIHNlbGVjdGlvbiB3aXRoIGEgbmV3IHVuaXRJZCB3b3VsZCBiZSB2YWxpZFxuICAgICAgICAgKiBAcGFyYW0ge1tudW1iZXIsIHN0cmluZ119IHVuaXRJZFxuICAgICAgICAgKi9cbiAgICAgICAgaXNVbml0U2VsZWN0aW9uVmFsaWQodW5pdElkKVxuICAgICAgICB7XG4gICAgICAgICAgICB1bml0SWQgPSBwYXJzZUludCh1bml0SWQpO1xuICAgICAgICAgICAgaWYgKHRoaXMuc2VsZWN0ZWRVbml0ID09PSB1bml0SWQpXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHJldHVybiB0aGlzXG4gICAgICAgICAgICAgICAgLmZpbHRlclZhcmlhdGlvbnMobnVsbCwgdW5pdElkKVxuICAgICAgICAgICAgICAgIC5maWx0ZXIodmFyaWF0aW9uID0+IHZhcmlhdGlvbi5pc1NhbGFibGUpXG4gICAgICAgICAgICAgICAgLmxlbmd0aCA+IDBcbiAgICAgICAgfSxcblxuICAgICAgICAvKipcbiAgICAgICAgICogZGlzcGF0Y2ggdnVleCBhY3Rpb24gJ2xvYWRWYXJpYXRpb24nIHRvIGFyY2hpdmUgYSB2YXJpYXRpb25cbiAgICAgICAgICogZGlzcGF0Y2hlcyBhIGN1c3RvbSBldmVudCBuYW1lZCAnb25WYXJpYXRpb25DaGFuZ2VkJ1xuICAgICAgICAgKiBAcGFyYW0ge1tzdHJpbmcsIG51bWJlciwgbnVsbF19IHZhcmlhdGlvbklkXG4gICAgICAgICAqL1xuICAgICAgICBzZXRWYXJpYXRpb24odmFyaWF0aW9uSWQpXG4gICAgICAgIHtcbiAgICAgICAgICAgIGlmICghaXNEZWZpbmVkKHZhcmlhdGlvbklkKSAmJiB0aGlzLmN1cnJlbnRTZWxlY3Rpb24pXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgdmFyaWF0aW9uSWQgPSB0aGlzLmN1cnJlbnRTZWxlY3Rpb24udmFyaWF0aW9uSWQ7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmIChpc0RlZmluZWQodmFyaWF0aW9uSWQpKVxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIHRoaXMuJHN0b3JlLmRpc3BhdGNoKGAke3RoaXMuaXRlbUlkfS9sb2FkVmFyaWF0aW9uYCwgdmFyaWF0aW9uSWQpLnRoZW4odmFyaWF0aW9uID0+XG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC5kaXNwYXRjaEV2ZW50KG5ldyBDdXN0b21FdmVudChcIm9uVmFyaWF0aW9uQ2hhbmdlZFwiLFxuICAgICAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRldGFpbDpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXR0cmlidXRlczogdmFyaWF0aW9uLmF0dHJpYnV0ZXMsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkb2N1bWVudHM6IHZhcmlhdGlvbi5kb2N1bWVudHMsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpdGVtSWQ6IHRoaXMuaXRlbUlkXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH0pKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcblxuICAgICAgICBpc1RleHRDdXQoY29udGVudClcbiAgICAgICAge1xuICAgICAgICAgICAgaWYgKHRoaXMuJHJlZnMuYXR0cmlidXRlc0NvbnRhbmVyKVxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIHJldHVybiB0ZXh0V2lkdGgoY29udGVudCwgXCJDdXN0b20tRm9udCwgSGVsdmV0aWNhLCBBcmlhbCwgc2Fucy1zZXJpZlwiKSA+IHRoaXMuJHJlZnMuYXR0cmlidXRlc0NvbnRhbmVyWzBdLmNsaWVudFdpZHRoO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH0sXG5cbiAgICAgICAgZ2V0U2VsZWN0ZWRBdHRyaWJ1dGVWYWx1ZU5hbWUoYXR0cmlidXRlKVxuICAgICAgICB7XG4gICAgICAgICAgICBjb25zdCBzZWxlY3RlZEF0dHJpYnV0ZVZhbHVlSWQgPSAgdGhpcy5zZWxlY3RlZEF0dHJpYnV0ZXNbYXR0cmlidXRlLmF0dHJpYnV0ZUlkXTtcbiAgICAgICAgICAgIGNvbnN0IHNlbGVjdGVkQXR0cmlidXRlVmFsdWUgPSBhdHRyaWJ1dGUudmFsdWVzLmZpbmQoYXR0clZhbHVlID0+IGF0dHJWYWx1ZS5hdHRyaWJ1dGVWYWx1ZUlkID09PSBzZWxlY3RlZEF0dHJpYnV0ZVZhbHVlSWQpO1xuXG4gICAgICAgICAgICBpZiAoc2VsZWN0ZWRBdHRyaWJ1dGVWYWx1ZSlcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gc2VsZWN0ZWRBdHRyaWJ1dGVWYWx1ZS5uYW1lO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAoQXBwLmNvbmZpZy5pdGVtLnNob3dQbGVhc2VTZWxlY3QgJiYgc2VsZWN0ZWRBdHRyaWJ1dGVWYWx1ZUlkID09PSAtMSlcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy4kdHJhbnNsYXRlKFwiQ2VyZXM6OlRlbXBsYXRlLnNpbmdsZUl0ZW1QbGVhc2VTZWxlY3RcIik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gdGhpcy4kdHJhbnNsYXRlKFwiQ2VyZXM6OlRlbXBsYXRlLnNpbmdsZUl0ZW1Ob1NlbGVjdGlvblwiKTtcbiAgICAgICAgfSxcblxuICAgICAgICB0cmFuc2Zvcm1Qb3NzaWJsZVVuaXRzKHBvc3NpYmxlVW5pdHMpXG4gICAgICAgIHtcbiAgICAgICAgICAgIHJldHVybiBPYmplY3QuZW50cmllcyhwb3NzaWJsZVVuaXRzKS5zb3J0KCh1bml0QSwgdW5pdEIpID0+IHtcbiAgICAgICAgICAgICAgICB1bml0QSA9IHRoaXMuc3BsaXRVbml0TmFtZSh1bml0QVsxXSk7XG4gICAgICAgICAgICAgICAgdW5pdEIgPSB0aGlzLnNwbGl0VW5pdE5hbWUodW5pdEJbMV0pO1xuICAgICAgICAgICAgICAgIC8vIG9yZGVyIGJ5IHVuaXRcbiAgICAgICAgICAgICAgICBpZiAodW5pdEFbMV0gPCB1bml0QlsxXSkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gLTE7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmICh1bml0QVsxXSA+IHVuaXRCWzFdKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiAxO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAvLyBvcmRlciBieSBjb250ZW50IChjb3VudClcbiAgICAgICAgICAgICAgICBpZiAodW5pdEFbMF0gPCB1bml0QlswXSkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gLTE7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmICh1bml0QVswXSA+IHVuaXRCWzBdKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiAxO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZXR1cm4gMDtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9LFxuICAgICAgICBzcGxpdFVuaXROYW1lKHVuaXROYW1lKSB7XG4gICAgICAgICAgICBjb25zdCB1bml0TmFtZVNwbGl0ID0gdW5pdE5hbWUuc3BsaXQoXCIgXCIpO1xuXG4gICAgICAgICAgICBpZiAoIWlzTmFOKHVuaXROYW1lU3BsaXRbMF0pKSB7XG4gICAgICAgICAgICAgICAgdW5pdE5hbWVTcGxpdFswXSA9IHVuaXROYW1lU3BsaXRbMF0ucmVwbGFjZShBcHAuY3VycmVuY3lQYXR0ZXJuLnNlcGFyYXRvcl90aG91c2FuZHMsIFwiXCIpO1xuICAgICAgICAgICAgICAgIHVuaXROYW1lU3BsaXRbMF0gPSBwYXJzZUludCh1bml0TmFtZVNwbGl0WzBdKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgcmV0dXJuIHVuaXROYW1lU3BsaXQ7XG4gICAgICAgIH1cbiAgICB9LFxuXG4gICAgd2F0Y2g6XG4gICAge1xuICAgICAgICBjdXJyZW50U2VsZWN0aW9uKHZhbHVlKVxuICAgICAgICB7XG4gICAgICAgICAgICB0aGlzLiRzdG9yZS5jb21taXQoYCR7dGhpcy5pdGVtSWR9L3ZhcmlhdGlvblNlbGVjdC9zZXRJc1ZhcmlhdGlvblNlbGVjdGVkYCwgISF2YWx1ZSk7XG4gICAgICAgIH0sXG4gICAgICAgIHZhcmlhdGlvbnMoKVxuICAgICAgICB7XG4gICAgICAgICAgICAvLyBGSVggdW5zZXQgdmFyaWF0aW9uIGNhY2hlIGFmdGVyIHN1YnNlcXVlbnQgdmFyaWF0aW9ucyBhcmUgbG9hZGVkXG4gICAgICAgICAgICB0aGlzLmZpbHRlcmVkVmFyaWF0aW9uc0NhY2hlID0ge307XG4gICAgICAgIH1cbiAgICB9XG59XG48L3NjcmlwdD5cbiIsImltcG9ydCBtb2QgZnJvbSBcIi0hLi4vLi4vLi4vLi4vLi4vLi4vbm9kZV9tb2R1bGVzL3Z1ZS1sb2FkZXIvbGliL2luZGV4LmpzPz92dWUtbG9hZGVyLW9wdGlvbnMhLi9WYXJpYXRpb25TZWxlY3QudnVlP3Z1ZSZ0eXBlPXNjcmlwdCZsYW5nPWpzJlwiOyBleHBvcnQgZGVmYXVsdCBtb2Q7IGV4cG9ydCAqIGZyb20gXCItIS4uLy4uLy4uLy4uLy4uLy4uL25vZGVfbW9kdWxlcy92dWUtbG9hZGVyL2xpYi9pbmRleC5qcz8/dnVlLWxvYWRlci1vcHRpb25zIS4vVmFyaWF0aW9uU2VsZWN0LnZ1ZT92dWUmdHlwZT1zY3JpcHQmbGFuZz1qcyZcIiIsImltcG9ydCB7IHJlbmRlciwgc3RhdGljUmVuZGVyRm5zIH0gZnJvbSBcIi4vVmFyaWF0aW9uU2VsZWN0LnZ1ZT92dWUmdHlwZT10ZW1wbGF0ZSZpZD00YTkzOWQwNSZcIlxuaW1wb3J0IHNjcmlwdCBmcm9tIFwiLi9WYXJpYXRpb25TZWxlY3QudnVlP3Z1ZSZ0eXBlPXNjcmlwdCZsYW5nPWpzJlwiXG5leHBvcnQgKiBmcm9tIFwiLi9WYXJpYXRpb25TZWxlY3QudnVlP3Z1ZSZ0eXBlPXNjcmlwdCZsYW5nPWpzJlwiXG5cblxuLyogbm9ybWFsaXplIGNvbXBvbmVudCAqL1xuaW1wb3J0IG5vcm1hbGl6ZXIgZnJvbSBcIiEuLi8uLi8uLi8uLi8uLi8uLi9ub2RlX21vZHVsZXMvdnVlLWxvYWRlci9saWIvcnVudGltZS9jb21wb25lbnROb3JtYWxpemVyLmpzXCJcbnZhciBjb21wb25lbnQgPSBub3JtYWxpemVyKFxuICBzY3JpcHQsXG4gIHJlbmRlcixcbiAgc3RhdGljUmVuZGVyRm5zLFxuICBmYWxzZSxcbiAgbnVsbCxcbiAgbnVsbCxcbiAgbnVsbFxuICBcbilcblxuLyogaG90IHJlbG9hZCAqL1xuaWYgKG1vZHVsZS5ob3QpIHtcbiAgdmFyIGFwaSA9IHJlcXVpcmUoXCIvVXNlcnMvbHVrYXNtYXR6ZW4vd29ya3NwYWNlMi9wbHVnaW5zL0NlcmVzL25vZGVfbW9kdWxlcy92dWUtaG90LXJlbG9hZC1hcGkvZGlzdC9pbmRleC5qc1wiKVxuICBhcGkuaW5zdGFsbChyZXF1aXJlKCd2dWUnKSlcbiAgaWYgKGFwaS5jb21wYXRpYmxlKSB7XG4gICAgbW9kdWxlLmhvdC5hY2NlcHQoKVxuICAgIGlmICghYXBpLmlzUmVjb3JkZWQoJzRhOTM5ZDA1JykpIHtcbiAgICAgIGFwaS5jcmVhdGVSZWNvcmQoJzRhOTM5ZDA1JywgY29tcG9uZW50Lm9wdGlvbnMpXG4gICAgfSBlbHNlIHtcbiAgICAgIGFwaS5yZWxvYWQoJzRhOTM5ZDA1JywgY29tcG9uZW50Lm9wdGlvbnMpXG4gICAgfVxuICAgIG1vZHVsZS5ob3QuYWNjZXB0KFwiLi9WYXJpYXRpb25TZWxlY3QudnVlP3Z1ZSZ0eXBlPXRlbXBsYXRlJmlkPTRhOTM5ZDA1JlwiLCBmdW5jdGlvbiAoKSB7XG4gICAgICBhcGkucmVyZW5kZXIoJzRhOTM5ZDA1Jywge1xuICAgICAgICByZW5kZXI6IHJlbmRlcixcbiAgICAgICAgc3RhdGljUmVuZGVyRm5zOiBzdGF0aWNSZW5kZXJGbnNcbiAgICAgIH0pXG4gICAgfSlcbiAgfVxufVxuY29tcG9uZW50Lm9wdGlvbnMuX19maWxlID0gXCJyZXNvdXJjZXMvanMvc3JjL2FwcC9jb21wb25lbnRzL2l0ZW0vVmFyaWF0aW9uU2VsZWN0LnZ1ZVwiXG5leHBvcnQgZGVmYXVsdCBjb21wb25lbnQuZXhwb3J0cyJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///5997\n')}}]);