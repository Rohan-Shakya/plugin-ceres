"use strict";(self.webpackChunkCeres=self.webpackChunkCeres||[]).push([[28],{3401:function(__unused_webpack_module,__webpack_exports__,__webpack_require__){eval('// ESM COMPAT FLAG\n__webpack_require__.r(__webpack_exports__);\n\n// EXPORTS\n__webpack_require__.d(__webpack_exports__, {\n  "default": function() { return /* binding */ QuantityInput; }\n});\n\n;// CONCATENATED MODULE: ./node_modules/vue-loader/lib/loaders/templateLoader.js??ruleSet[1].rules[2]!./node_modules/vue-loader/lib/index.js??vue-loader-options!./resources/js/src/app/components/item/QuantityInput.vue?vue&type=template&id=24dfbc62&\nvar render = function render() {\n  var _vm = this,\n    _c = _vm._self._c\n  return _c("div", { staticClass: "qty-box d-flex h-100" }, [\n    _c("input", {\n      ref: "quantityInputField",\n      staticClass: "qty-input text-center",\n      attrs: {\n        type: "text",\n        disabled: _vm.waiting,\n        "aria-label": _vm.$translate("Ceres::Template.itemQuantityInput"),\n      },\n      domProps: { value: _vm.displayValue },\n      on: {\n        change: function ($event) {\n          return _vm.setValue($event.target.value)\n        },\n      },\n    }),\n    _vm._v(" "),\n    _c("div", { staticClass: "qty-btn-container d-flex flex-column" }, [\n      _c(\n        "button",\n        {\n          directives: [\n            {\n              name: "tooltip",\n              rawName: "v-tooltip",\n              value: _vm.isMaximum && _vm.compMax !== 0,\n              expression: "isMaximum && compMax !== 0",\n            },\n          ],\n          staticClass:\n            "btn qty-btn flex-fill d-flex justify-content-center p-0",\n          class: {\n            disabled: _vm.isMaximum || _vm.waiting,\n            "btn-appearance": _vm.useAppearance,\n          },\n          attrs: {\n            "data-toggle": "tooltip",\n            "data-placement": "top",\n            "data-testing": "quantity-btn-increase",\n            title: _vm.maximumHint,\n            "aria-label": _vm.$translate(\n              "Ceres::Template.itemQuantityInputIncrease"\n            ),\n          },\n          on: {\n            click: function ($event) {\n              return _vm.increaseValue()\n            },\n          },\n        },\n        [\n          _c("i", {\n            staticClass: "fa fa-plus default-float",\n            attrs: { "aria-hidden": "true" },\n          }),\n        ]\n      ),\n      _vm._v(" "),\n      _c(\n        "button",\n        {\n          directives: [\n            {\n              name: "tooltip",\n              rawName: "v-tooltip",\n              value: _vm.isMinimum && _vm.compMax !== 0,\n              expression: "isMinimum && compMax !== 0",\n            },\n          ],\n          staticClass:\n            "btn qty-btn flex-fill d-flex justify-content-center p-0",\n          class: {\n            disabled: _vm.isMinimum || _vm.waiting,\n            "btn-appearance": _vm.useAppearance,\n          },\n          attrs: {\n            "data-toggle": "tooltip",\n            "data-placement": "bottom",\n            "data-testing": "quantity-btn-decrease",\n            title: _vm.minimumHint,\n            "aria-label": _vm.$translate(\n              "Ceres::Template.itemQuantityInputDecrease"\n            ),\n          },\n          on: {\n            click: function ($event) {\n              return _vm.decreaseValue()\n            },\n          },\n        },\n        [\n          _c("i", {\n            staticClass: "fa fa-minus default-float",\n            attrs: { "aria-hidden": "true" },\n          }),\n        ]\n      ),\n    ]),\n  ])\n}\nvar staticRenderFns = []\nrender._withStripped = true\n\n\n;// CONCATENATED MODULE: ./resources/js/src/app/components/item/QuantityInput.vue?vue&type=template&id=24dfbc62&\n\n// EXTERNAL MODULE: ./resources/js/src/app/helper/number.js\nvar number = __webpack_require__(4507);\n// EXTERNAL MODULE: ./resources/js/src/app/helper/utils.js\nvar utils = __webpack_require__(1023);\n// EXTERNAL MODULE: ./resources/js/src/app/helper/debounce.js\nvar debounce = __webpack_require__(9233);\n// EXTERNAL MODULE: ./node_modules/vuex/dist/vuex.esm.js\nvar vuex_esm = __webpack_require__(629);\n;// CONCATENATED MODULE: ./node_modules/vue-loader/lib/index.js??vue-loader-options!./resources/js/src/app/components/item/QuantityInput.vue?vue&type=script&lang=js&\n\n\n\n\n\n\n/* harmony default export */ var QuantityInputvue_type_script_lang_js_ = ({\n    name: "quantity-input",\n\n    props: {\n        value: {\n            type: Number,\n            required: true\n        },\n        timeout: {\n            type: Number,\n            required: false,\n            default: 500\n        },\n        min: {\n            type: Number,\n            required: false,\n            default: 0\n        },\n        max: {\n            type: Number,\n            required: false\n        },\n        interval: {\n            type: Number,\n            required: false,\n            default: 1\n        },\n        waiting: {\n            type: Boolean,\n            required: false\n        },\n        variationId: {\n            type: Number,\n            required: false\n        },\n        useAppearance: Boolean\n    },\n\n    data()\n    {\n        return {\n            compValue:      this.value,\n            compMin:        this.min,\n            compMax:        this.max,\n            compInterval:   this.interval,\n            compDecimals:   0,\n            onValueChanged: null\n        };\n    },\n\n    created()\n    {\n        this.compInterval = (0,utils/* defaultValue */.LS)(this.compInterval, 1);\n        this.compInterval = this.compInterval === 0 ? 1 : this.compInterval;\n\n        const minDecimals = (0,number/* floatLength */.GQ)(this.min);\n        const intervalDecimals = (0,number/* floatLength */.GQ)(this.compInterval);\n\n        this.compDecimals = Math.max(minDecimals, intervalDecimals);\n\n        this.onValueChanged = (0,debounce/* debounce */.D)(() =>\n        {\n            this.$emit("quantity-change", this.compValue);\n        }, (0,utils/* defaultValue */.LS)(this.timeout, 500));\n\n        if (!(0,utils/* isNullOrUndefined */.le)(this.variationId))\n        {\n            this.fetchQuantityFromBasket();\n        }\n    },\n\n    computed:\n    {\n        variationBasketQuantity()\n        {\n            if ((0,utils/* isNullOrUndefined */.le)(this.variationId))\n            {\n                return 0;\n            }\n\n            if(this.itemSetVariationId <= 0 || this.variationId === this.itemSetVariationId)\n            {\n                const basketObject = this.$store.state.basket.items.find(variations => variations.variationId === this.variationId);\n\n                return basketObject ? basketObject.quantity : 0;\n            }\n\n            return 0;\n        },\n\n        isMinimum()\n        {\n            return (0,utils/* isDefined */.$K)(this.compMin) && (this.compValue - this.compInterval) < this.compMin;\n        },\n\n        isMaximum()\n        {\n            return (0,utils/* isDefined */.$K)(this.compMax) && (this.compValue + this.compInterval) > this.compMax;\n        },\n\n        minimumHint()\n        {\n            return this.$translate(\n                "Ceres::Template.singleItemQuantityMin",\n                {\n                    min: this.$options.filters.numberFormat(this.compMin)\n                }\n            );\n        },\n\n        maximumHint()\n        {\n            return this.$translate(\n                "Ceres::Template.singleItemQuantityMax",\n                {\n                    max: this.$options.filters.numberFormat(this.max)\n                }\n            );\n        },\n\n        displayValue()\n        {\n            return this.$options.filters.numberFormat(this.compValue);\n        },\n\n        itemSetVariationId()\n        {\n            if (this.$store.state.items.itemSetId > 0)\n            {\n                return this.$store.getters[`${this.$store.state.items.itemSetId}/currentItemVariation`].variation.id;\n            }\n\n            return 0;\n        },\n\n        ...(0,vuex_esm/* mapState */.rn)({\n            basketItems: state => state.basket.items\n        })\n    },\n\n    watch:\n    {\n        variationId(newValue)\n        {\n            if ((0,utils/* isDefined */.$K)(newValue))\n            {\n                this.fetchQuantityFromBasket();\n            }\n        },\n\n        basketItems:\n        {\n            handler(newValue, oldValue)\n            {\n                if ((0,utils/* isDefined */.$K)(this.variationId))\n                {\n                    this.fetchQuantityFromBasket();\n                }\n            },\n            deep: true\n        },\n\n        min(newValue)\n        {\n            this.compMin = newValue;\n            this.fetchQuantityFromBasket();\n        },\n\n        max(newValue)\n        {\n            this.compMax = newValue;\n            this.fetchQuantityFromBasket();\n        },\n\n        value(newValue, oldValue)\n        {\n            if (newValue !== oldValue)\n            {\n                this.setValue(newValue);\n            }\n        },\n\n        interval(newInterval)\n        {\n            this.compInterval = (0,utils/* defaultValue */.LS)(newInterval, 1)\n        }\n    },\n\n    methods:\n    {\n        increaseValue()\n        {\n            const newValue = (0,number/* formatFloat */.$1)(this.compValue + this.compInterval, this.compDecimals);\n\n            if (((0,utils/* isNullOrUndefined */.le)(this.compMax) || newValue <= this.compMax) && !this.waiting)\n            {\n                this.setValue(newValue);\n            }\n        },\n\n        decreaseValue()\n        {\n            const newValue = (0,number/* formatFloat */.$1)(this.compValue - this.compInterval, this.compDecimals);\n\n            if (((0,utils/* isNullOrUndefined */.le)(this.compMin) || newValue >= this.compMin) && !this.waiting)\n            {\n                this.setValue(newValue);\n            }\n        },\n\n        setValue(value)\n        {\n            // consider the configured decimal seperator (if the input is typed in the input field)\n            if (typeof value === "string")\n            {\n                value = value.replace(App.decimalSeparator || ",", ".");\n            }\n\n            value = parseFloat(value);\n            if (isNaN(value))\n            {\n                value = (0,utils/* defaultValue */.LS)(this.compMin, 1);\n            }\n\n            // limit new value to min/ max value\n            value = (0,number/* limit */.b9)(value, this.compMin, this.compMax);\n\n            // make sure, new value is an even multiple of interval\n            let diff;\n            if (this.variationBasketQuantity === 0 && this.min !== 0)\n            {\n                diff = (0,number/* formatFloat */.$1)((value - this.min) % this.compInterval, this.compDecimals, true);\n            }\n            else\n            {\n                diff = (0,number/* formatFloat */.$1)(value % this.compInterval, this.compDecimals, true);\n            }\n\n            if (diff > 0 && diff !== this.compInterval)\n            {\n                if (diff < this.compInterval / 2)\n                {\n                    value -= diff;\n                }\n                else\n                {\n                    value += this.compInterval - diff;\n                }\n                value = (0,number/* limit */.b9)(value, this.compMin, this.compMax);\n            }\n\n            // cut fraction\n            value = (0,number/* formatFloat */.$1)(value, this.compDecimals);\n\n            if (value !== this.compValue)\n            {\n                this.compValue = value;\n                this.onValueChanged();\n            }\n            else if (!(0,utils/* isNullOrUndefined */.le)(this.$refs.quantityInputField))\n            {\n                this.$refs.quantityInputField.value = this.displayValue;\n            }\n        },\n\n        fetchQuantityFromBasket()\n        {\n            if (!(0,utils/* isNullOrUndefined */.le)(this.min) && this.variationBasketQuantity >= this.min && this.variationBasketQuantity !== 0)\n            {\n                // set the minimum value to the interval, if the item is already in the basket\n                this.compMin = this.compInterval;\n            }\n            else if (this.variationBasketQuantity === 0)\n            {\n                // reset the minimum, when item is not in the basket\n                this.compMin = this.min;\n            }\n\n            if (!(0,utils/* isNullOrUndefined */.le)(this.max))\n            {\n                // decrease maximum quantity by quantity of variations already in basket\n                this.compMax = this.max - this.variationBasketQuantity;\n\n                if (this.variationBasketQuantity + this.compInterval > this.max)\n                {\n                    this.compMin = 0;\n                    this.compMax = 0;\n                    this.$emit("out-of-stock", true);\n                }\n                else\n                {\n                    this.$emit("out-of-stock", false);\n                }\n            }\n            else\n            {\n                this.$emit("out-of-stock", false);\n            }\n\n            this.setValue(this.compMin);\n        }\n    }\n});\n\n;// CONCATENATED MODULE: ./resources/js/src/app/components/item/QuantityInput.vue?vue&type=script&lang=js&\n /* harmony default export */ var item_QuantityInputvue_type_script_lang_js_ = (QuantityInputvue_type_script_lang_js_); \n// EXTERNAL MODULE: ./node_modules/vue-loader/lib/runtime/componentNormalizer.js\nvar componentNormalizer = __webpack_require__(1900);\n;// CONCATENATED MODULE: ./resources/js/src/app/components/item/QuantityInput.vue\n\n\n\n\n\n/* normalize component */\n;\nvar component = (0,componentNormalizer/* default */.Z)(\n  item_QuantityInputvue_type_script_lang_js_,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\n/* harmony default export */ var QuantityInput = (component.exports);//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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ZXMiOlsid2VicGFjazovL0NlcmVzLy4vcmVzb3VyY2VzL2pzL3NyYy9hcHAvY29tcG9uZW50cy9pdGVtL1F1YW50aXR5SW5wdXQudnVlP2M1M2YiLCJ3ZWJwYWNrOi8vQ2VyZXMvLi9yZXNvdXJjZXMvanMvc3JjL2FwcC9jb21wb25lbnRzL2l0ZW0vUXVhbnRpdHlJbnB1dC52dWU/MTFkMCIsIndlYnBhY2s6Ly9DZXJlcy9yZXNvdXJjZXMvanMvc3JjL2FwcC9jb21wb25lbnRzL2l0ZW0vUXVhbnRpdHlJbnB1dC52dWU/NjkxOSIsIndlYnBhY2s6Ly9DZXJlcy8uL3Jlc291cmNlcy9qcy9zcmMvYXBwL2NvbXBvbmVudHMvaXRlbS9RdWFudGl0eUlucHV0LnZ1ZT81MzBhIiwid2VicGFjazovL0NlcmVzLy4vcmVzb3VyY2VzL2pzL3NyYy9hcHAvY29tcG9uZW50cy9pdGVtL1F1YW50aXR5SW5wdXQudnVlP2FmYmEiXSwic291cmNlc0NvbnRlbnQiOlsidmFyIHJlbmRlciA9IGZ1bmN0aW9uIHJlbmRlcigpIHtcbiAgdmFyIF92bSA9IHRoaXMsXG4gICAgX2MgPSBfdm0uX3NlbGYuX2NcbiAgcmV0dXJuIF9jKFwiZGl2XCIsIHsgc3RhdGljQ2xhc3M6IFwicXR5LWJveCBkLWZsZXggaC0xMDBcIiB9LCBbXG4gICAgX2MoXCJpbnB1dFwiLCB7XG4gICAgICByZWY6IFwicXVhbnRpdHlJbnB1dEZpZWxkXCIsXG4gICAgICBzdGF0aWNDbGFzczogXCJxdHktaW5wdXQgdGV4dC1jZW50ZXJcIixcbiAgICAgIGF0dHJzOiB7XG4gICAgICAgIHR5cGU6IFwidGV4dFwiLFxuICAgICAgICBkaXNhYmxlZDogX3ZtLndhaXRpbmcsXG4gICAgICAgIFwiYXJpYS1sYWJlbFwiOiBfdm0uJHRyYW5zbGF0ZShcIkNlcmVzOjpUZW1wbGF0ZS5pdGVtUXVhbnRpdHlJbnB1dFwiKSxcbiAgICAgIH0sXG4gICAgICBkb21Qcm9wczogeyB2YWx1ZTogX3ZtLmRpc3BsYXlWYWx1ZSB9LFxuICAgICAgb246IHtcbiAgICAgICAgY2hhbmdlOiBmdW5jdGlvbiAoJGV2ZW50KSB7XG4gICAgICAgICAgcmV0dXJuIF92bS5zZXRWYWx1ZSgkZXZlbnQudGFyZ2V0LnZhbHVlKVxuICAgICAgICB9LFxuICAgICAgfSxcbiAgICB9KSxcbiAgICBfdm0uX3YoXCIgXCIpLFxuICAgIF9jKFwiZGl2XCIsIHsgc3RhdGljQ2xhc3M6IFwicXR5LWJ0bi1jb250YWluZXIgZC1mbGV4IGZsZXgtY29sdW1uXCIgfSwgW1xuICAgICAgX2MoXG4gICAgICAgIFwiYnV0dG9uXCIsXG4gICAgICAgIHtcbiAgICAgICAgICBkaXJlY3RpdmVzOiBbXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgIG5hbWU6IFwidG9vbHRpcFwiLFxuICAgICAgICAgICAgICByYXdOYW1lOiBcInYtdG9vbHRpcFwiLFxuICAgICAgICAgICAgICB2YWx1ZTogX3ZtLmlzTWF4aW11bSAmJiBfdm0uY29tcE1heCAhPT0gMCxcbiAgICAgICAgICAgICAgZXhwcmVzc2lvbjogXCJpc01heGltdW0gJiYgY29tcE1heCAhPT0gMFwiLFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICBdLFxuICAgICAgICAgIHN0YXRpY0NsYXNzOlxuICAgICAgICAgICAgXCJidG4gcXR5LWJ0biBmbGV4LWZpbGwgZC1mbGV4IGp1c3RpZnktY29udGVudC1jZW50ZXIgcC0wXCIsXG4gICAgICAgICAgY2xhc3M6IHtcbiAgICAgICAgICAgIGRpc2FibGVkOiBfdm0uaXNNYXhpbXVtIHx8IF92bS53YWl0aW5nLFxuICAgICAgICAgICAgXCJidG4tYXBwZWFyYW5jZVwiOiBfdm0udXNlQXBwZWFyYW5jZSxcbiAgICAgICAgICB9LFxuICAgICAgICAgIGF0dHJzOiB7XG4gICAgICAgICAgICBcImRhdGEtdG9nZ2xlXCI6IFwidG9vbHRpcFwiLFxuICAgICAgICAgICAgXCJkYXRhLXBsYWNlbWVudFwiOiBcInRvcFwiLFxuICAgICAgICAgICAgXCJkYXRhLXRlc3RpbmdcIjogXCJxdWFudGl0eS1idG4taW5jcmVhc2VcIixcbiAgICAgICAgICAgIHRpdGxlOiBfdm0ubWF4aW11bUhpbnQsXG4gICAgICAgICAgICBcImFyaWEtbGFiZWxcIjogX3ZtLiR0cmFuc2xhdGUoXG4gICAgICAgICAgICAgIFwiQ2VyZXM6OlRlbXBsYXRlLml0ZW1RdWFudGl0eUlucHV0SW5jcmVhc2VcIlxuICAgICAgICAgICAgKSxcbiAgICAgICAgICB9LFxuICAgICAgICAgIG9uOiB7XG4gICAgICAgICAgICBjbGljazogZnVuY3Rpb24gKCRldmVudCkge1xuICAgICAgICAgICAgICByZXR1cm4gX3ZtLmluY3JlYXNlVmFsdWUoKVxuICAgICAgICAgICAgfSxcbiAgICAgICAgICB9LFxuICAgICAgICB9LFxuICAgICAgICBbXG4gICAgICAgICAgX2MoXCJpXCIsIHtcbiAgICAgICAgICAgIHN0YXRpY0NsYXNzOiBcImZhIGZhLXBsdXMgZGVmYXVsdC1mbG9hdFwiLFxuICAgICAgICAgICAgYXR0cnM6IHsgXCJhcmlhLWhpZGRlblwiOiBcInRydWVcIiB9LFxuICAgICAgICAgIH0pLFxuICAgICAgICBdXG4gICAgICApLFxuICAgICAgX3ZtLl92KFwiIFwiKSxcbiAgICAgIF9jKFxuICAgICAgICBcImJ1dHRvblwiLFxuICAgICAgICB7XG4gICAgICAgICAgZGlyZWN0aXZlczogW1xuICAgICAgICAgICAge1xuICAgICAgICAgICAgICBuYW1lOiBcInRvb2x0aXBcIixcbiAgICAgICAgICAgICAgcmF3TmFtZTogXCJ2LXRvb2x0aXBcIixcbiAgICAgICAgICAgICAgdmFsdWU6IF92bS5pc01pbmltdW0gJiYgX3ZtLmNvbXBNYXggIT09IDAsXG4gICAgICAgICAgICAgIGV4cHJlc3Npb246IFwiaXNNaW5pbXVtICYmIGNvbXBNYXggIT09IDBcIixcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgXSxcbiAgICAgICAgICBzdGF0aWNDbGFzczpcbiAgICAgICAgICAgIFwiYnRuIHF0eS1idG4gZmxleC1maWxsIGQtZmxleCBqdXN0aWZ5LWNvbnRlbnQtY2VudGVyIHAtMFwiLFxuICAgICAgICAgIGNsYXNzOiB7XG4gICAgICAgICAgICBkaXNhYmxlZDogX3ZtLmlzTWluaW11bSB8fCBfdm0ud2FpdGluZyxcbiAgICAgICAgICAgIFwiYnRuLWFwcGVhcmFuY2VcIjogX3ZtLnVzZUFwcGVhcmFuY2UsXG4gICAgICAgICAgfSxcbiAgICAgICAgICBhdHRyczoge1xuICAgICAgICAgICAgXCJkYXRhLXRvZ2dsZVwiOiBcInRvb2x0aXBcIixcbiAgICAgICAgICAgIFwiZGF0YS1wbGFjZW1lbnRcIjogXCJib3R0b21cIixcbiAgICAgICAgICAgIFwiZGF0YS10ZXN0aW5nXCI6IFwicXVhbnRpdHktYnRuLWRlY3JlYXNlXCIsXG4gICAgICAgICAgICB0aXRsZTogX3ZtLm1pbmltdW1IaW50LFxuICAgICAgICAgICAgXCJhcmlhLWxhYmVsXCI6IF92bS4kdHJhbnNsYXRlKFxuICAgICAgICAgICAgICBcIkNlcmVzOjpUZW1wbGF0ZS5pdGVtUXVhbnRpdHlJbnB1dERlY3JlYXNlXCJcbiAgICAgICAgICAgICksXG4gICAgICAgICAgfSxcbiAgICAgICAgICBvbjoge1xuICAgICAgICAgICAgY2xpY2s6IGZ1bmN0aW9uICgkZXZlbnQpIHtcbiAgICAgICAgICAgICAgcmV0dXJuIF92bS5kZWNyZWFzZVZhbHVlKClcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgfSxcbiAgICAgICAgfSxcbiAgICAgICAgW1xuICAgICAgICAgIF9jKFwiaVwiLCB7XG4gICAgICAgICAgICBzdGF0aWNDbGFzczogXCJmYSBmYS1taW51cyBkZWZhdWx0LWZsb2F0XCIsXG4gICAgICAgICAgICBhdHRyczogeyBcImFyaWEtaGlkZGVuXCI6IFwidHJ1ZVwiIH0sXG4gICAgICAgICAgfSksXG4gICAgICAgIF1cbiAgICAgICksXG4gICAgXSksXG4gIF0pXG59XG52YXIgc3RhdGljUmVuZGVyRm5zID0gW11cbnJlbmRlci5fd2l0aFN0cmlwcGVkID0gdHJ1ZVxuXG5leHBvcnQgeyByZW5kZXIsIHN0YXRpY1JlbmRlckZucyB9IiwiZXhwb3J0ICogZnJvbSBcIi0hLi4vLi4vLi4vLi4vLi4vLi4vbm9kZV9tb2R1bGVzL3Z1ZS1sb2FkZXIvbGliL2xvYWRlcnMvdGVtcGxhdGVMb2FkZXIuanM/P3J1bGVTZXRbMV0ucnVsZXNbMl0hLi4vLi4vLi4vLi4vLi4vLi4vbm9kZV9tb2R1bGVzL3Z1ZS1sb2FkZXIvbGliL2luZGV4LmpzPz92dWUtbG9hZGVyLW9wdGlvbnMhLi9RdWFudGl0eUlucHV0LnZ1ZT92dWUmdHlwZT10ZW1wbGF0ZSZpZD0yNGRmYmM2MiZcIiIsIjx0ZW1wbGF0ZT5cbiAgICA8ZGl2IGNsYXNzPVwicXR5LWJveCBkLWZsZXggaC0xMDBcIj5cbiAgICAgICAgPGlucHV0IGNsYXNzPVwicXR5LWlucHV0IHRleHQtY2VudGVyXCJcbiAgICAgICAgICAgICAgIHR5cGU9XCJ0ZXh0XCJcbiAgICAgICAgICAgICAgIDp2YWx1ZT1cImRpc3BsYXlWYWx1ZVwiXG4gICAgICAgICAgICAgICBAY2hhbmdlPVwic2V0VmFsdWUoJGV2ZW50LnRhcmdldC52YWx1ZSlcIlxuICAgICAgICAgICAgICAgOmRpc2FibGVkPVwid2FpdGluZ1wiXG4gICAgICAgICAgICAgICByZWY9XCJxdWFudGl0eUlucHV0RmllbGRcIlxuICAgICAgICAgICAgICAgOmFyaWEtbGFiZWw9XCIkdHJhbnNsYXRlKCdDZXJlczo6VGVtcGxhdGUuaXRlbVF1YW50aXR5SW5wdXQnKVwiPlxuXG4gICAgICAgIDxkaXYgY2xhc3M9XCJxdHktYnRuLWNvbnRhaW5lciBkLWZsZXggZmxleC1jb2x1bW5cIj5cbiAgICAgICAgICAgIDxidXR0b24gY2xhc3M9XCJidG4gcXR5LWJ0biBmbGV4LWZpbGwgZC1mbGV4IGp1c3RpZnktY29udGVudC1jZW50ZXIgcC0wXCJcbiAgICAgICAgICAgICAgICAgQGNsaWNrPVwiaW5jcmVhc2VWYWx1ZSgpXCJcbiAgICAgICAgICAgICAgICAgOmNsYXNzPVwieyAnZGlzYWJsZWQnOiBpc01heGltdW0gfHwgd2FpdGluZywgJ2J0bi1hcHBlYXJhbmNlJzogdXNlQXBwZWFyYW5jZSB9XCJcbiAgICAgICAgICAgICAgICAgdi10b29sdGlwPVwiaXNNYXhpbXVtICYmIGNvbXBNYXggIT09IDBcIlxuICAgICAgICAgICAgICAgICBkYXRhLXRvZ2dsZT1cInRvb2x0aXBcIlxuICAgICAgICAgICAgICAgICBkYXRhLXBsYWNlbWVudD1cInRvcFwiXG4gICAgICAgICAgICAgICAgIGRhdGEtdGVzdGluZz1cInF1YW50aXR5LWJ0bi1pbmNyZWFzZVwiXG4gICAgICAgICAgICAgICAgIDp0aXRsZT1cIm1heGltdW1IaW50XCJcbiAgICAgICAgICAgICAgICAgOmFyaWEtbGFiZWw9XCIkdHJhbnNsYXRlKCdDZXJlczo6VGVtcGxhdGUuaXRlbVF1YW50aXR5SW5wdXRJbmNyZWFzZScpXCI+XG4gICAgICAgICAgICAgICAgPGkgY2xhc3M9XCJmYSBmYS1wbHVzIGRlZmF1bHQtZmxvYXRcIiBhcmlhLWhpZGRlbj1cInRydWVcIj48L2k+XG4gICAgICAgICAgICA8L2J1dHRvbj5cblxuICAgICAgICAgICAgPGJ1dHRvbiBjbGFzcz1cImJ0biBxdHktYnRuIGZsZXgtZmlsbCBkLWZsZXgganVzdGlmeS1jb250ZW50LWNlbnRlciBwLTBcIlxuICAgICAgICAgICAgICAgICBAY2xpY2s9XCJkZWNyZWFzZVZhbHVlKClcIlxuICAgICAgICAgICAgICAgICA6Y2xhc3M9XCJ7ICdkaXNhYmxlZCc6IGlzTWluaW11bSB8fCB3YWl0aW5nLCAnYnRuLWFwcGVhcmFuY2UnOiB1c2VBcHBlYXJhbmNlIH1cIlxuICAgICAgICAgICAgICAgICB2LXRvb2x0aXA9XCJpc01pbmltdW0gJiYgY29tcE1heCAhPT0gMFwiXG4gICAgICAgICAgICAgICAgIGRhdGEtdG9nZ2xlPVwidG9vbHRpcFwiXG4gICAgICAgICAgICAgICAgIGRhdGEtcGxhY2VtZW50PVwiYm90dG9tXCJcbiAgICAgICAgICAgICAgICAgZGF0YS10ZXN0aW5nPVwicXVhbnRpdHktYnRuLWRlY3JlYXNlXCJcbiAgICAgICAgICAgICAgICAgOnRpdGxlPVwibWluaW11bUhpbnRcIlxuICAgICAgICAgICAgICAgICA6YXJpYS1sYWJlbD1cIiR0cmFuc2xhdGUoJ0NlcmVzOjpUZW1wbGF0ZS5pdGVtUXVhbnRpdHlJbnB1dERlY3JlYXNlJylcIj5cbiAgICAgICAgICAgICAgICA8aSBjbGFzcz1cImZhIGZhLW1pbnVzIGRlZmF1bHQtZmxvYXRcIiBhcmlhLWhpZGRlbj1cInRydWVcIj48L2k+XG4gICAgICAgICAgICA8L2J1dHRvbj5cbiAgICAgICAgPC9kaXY+XG4gICAgPC9kaXY+XG48L3RlbXBsYXRlPlxuXG48c2NyaXB0PlxuaW1wb3J0IHsgZmxvYXRMZW5ndGgsIGZvcm1hdEZsb2F0LCBsaW1pdCB9IGZyb20gXCIuLi8uLi9oZWxwZXIvbnVtYmVyXCI7XG5pbXBvcnQgeyBkZWZhdWx0VmFsdWUsIGlzRGVmaW5lZCwgaXNOdWxsT3JVbmRlZmluZWQgfSBmcm9tIFwiLi4vLi4vaGVscGVyL3V0aWxzXCI7XG5pbXBvcnQgeyBkZWJvdW5jZSB9IGZyb20gXCIuLi8uLi9oZWxwZXIvZGVib3VuY2VcIjtcbmltcG9ydCB7IG1hcFN0YXRlIH0gZnJvbSBcInZ1ZXhcIjtcblxuZXhwb3J0IGRlZmF1bHQge1xuICAgIG5hbWU6IFwicXVhbnRpdHktaW5wdXRcIixcblxuICAgIHByb3BzOiB7XG4gICAgICAgIHZhbHVlOiB7XG4gICAgICAgICAgICB0eXBlOiBOdW1iZXIsXG4gICAgICAgICAgICByZXF1aXJlZDogdHJ1ZVxuICAgICAgICB9LFxuICAgICAgICB0aW1lb3V0OiB7XG4gICAgICAgICAgICB0eXBlOiBOdW1iZXIsXG4gICAgICAgICAgICByZXF1aXJlZDogZmFsc2UsXG4gICAgICAgICAgICBkZWZhdWx0OiA1MDBcbiAgICAgICAgfSxcbiAgICAgICAgbWluOiB7XG4gICAgICAgICAgICB0eXBlOiBOdW1iZXIsXG4gICAgICAgICAgICByZXF1aXJlZDogZmFsc2UsXG4gICAgICAgICAgICBkZWZhdWx0OiAwXG4gICAgICAgIH0sXG4gICAgICAgIG1heDoge1xuICAgICAgICAgICAgdHlwZTogTnVtYmVyLFxuICAgICAgICAgICAgcmVxdWlyZWQ6IGZhbHNlXG4gICAgICAgIH0sXG4gICAgICAgIGludGVydmFsOiB7XG4gICAgICAgICAgICB0eXBlOiBOdW1iZXIsXG4gICAgICAgICAgICByZXF1aXJlZDogZmFsc2UsXG4gICAgICAgICAgICBkZWZhdWx0OiAxXG4gICAgICAgIH0sXG4gICAgICAgIHdhaXRpbmc6IHtcbiAgICAgICAgICAgIHR5cGU6IEJvb2xlYW4sXG4gICAgICAgICAgICByZXF1aXJlZDogZmFsc2VcbiAgICAgICAgfSxcbiAgICAgICAgdmFyaWF0aW9uSWQ6IHtcbiAgICAgICAgICAgIHR5cGU6IE51bWJlcixcbiAgICAgICAgICAgIHJlcXVpcmVkOiBmYWxzZVxuICAgICAgICB9LFxuICAgICAgICB1c2VBcHBlYXJhbmNlOiBCb29sZWFuXG4gICAgfSxcblxuICAgIGRhdGEoKVxuICAgIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIGNvbXBWYWx1ZTogICAgICB0aGlzLnZhbHVlLFxuICAgICAgICAgICAgY29tcE1pbjogICAgICAgIHRoaXMubWluLFxuICAgICAgICAgICAgY29tcE1heDogICAgICAgIHRoaXMubWF4LFxuICAgICAgICAgICAgY29tcEludGVydmFsOiAgIHRoaXMuaW50ZXJ2YWwsXG4gICAgICAgICAgICBjb21wRGVjaW1hbHM6ICAgMCxcbiAgICAgICAgICAgIG9uVmFsdWVDaGFuZ2VkOiBudWxsXG4gICAgICAgIH07XG4gICAgfSxcblxuICAgIGNyZWF0ZWQoKVxuICAgIHtcbiAgICAgICAgdGhpcy5jb21wSW50ZXJ2YWwgPSBkZWZhdWx0VmFsdWUodGhpcy5jb21wSW50ZXJ2YWwsIDEpO1xuICAgICAgICB0aGlzLmNvbXBJbnRlcnZhbCA9IHRoaXMuY29tcEludGVydmFsID09PSAwID8gMSA6IHRoaXMuY29tcEludGVydmFsO1xuXG4gICAgICAgIGNvbnN0IG1pbkRlY2ltYWxzID0gZmxvYXRMZW5ndGgodGhpcy5taW4pO1xuICAgICAgICBjb25zdCBpbnRlcnZhbERlY2ltYWxzID0gZmxvYXRMZW5ndGgodGhpcy5jb21wSW50ZXJ2YWwpO1xuXG4gICAgICAgIHRoaXMuY29tcERlY2ltYWxzID0gTWF0aC5tYXgobWluRGVjaW1hbHMsIGludGVydmFsRGVjaW1hbHMpO1xuXG4gICAgICAgIHRoaXMub25WYWx1ZUNoYW5nZWQgPSBkZWJvdW5jZSgoKSA9PlxuICAgICAgICB7XG4gICAgICAgICAgICB0aGlzLiRlbWl0KFwicXVhbnRpdHktY2hhbmdlXCIsIHRoaXMuY29tcFZhbHVlKTtcbiAgICAgICAgfSwgZGVmYXVsdFZhbHVlKHRoaXMudGltZW91dCwgNTAwKSk7XG5cbiAgICAgICAgaWYgKCFpc051bGxPclVuZGVmaW5lZCh0aGlzLnZhcmlhdGlvbklkKSlcbiAgICAgICAge1xuICAgICAgICAgICAgdGhpcy5mZXRjaFF1YW50aXR5RnJvbUJhc2tldCgpO1xuICAgICAgICB9XG4gICAgfSxcblxuICAgIGNvbXB1dGVkOlxuICAgIHtcbiAgICAgICAgdmFyaWF0aW9uQmFza2V0UXVhbnRpdHkoKVxuICAgICAgICB7XG4gICAgICAgICAgICBpZiAoaXNOdWxsT3JVbmRlZmluZWQodGhpcy52YXJpYXRpb25JZCkpXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIDA7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmKHRoaXMuaXRlbVNldFZhcmlhdGlvbklkIDw9IDAgfHwgdGhpcy52YXJpYXRpb25JZCA9PT0gdGhpcy5pdGVtU2V0VmFyaWF0aW9uSWQpXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgY29uc3QgYmFza2V0T2JqZWN0ID0gdGhpcy4kc3RvcmUuc3RhdGUuYmFza2V0Lml0ZW1zLmZpbmQodmFyaWF0aW9ucyA9PiB2YXJpYXRpb25zLnZhcmlhdGlvbklkID09PSB0aGlzLnZhcmlhdGlvbklkKTtcblxuICAgICAgICAgICAgICAgIHJldHVybiBiYXNrZXRPYmplY3QgPyBiYXNrZXRPYmplY3QucXVhbnRpdHkgOiAwO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICByZXR1cm4gMDtcbiAgICAgICAgfSxcblxuICAgICAgICBpc01pbmltdW0oKVxuICAgICAgICB7XG4gICAgICAgICAgICByZXR1cm4gaXNEZWZpbmVkKHRoaXMuY29tcE1pbikgJiYgKHRoaXMuY29tcFZhbHVlIC0gdGhpcy5jb21wSW50ZXJ2YWwpIDwgdGhpcy5jb21wTWluO1xuICAgICAgICB9LFxuXG4gICAgICAgIGlzTWF4aW11bSgpXG4gICAgICAgIHtcbiAgICAgICAgICAgIHJldHVybiBpc0RlZmluZWQodGhpcy5jb21wTWF4KSAmJiAodGhpcy5jb21wVmFsdWUgKyB0aGlzLmNvbXBJbnRlcnZhbCkgPiB0aGlzLmNvbXBNYXg7XG4gICAgICAgIH0sXG5cbiAgICAgICAgbWluaW11bUhpbnQoKVxuICAgICAgICB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy4kdHJhbnNsYXRlKFxuICAgICAgICAgICAgICAgIFwiQ2VyZXM6OlRlbXBsYXRlLnNpbmdsZUl0ZW1RdWFudGl0eU1pblwiLFxuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgbWluOiB0aGlzLiRvcHRpb25zLmZpbHRlcnMubnVtYmVyRm9ybWF0KHRoaXMuY29tcE1pbilcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICApO1xuICAgICAgICB9LFxuXG4gICAgICAgIG1heGltdW1IaW50KClcbiAgICAgICAge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuJHRyYW5zbGF0ZShcbiAgICAgICAgICAgICAgICBcIkNlcmVzOjpUZW1wbGF0ZS5zaW5nbGVJdGVtUXVhbnRpdHlNYXhcIixcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgIG1heDogdGhpcy4kb3B0aW9ucy5maWx0ZXJzLm51bWJlckZvcm1hdCh0aGlzLm1heClcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICApO1xuICAgICAgICB9LFxuXG4gICAgICAgIGRpc3BsYXlWYWx1ZSgpXG4gICAgICAgIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLiRvcHRpb25zLmZpbHRlcnMubnVtYmVyRm9ybWF0KHRoaXMuY29tcFZhbHVlKTtcbiAgICAgICAgfSxcblxuICAgICAgICBpdGVtU2V0VmFyaWF0aW9uSWQoKVxuICAgICAgICB7XG4gICAgICAgICAgICBpZiAodGhpcy4kc3RvcmUuc3RhdGUuaXRlbXMuaXRlbVNldElkID4gMClcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy4kc3RvcmUuZ2V0dGVyc1tgJHt0aGlzLiRzdG9yZS5zdGF0ZS5pdGVtcy5pdGVtU2V0SWR9L2N1cnJlbnRJdGVtVmFyaWF0aW9uYF0udmFyaWF0aW9uLmlkO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICByZXR1cm4gMDtcbiAgICAgICAgfSxcblxuICAgICAgICAuLi5tYXBTdGF0ZSh7XG4gICAgICAgICAgICBiYXNrZXRJdGVtczogc3RhdGUgPT4gc3RhdGUuYmFza2V0Lml0ZW1zXG4gICAgICAgIH0pXG4gICAgfSxcblxuICAgIHdhdGNoOlxuICAgIHtcbiAgICAgICAgdmFyaWF0aW9uSWQobmV3VmFsdWUpXG4gICAgICAgIHtcbiAgICAgICAgICAgIGlmIChpc0RlZmluZWQobmV3VmFsdWUpKVxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIHRoaXMuZmV0Y2hRdWFudGl0eUZyb21CYXNrZXQoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcblxuICAgICAgICBiYXNrZXRJdGVtczpcbiAgICAgICAge1xuICAgICAgICAgICAgaGFuZGxlcihuZXdWYWx1ZSwgb2xkVmFsdWUpXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgaWYgKGlzRGVmaW5lZCh0aGlzLnZhcmlhdGlvbklkKSlcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZmV0Y2hRdWFudGl0eUZyb21CYXNrZXQoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgZGVlcDogdHJ1ZVxuICAgICAgICB9LFxuXG4gICAgICAgIG1pbihuZXdWYWx1ZSlcbiAgICAgICAge1xuICAgICAgICAgICAgdGhpcy5jb21wTWluID0gbmV3VmFsdWU7XG4gICAgICAgICAgICB0aGlzLmZldGNoUXVhbnRpdHlGcm9tQmFza2V0KCk7XG4gICAgICAgIH0sXG5cbiAgICAgICAgbWF4KG5ld1ZhbHVlKVxuICAgICAgICB7XG4gICAgICAgICAgICB0aGlzLmNvbXBNYXggPSBuZXdWYWx1ZTtcbiAgICAgICAgICAgIHRoaXMuZmV0Y2hRdWFudGl0eUZyb21CYXNrZXQoKTtcbiAgICAgICAgfSxcblxuICAgICAgICB2YWx1ZShuZXdWYWx1ZSwgb2xkVmFsdWUpXG4gICAgICAgIHtcbiAgICAgICAgICAgIGlmIChuZXdWYWx1ZSAhPT0gb2xkVmFsdWUpXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgdGhpcy5zZXRWYWx1ZShuZXdWYWx1ZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG5cbiAgICAgICAgaW50ZXJ2YWwobmV3SW50ZXJ2YWwpXG4gICAgICAgIHtcbiAgICAgICAgICAgIHRoaXMuY29tcEludGVydmFsID0gZGVmYXVsdFZhbHVlKG5ld0ludGVydmFsLCAxKVxuICAgICAgICB9XG4gICAgfSxcblxuICAgIG1ldGhvZHM6XG4gICAge1xuICAgICAgICBpbmNyZWFzZVZhbHVlKClcbiAgICAgICAge1xuICAgICAgICAgICAgY29uc3QgbmV3VmFsdWUgPSBmb3JtYXRGbG9hdCh0aGlzLmNvbXBWYWx1ZSArIHRoaXMuY29tcEludGVydmFsLCB0aGlzLmNvbXBEZWNpbWFscyk7XG5cbiAgICAgICAgICAgIGlmICgoaXNOdWxsT3JVbmRlZmluZWQodGhpcy5jb21wTWF4KSB8fCBuZXdWYWx1ZSA8PSB0aGlzLmNvbXBNYXgpICYmICF0aGlzLndhaXRpbmcpXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgdGhpcy5zZXRWYWx1ZShuZXdWYWx1ZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG5cbiAgICAgICAgZGVjcmVhc2VWYWx1ZSgpXG4gICAgICAgIHtcbiAgICAgICAgICAgIGNvbnN0IG5ld1ZhbHVlID0gZm9ybWF0RmxvYXQodGhpcy5jb21wVmFsdWUgLSB0aGlzLmNvbXBJbnRlcnZhbCwgdGhpcy5jb21wRGVjaW1hbHMpO1xuXG4gICAgICAgICAgICBpZiAoKGlzTnVsbE9yVW5kZWZpbmVkKHRoaXMuY29tcE1pbikgfHwgbmV3VmFsdWUgPj0gdGhpcy5jb21wTWluKSAmJiAhdGhpcy53YWl0aW5nKVxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIHRoaXMuc2V0VmFsdWUobmV3VmFsdWUpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuXG4gICAgICAgIHNldFZhbHVlKHZhbHVlKVxuICAgICAgICB7XG4gICAgICAgICAgICAvLyBjb25zaWRlciB0aGUgY29uZmlndXJlZCBkZWNpbWFsIHNlcGVyYXRvciAoaWYgdGhlIGlucHV0IGlzIHR5cGVkIGluIHRoZSBpbnB1dCBmaWVsZClcbiAgICAgICAgICAgIGlmICh0eXBlb2YgdmFsdWUgPT09IFwic3RyaW5nXCIpXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgdmFsdWUgPSB2YWx1ZS5yZXBsYWNlKEFwcC5kZWNpbWFsU2VwYXJhdG9yIHx8IFwiLFwiLCBcIi5cIik7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHZhbHVlID0gcGFyc2VGbG9hdCh2YWx1ZSk7XG4gICAgICAgICAgICBpZiAoaXNOYU4odmFsdWUpKVxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIHZhbHVlID0gZGVmYXVsdFZhbHVlKHRoaXMuY29tcE1pbiwgMSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIGxpbWl0IG5ldyB2YWx1ZSB0byBtaW4vIG1heCB2YWx1ZVxuICAgICAgICAgICAgdmFsdWUgPSBsaW1pdCh2YWx1ZSwgdGhpcy5jb21wTWluLCB0aGlzLmNvbXBNYXgpO1xuXG4gICAgICAgICAgICAvLyBtYWtlIHN1cmUsIG5ldyB2YWx1ZSBpcyBhbiBldmVuIG11bHRpcGxlIG9mIGludGVydmFsXG4gICAgICAgICAgICBsZXQgZGlmZjtcbiAgICAgICAgICAgIGlmICh0aGlzLnZhcmlhdGlvbkJhc2tldFF1YW50aXR5ID09PSAwICYmIHRoaXMubWluICE9PSAwKVxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIGRpZmYgPSBmb3JtYXRGbG9hdCgodmFsdWUgLSB0aGlzLm1pbikgJSB0aGlzLmNvbXBJbnRlcnZhbCwgdGhpcy5jb21wRGVjaW1hbHMsIHRydWUpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZVxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIGRpZmYgPSBmb3JtYXRGbG9hdCh2YWx1ZSAlIHRoaXMuY29tcEludGVydmFsLCB0aGlzLmNvbXBEZWNpbWFscywgdHJ1ZSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmIChkaWZmID4gMCAmJiBkaWZmICE9PSB0aGlzLmNvbXBJbnRlcnZhbClcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBpZiAoZGlmZiA8IHRoaXMuY29tcEludGVydmFsIC8gMilcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgIHZhbHVlIC09IGRpZmY7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2VcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgIHZhbHVlICs9IHRoaXMuY29tcEludGVydmFsIC0gZGlmZjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdmFsdWUgPSBsaW1pdCh2YWx1ZSwgdGhpcy5jb21wTWluLCB0aGlzLmNvbXBNYXgpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBjdXQgZnJhY3Rpb25cbiAgICAgICAgICAgIHZhbHVlID0gZm9ybWF0RmxvYXQodmFsdWUsIHRoaXMuY29tcERlY2ltYWxzKTtcblxuICAgICAgICAgICAgaWYgKHZhbHVlICE9PSB0aGlzLmNvbXBWYWx1ZSlcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICB0aGlzLmNvbXBWYWx1ZSA9IHZhbHVlO1xuICAgICAgICAgICAgICAgIHRoaXMub25WYWx1ZUNoYW5nZWQoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKCFpc051bGxPclVuZGVmaW5lZCh0aGlzLiRyZWZzLnF1YW50aXR5SW5wdXRGaWVsZCkpXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgdGhpcy4kcmVmcy5xdWFudGl0eUlucHV0RmllbGQudmFsdWUgPSB0aGlzLmRpc3BsYXlWYWx1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcblxuICAgICAgICBmZXRjaFF1YW50aXR5RnJvbUJhc2tldCgpXG4gICAgICAgIHtcbiAgICAgICAgICAgIGlmICghaXNOdWxsT3JVbmRlZmluZWQodGhpcy5taW4pICYmIHRoaXMudmFyaWF0aW9uQmFza2V0UXVhbnRpdHkgPj0gdGhpcy5taW4gJiYgdGhpcy52YXJpYXRpb25CYXNrZXRRdWFudGl0eSAhPT0gMClcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAvLyBzZXQgdGhlIG1pbmltdW0gdmFsdWUgdG8gdGhlIGludGVydmFsLCBpZiB0aGUgaXRlbSBpcyBhbHJlYWR5IGluIHRoZSBiYXNrZXRcbiAgICAgICAgICAgICAgICB0aGlzLmNvbXBNaW4gPSB0aGlzLmNvbXBJbnRlcnZhbDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKHRoaXMudmFyaWF0aW9uQmFza2V0UXVhbnRpdHkgPT09IDApXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgLy8gcmVzZXQgdGhlIG1pbmltdW0sIHdoZW4gaXRlbSBpcyBub3QgaW4gdGhlIGJhc2tldFxuICAgICAgICAgICAgICAgIHRoaXMuY29tcE1pbiA9IHRoaXMubWluO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAoIWlzTnVsbE9yVW5kZWZpbmVkKHRoaXMubWF4KSlcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAvLyBkZWNyZWFzZSBtYXhpbXVtIHF1YW50aXR5IGJ5IHF1YW50aXR5IG9mIHZhcmlhdGlvbnMgYWxyZWFkeSBpbiBiYXNrZXRcbiAgICAgICAgICAgICAgICB0aGlzLmNvbXBNYXggPSB0aGlzLm1heCAtIHRoaXMudmFyaWF0aW9uQmFza2V0UXVhbnRpdHk7XG5cbiAgICAgICAgICAgICAgICBpZiAodGhpcy52YXJpYXRpb25CYXNrZXRRdWFudGl0eSArIHRoaXMuY29tcEludGVydmFsID4gdGhpcy5tYXgpXG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmNvbXBNaW4gPSAwO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmNvbXBNYXggPSAwO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLiRlbWl0KFwib3V0LW9mLXN0b2NrXCIsIHRydWUpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlXG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLiRlbWl0KFwib3V0LW9mLXN0b2NrXCIsIGZhbHNlKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgdGhpcy4kZW1pdChcIm91dC1vZi1zdG9ja1wiLCBmYWxzZSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHRoaXMuc2V0VmFsdWUodGhpcy5jb21wTWluKTtcbiAgICAgICAgfVxuICAgIH1cbn1cbjwvc2NyaXB0PlxuIiwiaW1wb3J0IG1vZCBmcm9tIFwiLSEuLi8uLi8uLi8uLi8uLi8uLi9ub2RlX21vZHVsZXMvdnVlLWxvYWRlci9saWIvaW5kZXguanM/P3Z1ZS1sb2FkZXItb3B0aW9ucyEuL1F1YW50aXR5SW5wdXQudnVlP3Z1ZSZ0eXBlPXNjcmlwdCZsYW5nPWpzJlwiOyBleHBvcnQgZGVmYXVsdCBtb2Q7IGV4cG9ydCAqIGZyb20gXCItIS4uLy4uLy4uLy4uLy4uLy4uL25vZGVfbW9kdWxlcy92dWUtbG9hZGVyL2xpYi9pbmRleC5qcz8/dnVlLWxvYWRlci1vcHRpb25zIS4vUXVhbnRpdHlJbnB1dC52dWU/dnVlJnR5cGU9c2NyaXB0Jmxhbmc9anMmXCIiLCJpbXBvcnQgeyByZW5kZXIsIHN0YXRpY1JlbmRlckZucyB9IGZyb20gXCIuL1F1YW50aXR5SW5wdXQudnVlP3Z1ZSZ0eXBlPXRlbXBsYXRlJmlkPTI0ZGZiYzYyJlwiXG5pbXBvcnQgc2NyaXB0IGZyb20gXCIuL1F1YW50aXR5SW5wdXQudnVlP3Z1ZSZ0eXBlPXNjcmlwdCZsYW5nPWpzJlwiXG5leHBvcnQgKiBmcm9tIFwiLi9RdWFudGl0eUlucHV0LnZ1ZT92dWUmdHlwZT1zY3JpcHQmbGFuZz1qcyZcIlxuXG5cbi8qIG5vcm1hbGl6ZSBjb21wb25lbnQgKi9cbmltcG9ydCBub3JtYWxpemVyIGZyb20gXCIhLi4vLi4vLi4vLi4vLi4vLi4vbm9kZV9tb2R1bGVzL3Z1ZS1sb2FkZXIvbGliL3J1bnRpbWUvY29tcG9uZW50Tm9ybWFsaXplci5qc1wiXG52YXIgY29tcG9uZW50ID0gbm9ybWFsaXplcihcbiAgc2NyaXB0LFxuICByZW5kZXIsXG4gIHN0YXRpY1JlbmRlckZucyxcbiAgZmFsc2UsXG4gIG51bGwsXG4gIG51bGwsXG4gIG51bGxcbiAgXG4pXG5cbmV4cG9ydCBkZWZhdWx0IGNvbXBvbmVudC5leHBvcnRzIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///3401\n')}}]);